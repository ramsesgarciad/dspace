(self.webpackChunkdspace_angular=self.webpackChunkdspace_angular||[]).push([[7846],{13260:(L,b,t)=>{"use strict";t.d(b,{f:()=>U});var i=t(21626),d=t(5964),R=t(96354),E=t(47677),m=t(89777),w=t(57775),x=t(7094),y=t(4093),D=t(88906),u=t(76456),S=t(54438);let n=(()=>{class C{parse(g,l){const s=l.payload,c=Object.assign(new D.cH,s);return new u.hT(l.statusCode,void 0,c)}static{this.\u0275fac=function(l){return new(l||C)}}static{this.\u0275prov=S.jDH({token:C,factory:C.\u0275fac,providedIn:"root"})}}return C})();var v=t(49755),f=t(3601);let U=(()=>{class C{constructor(g,l,s){this.requestService=g,this.rdbService=l,this.halService=s,this.linkPath="registrations",this.searchByTokenPath="/search/findByToken?token="}getRegistrationEndpoint(){return this.halService.getEndpoint(this.linkPath)}getTokenSearchEndpoint(g){return this.halService.getEndpoint(this.linkPath).pipe((0,d.p)(l=>(0,m.hj)(l)),(0,R.T)(l=>`${l}${this.searchByTokenPath}${g}`))}registerEmail(g,l=null,s){const c=new D.cH;c.email=g;const p=this.requestService.generateRequestId(),e=this.getRegistrationEndpoint(),I=Object.create({});let T=new i.Lr;return l&&(T=T.append("x-captcha-payload",l)),I.headers=T,(0,m.a4)(s)&&(I.params=s?new i.Nl({fromString:"accountRequestType="+s}):new i.Nl),e.pipe((0,E.I)(O=>(0,m.a4)(O)),(0,R.T)(O=>{const F=new v.Qf(p,O,c,I);this.requestService.send(F)})).subscribe(),this.rdbService.buildFromRequestUUID(p).pipe((0,y.qD)())}searchByTokenAndUpdateData(g){const l=this.requestService.generateRequestId(),s=this.getTokenSearchEndpoint(g).pipe((0,E.I)(c=>(0,m.a4)(c)));return s.subscribe(c=>{const p=new v.IP(l,c);Object.assign(p,{getResponseParser:()=>n}),this.requestService.send(p,!0)}),this.rdbService.buildSingle(s).pipe((0,R.T)(c=>c.hasSucceeded&&(0,m.a4)(c.payload)?Object.assign(c,{payload:Object.assign(new D.cH,{email:c.payload.email,token:g,user:c.payload.user})}):c))}searchByTokenAndHandleError(g){const l=this.requestService.generateRequestId(),s=this.getTokenSearchEndpoint(g).pipe((0,E.I)(c=>(0,m.a4)(c)));return s.subscribe(c=>{const p=new v.IP(l,c);Object.assign(p,{getResponseParser:()=>n}),this.requestService.send(p,!0)}),this.rdbService.buildSingle(s)}patchUpdateRegistration(g,l,s,c,p){const e=this.requestService.generateRequestId();return this.getRegistrationEndpoint().pipe((0,E.I)(T=>(0,m.a4)(T)),(0,R.T)(T=>`${T}/${s}?token=${c}`)).subscribe(T=>{const O=this.generateOperations(g,l,p),F=new v.EA(e,T,O);this.requestService.send(F)}),this.rdbService.buildFromRequestUUID(e)}generateOperations(g,l,s){let c=[];return g.length>0&&(0,m.a4)(l)&&(c=[{op:s,path:`/${l}`,value:g}]),c}static{this.\u0275fac=function(l){return new(l||C)(S.KVO(f.B),S.KVO(w.o),S.KVO(x.Y))}}static{this.\u0275prov=S.jDH({token:C,factory:C.\u0275fac,providedIn:"root"})}}return C})()},97846:(L,b,t)=>{"use strict";t.r(b),t.d(b,{ROUTES:()=>l});var i=t(16373),d=t(54438),R=t(7901),E=t(73028),m=t(7673),w=t(88141),x=t(99437),y=t(94196),D=t(23536),u=t(13260),S=t(4093),n=t(89777),f=t(29710);t(57648);const C=["*"];function $(s,c){}const l=[{path:"",pathMatch:"full",component:(()=>{class s extends f.J{getComponentName(){return"ExternalLoginReviewAccountInfoPageComponent"}importThemedComponent(p){return t(2906)(`./${p}/app/external-login-review-account-info/external-login-review-account-info-page.component`)}importUnthemedComponent(){return Promise.resolve().then(t.bind(t,57648))}static{this.\u0275fac=(()=>{let p;return function(I){return(p||(p=d.xGo(s)))(I||s)}})()}static{this.\u0275cmp=d.VBU({type:s,selectors:[["ds-external-login-page"]],standalone:!0,features:[d.Vt3,d.aNF],ngContentSelectors:C,decls:5,vars:0,consts:[["vcr",""],["content",""]],template:function(e,I){1&e&&(d.NAR(),d.DNE(0,$,0,0,"ng-template",null,0,d.C5r),d.j41(2,"div",null,1),d.SdG(4),d.k0s())},encapsulation:2})}}return s})(),canActivate:[(s,c)=>{const p=(0,d.WQX)(y.uR),e=(0,d.WQX)(R.Ix),I=(0,d.WQX)(u.f);return s.params.token?I.searchByTokenAndHandleError(s.params.token).pipe((0,S.qD)(),(0,E.Z)(T=>T.hasSucceeded&&(0,n.a4)(T.payload)?(0,n.a4)(T.payload.registrationType)&&T.payload.registrationType.includes(D.o.Validation)?(0,m.of)(!0):p.isAuthenticated():(0,m.of)(!1)),(0,w.M)(T=>{T||e.navigate(["/404"])}),(0,x.W)(()=>(e.navigate(["/404"]),(0,m.of)(!1)))):(e.navigate(["/404"]),(0,m.of)(!1))}],resolve:{registrationData:i.Q}}]},57648:(L,b,t)=>{"use strict";t.r(b),t.d(b,{ExternalLoginReviewAccountInfoPageComponent:()=>G});var i=t(60177),d=t(61594),R=t(88141),E=t(96354),m=t(64972),w=t(74082),x=t(89777),y=t(68018),D=t(84786),u=t(5964),S=t(25558),n=t(96697),v=t(22806),f=t(84572),U=t(94196),C=t(23536),$=t(13817),g=t(19252),s=(t(88906),t(26074)),c=t(3116),p=t(9847),e=t(54438);let I=(()=>{class h{transform(o,a){return o===a?'<i class="fa fa-check-circle text-success fa-xl" aria-hidden="true"></i>':a}static{this.\u0275fac=function(a){return new(a||h)}}static{this.\u0275pipe=e.EJ8({name:"dsCompareValues",type:h,pure:!0,standalone:!0})}}return h})();var T=t(58003),O=t(7901),F=t(95488);function B(h,M){if(1&h){const o=e.RV6();e.j41(0,"ui-switch",12),e.nI1(1,"translate"),e.nI1(2,"translate"),e.bIt("change",function(r){e.eBV(o);const k=e.XpG().$implicit,P=e.XpG();return e.Njj(P.onOverrideChange(r,k.identifier))}),e.k0s()}if(2&h){const o=e.XpG().$implicit;e.Y8G("checkedLabel",e.bMT(1,3,"on-label"))("uncheckedLabel",e.bMT(2,5,"off-label"))("checked",o.overrideValue)}}function j(h,M){if(1&h&&(e.j41(0,"tr")(1,"th",9),e.EFF(2),e.nI1(3,"titlecase"),e.k0s(),e.j41(4,"td"),e.EFF(5),e.k0s(),e.j41(6,"td"),e.nrm(7,"span",10),e.nI1(8,"dsCompareValues"),e.k0s(),e.j41(9,"td"),e.DNE(10,B,3,7,"ui-switch",11),e.k0s()()),2&h){const o=M.$implicit;e.R7$(2),e.JRh(e.bMT(3,4,o.label)),e.R7$(3),e.JRh(o.receivedValue),e.R7$(2),e.Y8G("innerHTML",e.i5U(8,6,o.receivedValue,o.currentValue),e.npT),e.R7$(3),e.vxM(o.receivedValue!==o.currentValue&&o.currentValue?10:-1)}}let V=(()=>{class h{constructor(o,a,r,k,P,A,H,W,J){this._window=o,this.ePersonService=a,this.modalService=r,this.notificationService=k,this.translateService=P,this.router=A,this.authService=H,this.externalLoginService=W,this.hardRedirectService=J,this.AlertTypeEnum=w.v,this.dataToCompare=[],this.subs=[]}ngOnInit(){this.dataToCompare=this.prepareDataToCompare()}onOverrideChange(o,a){this.dataToCompare.find(r=>r.identifier===a).overrideValue=o}onSave(){const o=this.modalService.open(c.M);o.componentInstance.headerLabel="confirmation-modal.review-account-info.header",o.componentInstance.infoLabel="confirmation-modal.review-account-info.info",o.componentInstance.cancelLabel="confirmation-modal.review-account-info.cancel",o.componentInstance.confirmLabel="confirmation-modal.review-account-info.confirm",o.componentInstance.brandColor="primary",o.componentInstance.confirmIcon="fa fa-check",this.registrationData.user?this.registrationData.user&&this.subs.push(o.componentInstance.response.pipe((0,n.s)(1)).subscribe(a=>{if(a&&this.registrationData.user){const r=this.registrationData.registrationType.split(C.o.Validation)[1];this.mergeEPersonDataWithToken(this.registrationData.user,r)}})):this.subs.push(this.isAuthenticated().pipe((0,u.p)(a=>a),(0,S.n)(()=>this.authService.getAuthenticatedUserFromStore()),(0,u.p)(a=>(0,x.a4)(a)),(0,E.T)(a=>a.uuid),(0,S.n)(a=>o.componentInstance.response.pipe((0,R.M)(r=>{r&&this.mergeEPersonDataWithToken(a,this.registrationData.registrationType)})))).subscribe())}mergeEPersonDataWithToken(o,a){let r;r=this.dataToCompare.some(k=>k.overrideValue)?(0,v.H)(this.dataToCompare).pipe((0,u.p)(k=>k.overrideValue),(0,S.n)(k=>this.ePersonService.mergeEPersonDataWithToken(o,this.registrationToken,k.identifier))):this.ePersonService.mergeEPersonDataWithToken(o,this.registrationToken),this.registrationData.user&&this.registrationData.registrationType.includes(C.o.Validation)?this.handleUnauthenticatedUser(r,a):this.handleAuthenticatedUser(r)}handleAuthenticatedUser(o){this.subs.push(o.subscribe(a=>{a.hasSucceeded?(this.notificationService.success(this.translateService.get("review-account-info.merge-data.notification.success")),this.router.navigate(["/profile"])):a.hasFailed&&this.notificationService.error(this.translateService.get("review-account-info.merge-data.notification.error"))}))}handleUnauthenticatedUser(o,a){this.subs.push((0,f.z)([o,this.externalLoginService.getExternalAuthLocation(a),this.authService.getRedirectUrl()]).subscribe(([r,k,P])=>{if(r.hasSucceeded){this.notificationService.success(this.translateService.get("review-account-info.merge-data.notification.success")),this.authService.setRedirectUrl("/profile");const A=this.authService.getExternalServerRedirectUrl(this._window.nativeWindow.origin,P,k);this.hardRedirectService.redirect(A)}else r.hasFailed&&this.notificationService.error(this.translateService.get("review-account-info.merge-data.notification.error"))}))}isAuthenticated(){return this.authService.isAuthenticated()}prepareDataToCompare(){const o=[];return Object.entries(this.registrationData.registrationMetadata).forEach(([a,r])=>{r[0].value!==this.registrationData.netId&&o.push({label:a.split(".")?.[1]??a.split(".")?.[0],currentValue:r[0]?.overrides??"",receivedValue:r[0].value,overrideValue:!1,identifier:a})}),o}ngOnDestroy(){this.subs.filter(o=>(0,x.a4)(o)).forEach(o=>o.unsubscribe())}static{this.\u0275fac=function(a){return new(a||h)(e.rXU(g.lc),e.rXU($.EPersonDataService),e.rXU(T.Bq),e.rXU(p.I),e.rXU(y.c$),e.rXU(O.Ix),e.rXU(U.uR),e.rXU(s.u),e.rXU(F.$))}}static{this.\u0275cmp=e.VBU({type:h,selectors:[["ds-review-account-info"]],inputs:{registrationToken:"registrationToken",registrationData:"registrationData"},standalone:!0,features:[e.aNF],decls:42,vars:27,consts:[[3,"type","content"],[1,"justify-content-center","table-responsive"],[1,"table","table-lg"],[1,"thead-light"],["scope","col"],[1,"h5","fw-bold"],["scope","row",1,"text-uppercase"],[1,"d-flex","justify-content-end"],[1,"btn","btn-primary",3,"click"],["scope","row"],[3,"innerHTML"],[3,"checkedLabel","uncheckedLabel","checked"],[3,"change","checkedLabel","uncheckedLabel","checked"]],template:function(a,r){1&a&&(e.j41(0,"h2"),e.EFF(1),e.nI1(2,"translate"),e.k0s(),e.nrm(3,"ds-alert",0),e.nI1(4,"translate"),e.j41(5,"div",1)(6,"table",2)(7,"thead",3)(8,"tr")(9,"th",4)(10,"span",5),e.EFF(11),e.nI1(12,"translate"),e.k0s()(),e.j41(13,"th",4)(14,"span",5),e.EFF(15),e.nI1(16,"translate"),e.k0s()(),e.j41(17,"th",4)(18,"span",5),e.EFF(19),e.nI1(20,"translate"),e.k0s()(),e.j41(21,"th",4)(22,"span",5),e.EFF(23),e.nI1(24,"translate"),e.k0s()()()(),e.j41(25,"tbody")(26,"tr")(27,"th",6),e.EFF(28),e.k0s(),e.j41(29,"td"),e.EFF(30),e.k0s(),e.j41(31,"td")(32,"span"),e.EFF(33),e.nI1(34,"translate"),e.k0s()(),e.nrm(35,"td"),e.k0s(),e.Z7z(36,j,11,9,"tr",null,e.fX1),e.k0s()(),e.j41(38,"div",7)(39,"button",8),e.bIt("click",function(){return r.onSave()}),e.EFF(40),e.nI1(41,"translate"),e.k0s()()()),2&a&&(e.R7$(),e.SpI(" ",e.bMT(2,11,"external-login-validation.review-account-info.header"),""),e.R7$(2),e.Y8G("type",r.AlertTypeEnum.Info)("content",e.bMT(4,13,"external-login-validation.review-account-info.info")),e.R7$(8),e.JRh(e.bMT(12,15,"external-login-validation.review-account-info.table.header.information")),e.R7$(4),e.JRh(e.bMT(16,17,"external-login-validation.review-account-info.table.header.received-value")),e.R7$(4),e.JRh(e.bMT(20,19,"external-login-validation.review-account-info.table.header.current-value")),e.R7$(4),e.JRh(e.bMT(24,21,"external-login-validation.review-account-info.table.header.action")),e.R7$(5),e.JRh(r.registrationData.registrationType),e.R7$(2),e.JRh(r.registrationData.netId),e.R7$(3),e.SpI(" ",e.bMT(34,23,"external-login-validation.review-account-info.table.row.not-applicable")," "),e.R7$(3),e.Dyx(r.dataToCompare),e.R7$(4),e.SpI(" ",e.bMT(41,25,"confirmation-modal.review-account-info.save")," "))},dependencies:[m.C,I,i.PV,y.h,y.D9,D.z,D.S],styles:["[_nghost-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]{background-color:#f7f8f9}[_nghost-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], [_nghost-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{height:60px;vertical-align:middle}"],changeDetection:0})}}return h})();function X(h,M){if(1&h&&e.nrm(0,"ds-review-account-info",1),2&h){const o=e.XpG();e.Y8G("registrationToken",o.token)("registrationData",M)}}function N(h,M){if(1&h&&e.nrm(0,"ds-alert",2),2&h){const o=e.XpG();e.Y8G("type",o.AlertTypeEnum.Error)("content","review-account-info.alert.error.content")}}let G=(()=>{class h{constructor(o){this.arouter=o,this.AlertTypeEnum=w.v,this.hasErrors=!1,this.token=this.arouter.snapshot.params.token,this.hasErrors=(0,x.Tn)(this.arouter.snapshot.params.token)}ngOnInit(){this.registrationData$=this.arouter.data.pipe((0,d.$)(),(0,R.M)(o=>this.hasErrors=o.registrationData.hasFailed),(0,E.T)(o=>o.registrationData.payload))}static{this.\u0275fac=function(a){return new(a||h)(e.rXU(O.nX))}}static{this.\u0275cmp=e.VBU({type:h,selectors:[["ng-component"]],standalone:!0,features:[e.aNF],decls:4,vars:4,consts:[[1,"container"],[3,"registrationToken","registrationData"],[3,"type","content"]],template:function(a,r){if(1&a&&(e.j41(0,"div",0),e.DNE(1,X,1,2,"ds-review-account-info",1),e.nI1(2,"async"),e.DNE(3,N,1,2,"ds-alert",2),e.k0s()),2&a){let k;e.R7$(),e.vxM((k=e.bMT(2,2,r.registrationData$))?1:-1,k),e.R7$(2),e.vxM(r.hasErrors?3:-1)}},dependencies:[m.C,i.Jj,V]})}}return h})()},2906:L=>{function b(t){return Promise.resolve().then(()=>{var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i})}b.keys=()=>[],b.resolve=b,b.id=2906,L.exports=b},84786:(L,b,t)=>{"use strict";t.d(b,{S:()=>y,z:()=>D});var i=t(54438),d=t(89417),R=t(60177);const E=["*"];function m(u,S){if(1&u&&(i.j41(0,"label",2)(1,"span",3),i.EFF(2),i.k0s(),i.j41(3,"span",4),i.EFF(4),i.k0s()()),2&u){const n=i.XpG();i.R7$(),i.xc7("color",n.getColor("checkedTextColor")),i.BMQ("aria-label",n.checkedLabel),i.R7$(),i.JRh(n.checkedLabel),i.R7$(),i.xc7("color",n.getColor("uncheckedTextColor")),i.BMQ("aria-label",n.uncheckedLabel),i.R7$(),i.JRh(n.uncheckedLabel)}}const w=new i.nKC("UI_SWITCH_OPTIONS"),x={provide:d.kq,useExisting:(0,i.Rfq)(()=>y),multi:!0};let y=(()=>{class u{cdr;_checked;_disabled;_reverse;_loading;_beforeChange;size;color;switchOffColor;switchColor;defaultBgColor;defaultBoColor;checkedLabel;uncheckedLabel;checkedTextColor;uncheckedTextColor;beforeChange;ariaLabel;set checked(n){this._checked=!1!==n}get checked(){return this._checked}set disabled(n){this._disabled=!1!==n}get disabled(){return this._disabled}set reverse(n){this._reverse=!1!==n}get reverse(){return this._reverse}set loading(n){this._loading=!1!==n}get loading(){return this._loading}change=new i.bkB;changeEvent=new i.bkB;valueChange=new i.bkB;constructor(n={},v){this.cdr=v,this.size=n&&n.size||"medium",this.color=n&&n.color,this.switchOffColor=n&&n.switchOffColor,this.switchColor=n&&n.switchColor,this.defaultBgColor=n&&n.defaultBgColor,this.defaultBoColor=n&&n.defaultBoColor,this.checkedLabel=n&&n.checkedLabel,this.uncheckedLabel=n&&n.uncheckedLabel,this.checkedTextColor=n&&n.checkedTextColor,this.uncheckedTextColor=n&&n.uncheckedTextColor}getColor(n=""){return"borderColor"===n?this.defaultBoColor:"switchColor"===n?this.reverse?this.checked&&this.switchOffColor||this.switchColor:this.checked?this.switchColor:this.switchOffColor||this.switchColor:"checkedTextColor"===n?this.reverse?this.uncheckedTextColor:this.checkedTextColor:"uncheckedTextColor"===n?this.reverse?this.checkedTextColor:this.uncheckedTextColor:this.reverse?this.checked?this.defaultBgColor:this.color:this.checked?this.color:this.defaultBgColor}onClick(n){this.disabled||(this.checked=!this.checked,this.change.emit(this.checked),this.valueChange.emit(this.checked),this.changeEvent.emit(n),this.onChangeCallback(this.checked),this.onTouchedCallback(this.checked),this.cdr.markForCheck())}onToggle(n){this.disabled||(this.beforeChange?this._beforeChange=this.beforeChange.subscribe(v=>{v&&this.onClick(n)}):this.onClick(n))}writeValue(n){n!==this.checked&&(this.checked=!!n),this.onChangeCallback(this.checked),this.cdr&&this.cdr.markForCheck()}registerOnChange(n){this.onChangeCallback=n}registerOnTouched(n){this.onTouchedCallback=n}setDisabledState(n){this.disabled=n}onTouchedCallback=n=>{};onChangeCallback=n=>{};ngOnDestroy(){this._beforeChange&&this._beforeChange.unsubscribe()}static \u0275fac=function(v){return new(v||u)(i.rXU(w,8),i.rXU(i.gRc))};static \u0275cmp=i.VBU({type:u,selectors:[["ui-switch"]],hostBindings:function(v,f){1&v&&i.bIt("click",function(C){return f.onToggle(C)})},inputs:{size:"size",color:"color",switchOffColor:"switchOffColor",switchColor:"switchColor",defaultBgColor:"defaultBgColor",defaultBoColor:"defaultBoColor",checkedLabel:"checkedLabel",uncheckedLabel:"uncheckedLabel",checkedTextColor:"checkedTextColor",uncheckedTextColor:"uncheckedTextColor",beforeChange:"beforeChange",ariaLabel:"ariaLabel",checked:"checked",disabled:"disabled",reverse:"reverse",loading:"loading"},outputs:{change:"change",changeEvent:"changeEvent",valueChange:"valueChange"},features:[i.Jv_([x])],ngContentSelectors:E,decls:4,vars:21,consts:[["type","button","role","switch",1,"switch"],["class","switch-pane",4,"ngIf"],[1,"switch-pane"],[1,"switch-label-checked"],[1,"switch-label-unchecked"]],template:function(v,f){1&v&&(i.NAR(),i.j41(0,"button",0),i.DNE(1,m,5,8,"label",1),i.j41(2,"small"),i.SdG(3),i.k0s()()),2&v&&(i.xc7("background-color",f.getColor())("border-color",f.getColor("borderColor")),i.AVh("checked",f.checked)("disabled",f.disabled)("loading",f.loading)("switch-large","large"===f.size)("switch-medium","medium"===f.size)("switch-small","small"===f.size),i.BMQ("aria-checked",f.checked)("aria-label",f.ariaLabel),i.R7$(),i.Y8G("ngIf",f.checkedLabel||f.uncheckedLabel),i.R7$(),i.xc7("background",f.getColor("switchColor")))},dependencies:[R.bT],encapsulation:2})}return u})(),D=(()=>{class u{static forRoot(n){return{ngModule:u,providers:[{provide:w,useValue:n||{}}]}}static \u0275fac=function(v){return new(v||u)};static \u0275mod=i.$C({type:u});static \u0275inj=i.G2t({imports:[R.MD,d.YN,d.YN]})}return u})()}}]);