(self.webpackChunkdspace_angular=self.webpackChunkdspace_angular||[]).push([[1257],{80495:(P,h,n)=>{"use strict";n.d(h,{Q:()=>m});class m{constructor(d,l){this.text=d,this.url=l}}},31257:(P,h,n)=>{"use strict";n.r(h),n.d(h,{ROUTES:()=>v});var m=n(59072),u=n(29710),l=(n(94408),n(54438));const p=["*"];function C(a,D){}const v=[{path:"",component:(()=>{class a extends u.J{getComponentName(){return"CommunityListPageComponent"}importThemedComponent(f){return n(24768)(`./${f}/app/community-list-page/community-list-page.component`)}importUnthemedComponent(){return Promise.resolve().then(n.bind(n,94408))}static{this.\u0275fac=(()=>{let f;return function(E){return(f||(f=l.xGo(a)))(E||a)}})()}static{this.\u0275cmp=l.VBU({type:a,selectors:[["ds-community-list-page"]],standalone:!0,features:[l.Vt3,l.aNF],ngContentSelectors:p,decls:5,vars:0,consts:[["vcr",""],["content",""]],template:function(N,E){1&N&&(l.NAR(),l.DNE(0,C,0,0,"ng-template",null,0,l.C5r),l.j41(2,"div",null,1),l.SdG(4),l.k0s())},encapsulation:2})}}return a})(),pathMatch:"full",resolve:{breadcrumb:m.S},data:{title:"communityList.tabTitle",breadcrumbKey:"communityList"}}]},94408:(P,h,n)=>{"use strict";n.r(h),n.d(h,{CommunityListPageComponent:()=>l});var m=n(68018),u=n(34777),d=n(54438);let l=(()=>{class p{static{this.\u0275fac=function(v){return new(v||p)}}static{this.\u0275cmp=d.VBU({type:p,selectors:[["ds-base-community-list-page"]],standalone:!0,features:[d.aNF],decls:5,vars:3,consts:[[1,"container"]],template:function(v,a){1&v&&(d.j41(0,"div",0)(1,"h1"),d.EFF(2),d.nI1(3,"translate"),d.k0s(),d.nrm(4,"ds-community-list"),d.k0s()),2&v&&(d.R7$(2),d.JRh(d.bMT(3,1,"communityList.title")))},dependencies:[u.A,m.h,m.D9],encapsulation:2})}}return p})()},7195:(P,h,n)=>{"use strict";n.r(h),n.d(h,{CommunityListComponent:()=>Tt});var m=n(64109),u=n(60177),d=n(7901),l=n(68018),p=n(96697),C=n(43446),y=n(70998),v=n(36343),a=n(89777),D=n(15202),f=n(24100),N=n(25713),E=n(84412),H=n(70980);class Q{constructor(c){this.communityListService=c,this.communityList$=new E.t([]),this.loading$=new E.t(!1)}connect(c){return this.communityList$.asObservable()}loadCommunities(c,e){this.loading$.next(!0),(0,a.a4)(this.subLoadCommunities)&&this.subLoadCommunities.unsubscribe(),this.subLoadCommunities=this.communityListService.loadCommunities(c,e).pipe((0,H.j)(()=>this.loading$.next(!1))).subscribe(i=>{this.communityList$.next(i)})}disconnect(c){this.communityList$.complete(),this.loading$.complete()}}var O=n(59640),I=n(84572),k=n(7673),b=n(96354),Z=n(5964),W=n(25558),w=n(79096),V=n(36883),_=n(47067),q=n(39015),tt=n(69295),et=n(30684),nt=n(58956),ot=n(10406),B=n(4093),it=n(73409),j=n(4600),st=n(94404);class at{}var t=n(54438);const F=o=>(0,I.z)([...o]).pipe((0,b.T)(c=>[].concat(...c)),(0,Z.p)(c=>c.every(e=>(0,a.a4)(e)))),z=(o,c,e,i,s)=>({isExpandable$:c,name:o.name,id:o.id,level:e,isExpanded:i,parent:s,payload:o,isShowMoreNode:!1,route:o instanceof ot.E?(0,q.c5)(o.id):(0,_.JW)(o.id)}),K=(o,c,e)=>({isExpandable$:(0,k.of)(!1),name:"Show More Flatnode",id:o,level:c,isExpanded:!1,parent:e,payload:new at,isShowMoreNode:!0}),J=o=>o.communityList,dt=(0,O.Mz)(J,o=>o.expandedNodes),rt=(0,O.Mz)(J,o=>o.loadingNode);let ct=(()=>{class o{constructor(e,i,s,r){this.appConfig=e,this.communityDataService=i,this.collectionDataService=s,this.store=r,this.configOnePage=Object.assign(new v._,{elementsPerPage:1}),this.pageSize=e.communityList.pageSize}saveCommunityListStateToStore(e,i){this.store.dispatch(new st.H(e,i))}getExpandedNodesFromStore(){return this.store.select(dt)}getLoadingNodeFromStore(){return this.store.select(rt)}loadCommunities(e,i){const s=e.currentPage,r=[];for(let g=1;g<=s;g++){const x=Object.assign({},e,{currentPage:g});r.push(this.getTopCommunities(x))}return(0,I.z)([...r]).pipe((0,b.T)(g=>{const x=g.map(M=>M.page),$=[].concat(...x);let R=new it.Q;return g&&g.length>0&&(R=Object.assign({},g[0].pageInfo,{currentPage:s})),(0,nt.g)(R,$)})).pipe((0,W.n)(g=>this.transformListOfCommunities(g,0,null,i)))}getTopCommunities(e){return this.communityDataService.findTop({currentPage:e.currentPage,elementsPerPage:this.pageSize,sort:{field:e.sort.field,direction:e.sort.direction}},(0,j.s)("subcommunities",{findListOptions:this.configOnePage}),(0,j.s)("collections",{findListOptions:this.configOnePage})).pipe((0,B.yd)(),(0,b.T)(i=>i.payload))}transformListOfCommunities(e,i,s,r){if((0,a.hj)(e.page)){let L=e.currentPage;(0,a.hj)(s)&&(L=r.find(x=>x.id===s.id).currentCommunityPage);let g=e.page.map(x=>this.transformCommunity(x,i,s,r));return L<e.totalPages&&L===e.currentPage&&(g=[...g,(0,k.of)([K(`community-${(0,V.A)()}`,i,s)])]),F(g)}return(0,k.of)([])}transformCommunity(e,i,s,r){let L=!1;(0,a.hj)(r)&&(L=(0,a.a4)(r.find(R=>R.id===e.id)));const g=this.getIsExpandable(e),x=z(e,g,i,L,s);let $=[(0,k.of)([x])];if(L){const R=r.find(T=>T.id===e.id).currentCommunityPage;let M=[];for(let T=1;T<=R;T++){const X=this.communityDataService.findByParent(e.uuid,{elementsPerPage:this.pageSize,currentPage:T},(0,j.s)("subcommunities",{findListOptions:this.configOnePage}),(0,j.s)("collections",{findListOptions:this.configOnePage})).pipe((0,B.qD)(),(0,W.n)(S=>(0,a.a4)(S)&&(0,a.a4)(S.payload)?this.transformListOfCommunities(S.payload,i+1,x,r):(0,k.of)([])));M=[...M,X]}$=[...$,F(M)];const G=r.find(T=>T.id===e.id).currentCollectionPage;let U=[];for(let T=1;T<=G;T++){const X=this.collectionDataService.findByParent(e.uuid,{elementsPerPage:this.pageSize,currentPage:T}).pipe((0,B.qD)(),(0,b.T)(S=>{if((0,a.a4)(S)&&(0,a.a4)(S.payload)){let A=S.payload.page.map(Lt=>z(Lt,(0,k.of)(!1),i+1,!1,x));return G<S.payload.totalPages&&G===S.payload.currentPage&&(A=[...A,K(`collection-${(0,V.A)()}`,i+1,x)]),A}return[]}));U=[...U,X]}$=[...$,F(U)]}return F($)}getIsExpandable(e){const i=this.communityDataService.findByParent(e.uuid,this.configOnePage).pipe((0,b.T)(r=>!(!(0,a.a4)(r)||!(0,a.a4)(r.payload))&&r.payload.totalElements>0)),s=this.collectionDataService.findByParent(e.uuid,this.configOnePage).pipe((0,b.T)(r=>!(!(0,a.a4)(r)||!(0,a.a4)(r.payload))&&r.payload.totalElements>0));return(0,I.z)(i,s).pipe((0,b.T)(([r,L])=>r||L))}static{this.\u0275fac=function(i){return new(i||o)(t.KVO(w.vQ),t.KVO(et.CommunityDataService),t.KVO(tt.CollectionDataService),t.KVO(O.il))}}static{this.\u0275prov=t.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();const Y=o=>({name:o});function mt(o,c){1&o&&t.nrm(0,"ds-loading",0)}function lt(o,c){if(1&o){const e=t.RV6();t.j41(0,"button",13),t.bIt("click",function(){t.eBV(e);const s=t.XpG().$implicit,r=t.XpG();return t.Njj(r.getNextPage(s))}),t.nrm(1,"i",14),t.EFF(2),t.nI1(3,"translate"),t.k0s()}2&o&&(t.R7$(2),t.SpI(" ",t.bMT(3,1,"communityList.showMore")," "))}function ut(o,c){1&o&&t.nrm(0,"ds-loading",0)}function pt(o,c){if(1&o&&(t.j41(0,"cdk-tree-node",5)(1,"div",6)(2,"span",7),t.nrm(3,"span",8),t.k0s(),t.j41(4,"div",9),t.DNE(5,lt,4,3,"button",10),t.nI1(6,"async"),t.DNE(7,ut,1,0,"ds-loading",0),t.nI1(8,"async"),t.k0s()(),t.j41(9,"div",11),t.nrm(10,"div",12),t.k0s()()),2&o){const e=c.$implicit,i=t.XpG();t.R7$(5),t.vxM(!0!==t.bMT(6,2,i.dataSource.loading$)?5:-1),t.R7$(2),t.vxM(t.bMT(8,4,e===i.loadingNode&&i.dataSource.loading$)?7:-1)}}function ht(o,c){if(1&o){const e=t.RV6();t.j41(0,"button",25),t.nI1(1,"translate"),t.bIt("click",function(){t.eBV(e);const s=t.XpG().$implicit,r=t.XpG();return t.Njj(r.toggleExpanded(s))})("keyup.enter",function(){t.eBV(e);const s=t.XpG().$implicit,r=t.XpG();return t.Njj(r.toggleExpanded(s))})("keyup.space",function(){t.eBV(e);const s=t.XpG().$implicit,r=t.XpG();return t.Njj(r.toggleExpanded(s))}),t.nrm(2,"span",26),t.j41(3,"span",27),t.EFF(4),t.nI1(5,"translate"),t.k0s()()}if(2&o){const e=t.XpG().$implicit,i=t.XpG();t.BMQ("aria-label",t.i5U(1,5,e.isExpanded?"communityList.collapse":"communityList.expand",t.eq3(11,Y,i.dsoNameService.getName(e.payload)))),t.R7$(2),t.HbH(e.isExpanded?"fa fa-chevron-down":"fa fa-chevron-right"),t.R7$(2),t.JRh(t.i5U(5,8,e.isExpanded?"communityList.collapse":"communityList.expand",t.eq3(13,Y,i.dsoNameService.getName(e.payload))))}}function gt(o,c){1&o&&(t.j41(0,"span",17),t.nrm(1,"span",8),t.k0s())}function ft(o,c){if(1&o&&(t.j41(0,"span",22),t.EFF(1),t.k0s()),2&o){const e=t.XpG().$implicit;t.R7$(),t.JRh(e.payload.archivedItemsCount)}}function yt(o,c){if(1&o&&(t.j41(0,"div",12)(1,"span",17),t.nrm(2,"span",8),t.k0s(),t.j41(3,"ds-truncatable-part",28)(4,"span"),t.EFF(5),t.k0s()()()),2&o){const e=t.XpG().$implicit;t.R7$(3),t.Y8G("id",e.id)("minLines",3),t.R7$(2),t.JRh(e.payload.shortDescription)}}function Ct(o,c){1&o&&(t.j41(0,"div",24)(1,"span",17),t.nrm(2,"span",8),t.k0s(),t.nrm(3,"ds-loading",0),t.k0s())}function vt(o,c){if(1&o&&(t.j41(0,"cdk-tree-node",15)(1,"div",6),t.DNE(2,ht,6,15,"button",16),t.nI1(3,"async"),t.DNE(4,gt,2,0,"span",17),t.nI1(5,"async"),t.j41(6,"div",18)(7,"span",19)(8,"a",20),t.EFF(9),t.k0s(),t.j41(10,"span",21),t.EFF(11,"\xa0"),t.k0s(),t.DNE(12,ft,2,1,"span",22),t.k0s()()(),t.j41(13,"ds-truncatable",23)(14,"div",11),t.DNE(15,yt,6,3,"div",12),t.k0s()(),t.DNE(16,Ct,4,0,"div",24),t.nI1(17,"async"),t.k0s()),2&o){const e=c.$implicit,i=t.XpG();t.R7$(2),t.vxM(t.bMT(3,8,i.hasChild(null,e))?2:-1),t.R7$(2),t.vxM(!0!==t.bMT(5,10,i.hasChild(null,e))?4:-1),t.R7$(4),t.Y8G("routerLink",e.route),t.R7$(),t.JRh(i.dsoNameService.getName(e.payload)),t.R7$(3),t.vxM(e.payload.archivedItemsCount>=0?12:-1),t.R7$(),t.Y8G("id",e.id),t.R7$(2),t.vxM(e.payload.shortDescription?15:-1),t.R7$(),t.vxM(t.bMT(17,12,e===i.loadingNode&&i.dataSource.loading$)?16:-1)}}function xt(o,c){if(1&o&&(t.j41(0,"div",12)(1,"span",17),t.nrm(2,"span",8),t.k0s(),t.j41(3,"ds-truncatable-part",28)(4,"span"),t.EFF(5),t.k0s()()()),2&o){const e=t.XpG().$implicit;t.R7$(3),t.Y8G("id",e.id)("minLines",3),t.R7$(2),t.JRh(e.payload.shortDescription)}}function Nt(o,c){if(1&o&&(t.j41(0,"cdk-tree-node",29)(1,"div",6)(2,"span",7),t.nrm(3,"span",8),t.k0s(),t.j41(4,"h6",9)(5,"a",20),t.EFF(6),t.k0s()()(),t.j41(7,"ds-truncatable",23)(8,"div",11),t.DNE(9,xt,6,3,"div",12),t.k0s()()()),2&o){const e=c.$implicit,i=t.XpG();t.R7$(5),t.Y8G("routerLink",e.route),t.R7$(),t.JRh(i.dsoNameService.getName(e.payload)),t.R7$(),t.Y8G("id",e.id),t.R7$(2),t.vxM(e.payload.shortDescription?9:-1)}}let Tt=(()=>{class o{constructor(e,i){this.communityListService=e,this.dsoNameService=i,this.expandedNodes=[],this.treeControl=new m.XW(s=>s.level,s=>!0),this.trackBy=(s,r)=>r.id,this.paginationConfig=new v._,this.paginationConfig.elementsPerPage=2,this.paginationConfig.currentPage=1,this.paginationConfig.sort=new y.z("dc.title",y.U.ASC)}ngOnInit(){this.dataSource=new Q(this.communityListService),this.communityListService.getLoadingNodeFromStore().pipe((0,p.s)(1)).subscribe(e=>{this.loadingNode=e}),this.communityListService.getExpandedNodesFromStore().pipe((0,p.s)(1)).subscribe(e=>{this.expandedNodes=[...e],this.dataSource.loadCommunities(this.paginationConfig,this.expandedNodes)})}ngOnDestroy(){this.communityListService.saveCommunityListStateToStore(this.expandedNodes,this.loadingNode)}hasChild(e,i){return i.isExpandable$}isShowMore(e,i){return i.isShowMoreNode}toggleExpanded(e){this.loadingNode=e,e.isExpanded?(this.expandedNodes=this.expandedNodes.filter(i=>i.id!==e.id),e.isExpanded=!1):(this.expandedNodes.push(e),e.isExpanded=!0,(0,a.Im)(e.currentCollectionPage)&&(e.currentCollectionPage=1),(0,a.Im)(e.currentCommunityPage)&&(e.currentCommunityPage=1)),this.dataSource.loadCommunities(this.paginationConfig,this.expandedNodes)}getNextPage(e){this.loadingNode=e,null!=e.parent?(e.id.startsWith("collection")&&this.expandedNodes.find(s=>e.parent.id===s.id).currentCollectionPage++,e.id.startsWith("community")&&this.expandedNodes.find(s=>e.parent.id===s.id).currentCommunityPage++):this.paginationConfig.currentPage++,this.dataSource.loadCommunities(this.paginationConfig,this.expandedNodes)}static{this.\u0275fac=function(i){return new(i||o)(t.rXU(ct),t.rXU(C.f))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["ds-base-community-list"]],standalone:!0,features:[t.aNF],decls:6,vars:9,consts:[[1,"ds-themed-loading"],[3,"dataSource","treeControl","trackBy"],["cdkTreeNodePadding","","class","example-tree-node show-more-node",4,"cdkTreeNodeDef","cdkTreeNodeDefWhen"],["cdkTreeNodePadding","","class","example-tree-node expandable-node",4,"cdkTreeNodeDef","cdkTreeNodeDefWhen"],["cdkTreeNodePadding","","class","example-tree-node childless-node",4,"cdkTreeNodeDef","cdkTreeNodeDefWhen"],["cdkTreeNodePadding","",1,"example-tree-node","show-more-node"],[1,"btn-group"],["aria-hidden","true","cdkTreeNodeToggle","",1,"btn","btn-default","invisible"],[1,"fa","fa-chevron-right"],[1,"align-middle","my-auto"],["role","button","tabindex","0","data-test","show-more-button",1,"btn","btn-outline-primary","btn-sm"],["cdkTreeNodePadding","",1,"text-muted"],[1,"d-flex"],["role","button","tabindex","0","data-test","show-more-button",1,"btn","btn-outline-primary","btn-sm",3,"click"],[1,"fas","fa-angle-down"],["cdkTreeNodePadding","",1,"example-tree-node","expandable-node"],["type","button","cdkTreeNodeToggle","","data-test","expand-button","role","button","tabindex","0",1,"btn","btn-default","btn-transparent"],["aria-hidden","true",1,"btn","btn-default","invisible"],[1,"d-flex","flex-row"],[1,"d-flex","align-middle","my-auto"],["role","link","tabindex","0",1,"lead",3,"routerLink"],[1,"pe-2"],[1,"badge","rounded-pill","bg-secondary","align-top","archived-items-lead","my-auto","ps-2","pe-2"],[3,"id"],["cdkTreeNodePadding","",1,"d-flex"],["type","button","cdkTreeNodeToggle","","data-test","expand-button","role","button","tabindex","0",1,"btn","btn-default","btn-transparent",3,"click","keyup.enter","keyup.space"],["aria-hidden","true"],[1,"sr-only"],[3,"id","minLines"],["cdkTreeNodePadding","",1,"example-tree-node","childless-node"]],template:function(i,s){1&i&&(t.DNE(0,mt,1,0,"ds-loading",0),t.nI1(1,"async"),t.j41(2,"cdk-tree",1),t.DNE(3,pt,11,6,"cdk-tree-node",2)(4,vt,18,14,"cdk-tree-node",3)(5,Nt,10,4,"cdk-tree-node",4),t.k0s()),2&i&&(t.vxM(t.bMT(1,7,s.dataSource.loading$)&&!s.loadingNode?0:-1),t.R7$(2),t.Y8G("dataSource",s.dataSource)("treeControl",s.treeControl)("trackBy",s.trackBy),t.R7$(),t.Y8G("cdkTreeNodeDefWhen",s.isShowMore),t.R7$(),t.Y8G("cdkTreeNodeDefWhen",s.hasChild),t.R7$(),t.Y8G("cdkTreeNodeDefWhen",!(s.hasChild&&s.isShowMore)))},dependencies:[u.Jj,m.Dc,m.Sz,m.aI,m.Hy,m.NL,m.xn,d.Wk,D.v,l.h,l.D9,f.d,N.W],styles:[".fa-chevron-right:before{display:block;width:16px}"]})}}return o})()},34777:(P,h,n)=>{"use strict";n.d(h,{A:()=>C});var m=n(29710),d=(n(7195),n(54438));const l=["*"];function p(y,v){}let C=(()=>{class y extends m.J{getComponentName(){return"CommunityListComponent"}importThemedComponent(a){return n(89367)(`./${a}/app/community-list-page/community-list/community-list.component`)}importUnthemedComponent(){return Promise.resolve().then(n.bind(n,7195))}static{this.\u0275fac=(()=>{let a;return function(f){return(a||(a=d.xGo(y)))(f||y)}})()}static{this.\u0275cmp=d.VBU({type:y,selectors:[["ds-community-list"]],standalone:!0,features:[d.Vt3,d.aNF],ngContentSelectors:l,decls:5,vars:0,consts:[["vcr",""],["content",""]],template:function(D,f){1&D&&(d.NAR(),d.DNE(0,p,0,0,"ng-template",null,0,d.C5r),d.j41(2,"div",null,1),d.SdG(4),d.k0s())},encapsulation:2})}}return y})()},59072:(P,h,n)=>{"use strict";n.d(h,{S:()=>v});var m=n(54438),u=n(89777),d=n(54034),l=n(7673),p=n(80495);let y=(()=>{class a{getBreadcrumbs(f,N){return(0,l.of)([new p.Q(f+".breadcrumbs",N)])}static{this.\u0275fac=function(N){return new(N||a)}}static{this.\u0275prov=m.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();const v=(a,D,f=(0,m.WQX)(y))=>{const N=a.data.breadcrumbKey;if((0,u.Tn)(N))throw new Error('You provided an i18nBreadcrumbResolver for url "'+a.url+"\" but no breadcrumbKey in the route's data");return{provider:f,key:N,url:(0,d.F)(a)}}},24768:(P,h,n)=>{var m={"./custom/app/community-list-page/community-list-page.component":[6799,6799]};function u(d){if(!n.o(m,d))return Promise.resolve().then(()=>{var C=new Error("Cannot find module '"+d+"'");throw C.code="MODULE_NOT_FOUND",C});var l=m[d],p=l[0];return n.e(l[1]).then(()=>n(p))}u.keys=()=>Object.keys(m),u.id=24768,P.exports=u},89367:(P,h,n)=>{var m={"./custom/app/community-list-page/community-list/community-list.component":[3842,3842]};function u(d){if(!n.o(m,d))return Promise.resolve().then(()=>{var C=new Error("Cannot find module '"+d+"'");throw C.code="MODULE_NOT_FOUND",C});var l=m[d],p=l[0];return n.e(l[1]).then(()=>n(p))}u.keys=()=>Object.keys(m),u.id=89367,P.exports=u}}]);