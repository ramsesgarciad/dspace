"use strict";(self.webpackChunkdspace_angular=self.webpackChunkdspace_angular||[]).push([[1967],{11967:(N,_,r)=>{r.r(_),r.d(_,{ROUTES:()=>ce});var f=r(59072),v=r(25287),m=r(60177),g=r(7901),c=r(68018),y=r(84412),$=r(44437),S=r(96354),U=r(5964),h=r(25558),u=r(96697),R=r(31),b=r(27502),M=r(4093),T=r(9847),C=r(2175),X=r(36343);function j(s,l){return Object.assign(new X._,l,{currentPage:s.currentPage,elementsPerPage:s.pageSize})}var I=r(8417),e=r(54438),p=r(1473),x=r(27632),E=r(49838),k=r(86332);function O(s,l){if(1&s&&(e.j41(0,"h2"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&s){const t=e.XpG();e.R7$(),e.JRh(e.bMT(2,1,t.messagePrefix+".edit"))}}function P(s,l){if(1&s&&(e.j41(0,"h2"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&s){const t=e.XpG();e.R7$(),e.JRh(e.bMT(2,1,t.messagePrefix+".create"))}}let D=(()=>{class s{constructor(t,a,i){this.registryService=t,this.formBuilderService=a,this.translateService=i,this.formId="metadata-schema-form",this.messagePrefix="admin.registries.metadata.form",this.formLayout={name:{grid:{host:"col col-sm-6 d-inline-block"}},namespace:{grid:{host:"col col-sm-6 d-inline-block"}}},this.submitForm=new e.bkB,this.subscriptions=[]}ngOnInit(){this.name=new p.rA_({id:"name",label:this.translateService.instant(`${this.messagePrefix}.name`),name:"name",validators:{required:null,pattern:"^[^. ,]*$",maxLength:32},required:!0,errorMessages:{pattern:"error.validation.metadata.name.invalid-pattern",maxLength:"error.validation.metadata.name.max-length"}}),this.namespace=new p.rA_({id:"namespace",label:this.translateService.instant(`${this.messagePrefix}.namespace`),name:"namespace",validators:{required:null,maxLength:256},required:!0,errorMessages:{maxLength:"error.validation.metadata.namespace.max-length"}}),this.formModel=[new p.iO5({id:"metadatadataschemagroup",group:[this.namespace,this.name]})],this.formGroup=this.formBuilderService.createFormGroup(this.formModel),this.activeMetadataSchema$=this.registryService.getActiveMetadataSchema(),this.subscriptions.push(this.activeMetadataSchema$.subscribe(t=>{null==t?this.clearFields():(this.formGroup.patchValue({metadatadataschemagroup:{name:t.prefix,namespace:t.namespace}}),this.name.disabled=!0)}))}onCancel(){this.registryService.cancelEditMetadataSchema()}onSubmit(){this.activeMetadataSchema$.pipe((0,u.s)(1),(0,h.n)(t=>{const a={prefix:this.name.value,namespace:this.namespace.value};return this.registryService.createOrUpdateMetadataSchema(null==t?Object.assign(new x.p,a):Object.assign(new x.p,t,{namespace:a.namespace}))}),(0,h.n)(t=>this.registryService.clearMetadataSchemaRequests().pipe((0,S.T)(()=>t)))).subscribe(t=>{this.submitForm.emit(t),this.clearFields(),this.registryService.cancelEditMetadataSchema()})}clearFields(){this.formGroup.reset("metadatadataschemagroup"),this.name.disabled=!1}ngOnDestroy(){this.onCancel(),this.subscriptions.forEach(t=>t.unsubscribe())}static{this.\u0275fac=function(a){return new(a||s)(e.rXU(b.x),e.rXU(E.j),e.rXU(c.c$))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["ds-metadata-schema-form"]],outputs:{submitForm:"submitForm"},standalone:!0,features:[e.aNF],decls:4,vars:7,consts:[[3,"cancel","submitForm","formId","formModel","formGroup","formLayout"]],template:function(a,i){1&a&&(e.DNE(0,O,3,3,"h2"),e.nI1(1,"async"),e.DNE(2,P,3,3,"h2"),e.j41(3,"ds-form",0),e.bIt("cancel",function(){return i.onCancel()})("submitForm",function(){return i.onSubmit()}),e.k0s()),2&a&&(e.vxM(e.bMT(1,5,i.activeMetadataSchema$)?0:2),e.R7$(3),e.Y8G("formId",i.formId)("formModel",i.formModel)("formGroup",i.formGroup)("formLayout",i.formLayout))},dependencies:[m.Jj,k.s,c.h,c.D9],encapsulation:2})}}return s})();const V=s=>({"table-primary":s}),F=s=>[s];function B(s,l){if(1&s){const t=e.RV6();e.j41(0,"tr",13),e.nI1(1,"async"),e.j41(2,"td")(3,"label",14)(4,"input",15),e.nI1(5,"async"),e.bIt("change",function(i){const n=e.eBV(t).$implicit,o=e.XpG(2);return e.Njj(o.selectMetadataSchema(n,i))}),e.k0s(),e.j41(6,"span",12),e.EFF(7),e.nI1(8,"async"),e.nI1(9,"translate"),e.k0s()()(),e.j41(10,"td",16),e.bIt("click",function(){const i=e.eBV(t).$implicit,n=e.XpG(2);return e.Njj(n.editSchema(i))}),e.j41(11,"a",17),e.EFF(12),e.k0s()(),e.j41(13,"td",16),e.bIt("click",function(){const i=e.eBV(t).$implicit,n=e.XpG(2);return e.Njj(n.editSchema(i))}),e.j41(14,"a",17),e.EFF(15),e.k0s()(),e.j41(16,"td",16),e.bIt("click",function(){const i=e.eBV(t).$implicit,n=e.XpG(2);return e.Njj(n.editSchema(i))}),e.j41(17,"a",17),e.EFF(18),e.k0s()()()}if(2&s){let t,a,i;const n=l.$implicit,o=e.XpG(2);e.Y8G("ngClass",e.eq3(17,V,(null==(t=e.bMT(1,9,o.activeMetadataSchema$))?null:t.id)===n.id)),e.R7$(4),e.Y8G("checked",null==(a=e.bMT(5,11,o.selectedMetadataSchemaIDs$))?null:a.includes(n.id)),e.R7$(3),e.JRh(e.bMT(9,15,null!=(i=e.bMT(8,13,o.selectedMetadataSchemaIDs$))&&i.includes(n.id)?"admin.registries.metadata.schemas.deselect":"admin.registries.metadata.schemas.select")),e.R7$(4),e.Y8G("routerLink",e.eq3(19,F,n.prefix)),e.R7$(),e.JRh(n.id),e.R7$(2),e.Y8G("routerLink",e.eq3(21,F,n.prefix)),e.R7$(),e.JRh(n.namespace),e.R7$(2),e.Y8G("routerLink",e.eq3(23,F,n.prefix)),e.R7$(),e.JRh(n.prefix)}}function J(s,l){if(1&s&&(e.j41(0,"ds-pagination",6),e.nI1(1,"async"),e.j41(2,"div",9)(3,"table",10)(4,"thead")(5,"tr")(6,"th",11)(7,"span",12),e.EFF(8),e.nI1(9,"translate"),e.k0s()(),e.j41(10,"th",11),e.EFF(11),e.nI1(12,"translate"),e.k0s(),e.j41(13,"th",11),e.EFF(14),e.nI1(15,"translate"),e.k0s(),e.j41(16,"th",11),e.EFF(17),e.nI1(18,"translate"),e.k0s()()(),e.j41(19,"tbody"),e.Z7z(20,B,19,25,"tr",13,e.fX1),e.nI1(22,"async"),e.k0s()()()()),2&s){let t,a;const i=e.XpG();e.Y8G("paginationOptions",i.config)("collectionSize",null==(t=e.bMT(1,8,i.metadataSchemas))||null==t.payload?null:t.payload.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),e.R7$(8),e.JRh(e.bMT(9,10,"admin.registries.metadata.schemas.table.selected")),e.R7$(3),e.JRh(e.bMT(12,12,"admin.registries.metadata.schemas.table.id")),e.R7$(3),e.JRh(e.bMT(15,14,"admin.registries.metadata.schemas.table.namespace")),e.R7$(3),e.JRh(e.bMT(18,16,"admin.registries.metadata.schemas.table.name")),e.R7$(3),e.Dyx(null==(a=e.bMT(22,18,i.metadataSchemas))||null==a.payload?null:a.payload.page)}}function L(s,l){1&s&&(e.j41(0,"div",7),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&s&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"admin.registries.metadata.schemas.no-items")," "))}function A(s,l){if(1&s){const t=e.RV6();e.j41(0,"button",18),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.deleteSchemas())}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}2&s&&(e.R7$(),e.JRh(e.bMT(2,1,"admin.registries.metadata.schemas.table.delete")))}let Y=(()=>{class s{constructor(t,a,i,n){this.registryService=t,this.notificationsService=a,this.paginationService=i,this.translateService=n,this.config=Object.assign(new I.W,{id:"rm",pageSize:25}),this.needsUpdate$=new y.t(!0),this.subscriptions=[]}ngOnInit(){this.activeMetadataSchema$=this.registryService.getActiveMetadataSchema(),this.selectedMetadataSchemaIDs$=this.registryService.getSelectedMetadataSchemas().pipe((0,S.T)(t=>t.map(a=>a.id))),this.updateSchemas()}updateSchemas(){this.metadataSchemas=this.needsUpdate$.pipe((0,U.p)(t=>!0===t),(0,h.n)(()=>this.paginationService.getCurrentPagination(this.config.id,this.config)),(0,h.n)(t=>this.registryService.getMetadataSchemas(j(t))))}forceUpdateSchemas(){this.needsUpdate$.next(!0)}editSchema(t){this.subscriptions.push(this.activeMetadataSchema$.pipe((0,u.s)(1)).subscribe(a=>{t===a?this.registryService.cancelEditMetadataSchema():this.registryService.editMetadataSchema(t)}))}selectMetadataSchema(t,a){a.target.checked?this.registryService.selectMetadataSchema(t):this.registryService.deselectMetadataSchema(t)}deleteSchemas(){this.subscriptions.push(this.selectedMetadataSchemaIDs$.pipe((0,u.s)(1),(0,h.n)(t=>(0,$.y)(t.map(a=>this.registryService.deleteMetadataSchema(a).pipe((0,M.qD)()))))).subscribe(t=>{const a=t.filter(n=>n.hasSucceeded),i=t.filter(n=>n.hasFailed);a.length>0&&this.showNotification(!0,a.length),i.length>0&&this.showNotification(!1,i.length),this.registryService.deselectAllMetadataSchema(),this.registryService.cancelEditMetadataSchema()}))}showNotification(t,a){const i="admin.registries.schema.notification",n=t?"success":"failure",o=this.translateService.instant(`${i}.${n}`),d=this.translateService.instant(`${i}.deleted.${n}`,{amount:a});t?this.notificationsService.success(o,d):this.notificationsService.error(o,d)}ngOnDestroy(){this.paginationService.clearPagination(this.config.id),this.subscriptions.map(t=>t.unsubscribe())}static{this.\u0275fac=function(a){return new(a||s)(e.rXU(b.x),e.rXU(T.I),e.rXU(R.m),e.rXU(c.c$))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["ds-metadata-registry"]],standalone:!0,features:[e.aNF],decls:17,vars:15,consts:[[1,"container"],[1,"metadata-registry","row"],[1,"col-12"],["id","header",1,"border-bottom","pb-2"],["id","description",1,"pb-2"],[3,"submitForm"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage"],["role","alert",1,"alert","alert-info","w-100","mb-2"],["type","submit",1,"btn","btn-danger","float-end"],[1,"table-responsive"],["id","metadata-schemas",1,"table","table-striped","table-hover"],["scope","col"],[1,"sr-only"],[3,"ngClass"],[1,"form-label","mb-0"],["type","checkbox",3,"change","checked"],[1,"selectable-row",3,"click"],[3,"routerLink"],["type","submit",1,"btn","btn-danger","float-end",3,"click"]],template:function(a,i){if(1&a&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),e.EFF(4),e.nI1(5,"translate"),e.k0s(),e.j41(6,"p",4),e.EFF(7),e.nI1(8,"translate"),e.k0s(),e.j41(9,"ds-metadata-schema-form",5),e.bIt("submitForm",function(){return i.forceUpdateSchemas()}),e.k0s(),e.DNE(10,J,23,20,"ds-pagination",6),e.nI1(11,"async"),e.DNE(12,L,3,3,"div",7),e.nI1(13,"async"),e.j41(14,"div"),e.DNE(15,A,3,3,"button",8),e.nI1(16,"async"),e.k0s()()()()),2&a){let n,o,d;e.R7$(4),e.JRh(e.bMT(5,5,"admin.registries.metadata.head")),e.R7$(3),e.JRh(e.bMT(8,7,"admin.registries.metadata.description")),e.R7$(3),e.vxM((null==(n=e.bMT(11,9,i.metadataSchemas))||null==n.payload?null:n.payload.totalElements)>0?10:-1),e.R7$(2),e.vxM(0===(null==(o=e.bMT(13,11,i.metadataSchemas))||null==o.payload?null:o.payload.totalElements)?12:-1),e.R7$(3),e.vxM((null==(d=e.bMT(16,13,i.metadataSchemas))||null==d.payload||null==d.payload.page?null:d.payload.page.length)>0?15:-1)}},dependencies:[m.Jj,D,m.YU,C.e,g.Wk,c.h,c.D9],styles:[".selectable-row[_ngcontent-%COMP%]:hover{cursor:pointer}[_nghost-%COMP%]     #metadatadataschemagroup{display:flex}"]})}}return s})();var z=r(84572),w=r(7673),W=r(50186),G=r(33749);function K(s,l){if(1&s&&(e.j41(0,"h2"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&s){const t=e.XpG();e.R7$(),e.JRh(e.bMT(2,1,t.messagePrefix+".edit"))}}function q(s,l){if(1&s&&(e.j41(0,"h2"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&s){const t=e.XpG();e.R7$(),e.JRh(e.bMT(2,1,t.messagePrefix+".create"))}}let Z=(()=>{class s{constructor(t,a,i){this.registryService=t,this.formBuilderService=a,this.translateService=i,this.formId="metadata-field-form",this.messagePrefix="admin.registries.schema.form",this.formLayout={element:{grid:{host:"col col-sm-6 d-inline-block"}},qualifier:{grid:{host:"col col-sm-6 d-inline-block"}},scopeNote:{grid:{host:"col col-sm-12 d-inline-block"}}},this.submitForm=new e.bkB}ngOnInit(){this.activeMetadataField$=this.registryService.getActiveMetadataField(),this.element=new p.rA_({id:"element",label:this.translateService.instant(`${this.messagePrefix}.element`),name:"element",validators:{required:null,pattern:"^[^. ,]*$",maxLength:64},required:!0,errorMessages:{pattern:"error.validation.metadata.element.invalid-pattern",maxLength:"error.validation.metadata.element.max-length"}}),this.qualifier=new p.rA_({id:"qualifier",label:this.translateService.instant(`${this.messagePrefix}.qualifier`),name:"qualifier",validators:{pattern:"^[^. ,]*$",maxLength:64},required:!1,errorMessages:{pattern:"error.validation.metadata.qualifier.invalid-pattern",maxLength:"error.validation.metadata.qualifier.max-length"}}),this.scopeNote=new p.Zex({id:"scopeNote",label:this.translateService.instant(`${this.messagePrefix}.scopenote`),name:"scopeNote",required:!1,rows:5}),this.formModel=[new p.iO5({id:"metadatadatafieldgroup",group:[this.element,this.qualifier,this.scopeNote]})],this.formGroup=this.formBuilderService.createFormGroup(this.formModel),this.registryService.getActiveMetadataField().subscribe(t=>{null==t?this.clearFields():(this.formGroup.patchValue({metadatadatafieldgroup:{element:t.element,qualifier:t.qualifier,scopeNote:t.scopeNote}}),this.element.disabled=!0,this.qualifier.disabled=!0)})}onCancel(){this.registryService.cancelEditMetadataField()}onSubmit(){this.registryService.getActiveMetadataField().pipe((0,u.s)(1)).subscribe(t=>{null==t?this.registryService.createMetadataField(Object.assign(new G.A,{element:this.element.value,qualifier:this.qualifier.value,scopeNote:this.scopeNote.value}),this.metadataSchema).subscribe(a=>{this.submitForm.emit(a)}):this.registryService.updateMetadataField(Object.assign(new G.A,t,{id:t.id,element:t.element,qualifier:t.qualifier,scopeNote:this.scopeNote.value})).subscribe(a=>{this.submitForm.emit(a)}),this.clearFields(),this.registryService.cancelEditMetadataField()})}clearFields(){this.formGroup.reset("metadatadatafieldgroup"),this.element.disabled=!1,this.qualifier.disabled=!1}ngOnDestroy(){this.onCancel()}static{this.\u0275fac=function(a){return new(a||s)(e.rXU(b.x),e.rXU(E.j),e.rXU(c.c$))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["ds-metadata-field-form"]],inputs:{metadataSchema:"metadataSchema"},outputs:{submitForm:"submitForm"},standalone:!0,features:[e.aNF],decls:4,vars:7,consts:[[3,"cancel","submit","formId","formModel","formLayout","formGroup"]],template:function(a,i){1&a&&(e.DNE(0,K,3,3,"h2"),e.nI1(1,"async"),e.DNE(2,q,3,3,"h2"),e.j41(3,"ds-form",0),e.bIt("cancel",function(){return i.onCancel()})("submit",function(){return i.onSubmit()}),e.k0s()),2&a&&(e.vxM(e.bMT(1,5,i.activeMetadataField$)?0:2),e.R7$(3),e.Y8G("formId",i.formId)("formModel",i.formModel)("formLayout",i.formLayout)("formGroup",i.formGroup))},dependencies:[m.Jj,k.s,c.h,c.D9],encapsulation:2})}}return s})();const H=s=>({namespace:s}),Q=()=>["/admin/registries/metadata"],ee=s=>({"table-primary":s});function te(s,l){if(1&s){const t=e.RV6();e.j41(0,"td")(1,"input",18),e.nI1(2,"translate"),e.bIt("change",function(i){e.eBV(t);const n=e.XpG().$implicit,o=e.XpG(4);return e.Njj(o.selectMetadataField(n,i))}),e.k0s()()}if(2&s){const t=l.ngVar;e.R7$(),e.Y8G("checked",t),e.BMQ("aria-label",e.bMT(2,2,t?"admin.registries.schema.fields.deselect":"admin.registries.schema.fields.select"))}}function ae(s,l){if(1&s){const t=e.RV6();e.j41(0,"tr",16),e.nI1(1,"async"),e.DNE(2,te,3,4,"td",7),e.nI1(3,"async"),e.j41(4,"td",17),e.bIt("click",function(){const i=e.eBV(t).$implicit,n=e.XpG(4);return e.Njj(n.editField(i))}),e.EFF(5),e.k0s(),e.j41(6,"td",17),e.bIt("click",function(){const i=e.eBV(t).$implicit,n=e.XpG(4);return e.Njj(n.editField(i))}),e.EFF(7),e.k0s(),e.j41(8,"td",17),e.bIt("click",function(){const i=e.eBV(t).$implicit,n=e.XpG(4);return e.Njj(n.editField(i))}),e.EFF(9),e.k0s()()}if(2&s){let t,a;const i=l.$implicit,n=e.XpG(3).ngVar,o=e.XpG();e.Y8G("ngClass",e.eq3(11,ee,(null==(t=e.bMT(1,7,o.activeField$))?null:t.id)===i.id)),e.R7$(2),e.Y8G("ngVar",null==(a=e.bMT(3,9,o.selectedMetadataFieldIDs$))?null:a.includes(i.id)),e.R7$(3),e.JRh(i.id),e.R7$(2),e.E5c("",null==n?null:n.prefix,".",i.element,"",i.qualifier?"."+i.qualifier:"",""),e.R7$(2),e.JRh(i.scopeNote)}}function ie(s,l){if(1&s&&(e.j41(0,"ds-pagination",8)(1,"div",12)(2,"table",13)(3,"thead")(4,"tr")(5,"th")(6,"span",14),e.EFF(7),e.nI1(8,"translate"),e.k0s()(),e.j41(9,"th",15),e.EFF(10),e.nI1(11,"translate"),e.k0s(),e.j41(12,"th",15),e.EFF(13),e.nI1(14,"translate"),e.k0s(),e.j41(15,"th",15),e.EFF(16),e.nI1(17,"translate"),e.k0s()()(),e.j41(18,"tbody"),e.Z7z(19,ae,10,13,"tr",16,e.fX1),e.k0s()()()()),2&s){const t=e.XpG().ngVar,a=e.XpG(2);e.Y8G("paginationOptions",a.config)("collectionSize",null==t?null:t.totalElements)("hideGear",!1)("hidePagerWhenSinglePage",!0),e.R7$(7),e.JRh(e.bMT(8,8,"admin.registries.schema.fields.table.selected")),e.R7$(3),e.JRh(e.bMT(11,10,"admin.registries.schema.fields.table.id")),e.R7$(3),e.JRh(e.bMT(14,12,"admin.registries.schema.fields.table.field")),e.R7$(3),e.JRh(e.bMT(17,14,"admin.registries.schema.fields.table.scopenote")),e.R7$(3),e.Dyx(null==t?null:t.page)}}function se(s,l){1&s&&(e.j41(0,"div",9),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&s&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"admin.registries.schema.fields.no-items")," "))}function ne(s,l){if(1&s){const t=e.RV6();e.j41(0,"button",19),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return e.Njj(i.deleteFields())}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}2&s&&(e.R7$(),e.JRh(e.bMT(2,1,"admin.registries.schema.fields.table.delete")))}function re(s,l){if(1&s&&(e.qex(0),e.DNE(1,ie,21,16,"ds-pagination",8)(2,se,3,3,"div",9),e.j41(3,"div")(4,"button",10),e.EFF(5),e.nI1(6,"translate"),e.k0s(),e.DNE(7,ne,3,3,"button",11),e.k0s(),e.bVm()),2&s){const t=l.ngVar;e.R7$(),e.vxM((null==t?null:t.totalElements)>0?1:-1),e.R7$(),e.vxM(0===(null==t?null:t.totalElements)?2:-1),e.R7$(2),e.Y8G("routerLink",e.lJ4(7,Q)),e.R7$(),e.JRh(e.bMT(6,5,"admin.registries.schema.return")),e.R7$(2),e.vxM((null==t||null==t.page?null:t.page.length)>0?7:-1)}}function oe(s,l){if(1&s){const t=e.RV6();e.j41(0,"div",3)(1,"h1",4),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"p",5),e.EFF(5),e.nI1(6,"translate"),e.k0s(),e.j41(7,"ds-metadata-field-form",6),e.bIt("submitForm",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.forceUpdateFields())}),e.k0s(),e.j41(8,"h2"),e.EFF(9),e.nI1(10,"translate"),e.k0s(),e.DNE(11,re,8,8,"ng-container",7),e.nI1(12,"async"),e.k0s()}if(2&s){let t;const a=l.ngVar,i=e.XpG();e.R7$(2),e.Lme("",e.bMT(3,6,"admin.registries.schema.head"),': "',null==a?null:a.prefix,'"'),e.R7$(3),e.JRh(e.i5U(6,8,"admin.registries.schema.description",e.eq3(15,H,null==a?null:a.namespace))),e.R7$(2),e.Y8G("metadataSchema",a),e.R7$(2),e.JRh(e.bMT(10,11,"admin.registries.schema.fields.head")),e.R7$(2),e.Y8G("ngVar",null==(t=e.bMT(12,13,i.metadataFields$))?null:t.payload)}}const ce=[{path:"metadata",resolve:{breadcrumb:f.S},data:{title:"admin.registries.metadata.title",breadcrumbKey:"admin.registries.metadata"},children:[{path:"",component:Y},{path:":schemaName",resolve:{breadcrumb:f.S},component:(()=>{class s{constructor(t,a,i,n,o){this.registryService=t,this.route=a,this.notificationsService=i,this.paginationService=n,this.translateService=o,this.config=Object.assign(new I.W,{id:"rm",pageSize:25,pageSizeOptions:[25,50,100,200]}),this.needsUpdate$=new y.t(!0),this.subscriptions=[]}ngOnInit(){this.metadataSchema$=this.registryService.getMetadataSchemaByPrefix(this.route.snapshot.params.schemaName).pipe((0,M.ak)()),this.activeField$=this.registryService.getActiveMetadataField(),this.selectedMetadataFieldIDs$=this.registryService.getSelectedMetadataFields().pipe((0,S.T)(t=>t.map(a=>a.id))),this.updateFields()}updateFields(){this.metadataFields$=this.paginationService.getCurrentPagination(this.config.id,this.config).pipe((0,h.n)(t=>(0,z.z)([this.metadataSchema$,this.needsUpdate$,(0,w.of)(t)])),(0,h.n)(([t,a,i])=>(a&&this.needsUpdate$.next(!1),this.registryService.getMetadataFieldsBySchema(t,j(i),!a,!0))))}forceUpdateFields(){this.registryService.clearMetadataFieldRequests(),this.needsUpdate$.next(!0)}editField(t){this.subscriptions.push(this.activeField$.pipe((0,u.s)(1)).subscribe(a=>{t===a?this.registryService.cancelEditMetadataField():this.registryService.editMetadataField(t)}))}selectMetadataField(t,a){a.target.checked?this.registryService.selectMetadataField(t):this.registryService.deselectMetadataField(t)}deleteFields(){this.subscriptions.push(this.selectedMetadataFieldIDs$.pipe((0,u.s)(1),(0,h.n)(t=>(0,$.y)(t.map(a=>this.registryService.deleteMetadataField(a).pipe((0,M.qD)()))))).subscribe(t=>{const a=t.filter(n=>n.hasSucceeded),i=t.filter(n=>n.hasFailed);a.length>0&&this.showNotification(!0,a.length),i.length>0&&this.showNotification(!1,i.length),this.registryService.deselectAllMetadataField(),this.registryService.cancelEditMetadataField()}))}showNotification(t,a){const i="admin.registries.schema.notification",n=t?"success":"failure",o=this.translateService.instant(`${i}.${n}`),d=this.translateService.instant(`${i}.field.deleted.${n}`,{amount:a});t?this.notificationsService.success(o,d):this.notificationsService.error(o,d)}ngOnDestroy(){this.paginationService.clearPagination(this.config.id),this.registryService.deselectAllMetadataField(),this.subscriptions.forEach(t=>t.unsubscribe())}static{this.\u0275fac=function(a){return new(a||s)(e.rXU(b.x),e.rXU(g.nX),e.rXU(T.I),e.rXU(R.m),e.rXU(c.c$))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["ds-metadata-schema"]],standalone:!0,features:[e.aNF],decls:4,vars:3,consts:[[1,"container"],[1,"metadata-schema","row"],["class","col-12",4,"ngVar"],[1,"col-12"],["id","header",1,"border-bottom","pb-2"],["id","description",1,"pb-2"],[3,"submitForm","metadataSchema"],[4,"ngVar"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage"],["role","alert",1,"alert","alert-info","w-100","mb-2"],[1,"btn","btn-primary",3,"routerLink"],["type","submit",1,"btn","btn-danger","float-end"],[1,"table-responsive"],["id","metadata-fields",1,"table","table-striped","table-hover"],[1,"sr-only"],["scope","col"],[3,"ngClass"],[1,"selectable-row",3,"click"],["type","checkbox",3,"change","checked"],["type","submit",1,"btn","btn-danger","float-end",3,"click"]],template:function(a,i){1&a&&(e.j41(0,"div",0)(1,"div",1),e.DNE(2,oe,13,17,"div",2),e.nI1(3,"async"),e.k0s()()),2&a&&(e.R7$(2),e.Y8G("ngVar",e.bMT(3,1,i.metadataSchema$)))},dependencies:[m.Jj,Z,m.YU,C.e,g.Wk,c.h,c.D9,W.r],styles:[".selectable-row[_ngcontent-%COMP%]:hover{cursor:pointer}[_nghost-%COMP%]     #metadatadatafieldgroup{display:flex;flex-wrap:wrap}"]})}}return s})(),data:{title:"admin.registries.schema.title",breadcrumbKey:"admin.registries.schema"}}]},{path:v.B,resolve:{breadcrumb:f.S},loadChildren:()=>r.e(5311).then(r.bind(r,75311)).then(s=>s.ROUTES),data:{title:"admin.registries.bitstream-formats.title",breadcrumbKey:"admin.registries.bitstream-formats"}}]},25287:(N,_,r)=>{r.d(_,{B:()=>m,J:()=>g});var f=r(5127),v=r(83);const m="bitstream-formats";function g(){return new f.t((0,v.P$)(),m).toString()}}}]);