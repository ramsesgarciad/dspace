"use strict";(self.webpackChunkdspace_angular=self.webpackChunkdspace_angular||[]).push([[372],{99125:(I,E,o)=>{o.d(E,{W:()=>D});var v=o(96354),f=o(96697),l=o(54104),_=o(4093),M=o(89777),d=o(9847),r=o(54438),i=o(7901),p=o(68018);let D=(()=>{class C{constructor(a,u,P,h,g){this.dsoDataService=a,this.router=u,this.route=P,this.notificationsService=h,this.translate=g}ngOnInit(){this.dsoRD$=this.route.parent.data.pipe((0,v.T)(a=>a.dso))}onSubmit(a){(0,M.Im)(a.operations)?this.router.navigate([this.frontendURL,a.dso.uuid]):this.dsoDataService.patch(a.dso,a.operations).pipe((0,_.qD)()).subscribe(u=>{u.hasSucceeded?(this.router.navigate([this.frontendURL,a.dso.uuid]),this.notificationsService.success(null,this.translate.get(`${this.type.value}.edit.notifications.success`))):this.notificationsService.error(null,this.translate.get(403===u.statusCode?`${this.type.value}.edit.notifications.unauthorized`:`${this.type.value}.edit.notifications.error`))})}navigateToHomePage(){this.dsoRD$.pipe((0,_.yd)(),(0,f.s)(1)).subscribe(a=>{this.router.navigate([this.frontendURL+a.payload.id])})}static{this.\u0275fac=function(u){return new(u||C)(r.rXU(l.x),r.rXU(i.Ix),r.rXU(i.nX),r.rXU(d.I),r.rXU(p.c$))}}static{this.\u0275cmp=r.VBU({type:C,selectors:[["ds-comcol-metadata"]],standalone:!0,features:[r.aNF],decls:0,vars:0,template:function(u,P){},encapsulation:2})}}return C})()},60185:(I,E,o)=>{o.d(E,{J:()=>N});var v=o(60177),f=o(7901),l=o(68018),_=o(84412),M=o(25558),d=o(5964),r=o(96354),i=o(56977),p=o(42589),D=o(43446),C=o(3601),T=o(2086),a=o(4093),u=o(64972),P=o(3116),h=o(89777),g=o(15202),O=o(9847),$=o(95038),U=o(50186),t=o(54438),y=o(58003);function B(s,R){1&s&&t.nrm(0,"ds-loading")}function L(s,R){1&s&&(t.j41(0,"div"),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&s&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"comcol-role.edit.no-group")," "))}function b(s,R){if(1&s&&(t.j41(0,"div"),t.EFF(1),t.nI1(2,"async"),t.nI1(3,"translate"),t.k0s()),2&s){let e;const n=t.XpG(2);t.R7$(),t.SpI(" ",t.bMT(3,3,"comcol-role.edit."+(null==(e=t.bMT(2,1,n.comcolRole$))?null:e.name)+".anonymous-group")," ")}}function x(s,R){if(1&s&&(t.j41(0,"a",7),t.nI1(1,"async"),t.EFF(2),t.k0s()),2&s){const e=t.XpG().ngVar,n=t.XpG();t.Y8G("routerLink",t.bMT(1,2,n.editGroupLink$)),t.R7$(2),t.SpI(" ",n.dsoNameService.getName(e)," ")}}function S(s,R){if(1&s){const e=t.RV6();t.j41(0,"button",12),t.bIt("click",function(){t.eBV(e);const c=t.XpG(2);return t.Njj(c.create())}),t.nrm(1,"i",13),t.EFF(2),t.nI1(3,"translate"),t.k0s()}2&s&&(t.R7$(2),t.SpI(" ",t.bMT(3,1,"comcol-role.edit.create")," "))}function A(s,R){if(1&s){const e=t.RV6();t.j41(0,"button",14),t.bIt("click",function(){t.eBV(e);const c=t.XpG(2);return t.Njj(c.create())}),t.EFF(1),t.nI1(2,"translate"),t.k0s()}2&s&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"comcol-role.edit.restrict")," "))}function W(s,R){if(1&s){const e=t.RV6();t.j41(0,"button",15),t.bIt("click",function(){t.eBV(e);const c=t.XpG().ngVar,m=t.XpG();return t.Njj(m.confirmDelete(m.dsoNameService.getName(c)))}),t.nrm(1,"i",16),t.EFF(2),t.nI1(3,"translate"),t.k0s()}2&s&&(t.R7$(2),t.SpI(" ",t.bMT(3,1,"comcol-role.edit.delete")," "))}function K(s,R){if(1&s&&(t.j41(0,"div",1)(1,"h2",2),t.EFF(2),t.nI1(3,"async"),t.k0s(),t.j41(4,"div",3)(5,"ds-alert",4),t.EFF(6),t.nI1(7,"async"),t.nI1(8,"translate"),t.k0s()(),t.j41(9,"div",5)(10,"div",6),t.DNE(11,B,1,0,"ds-loading"),t.nI1(12,"async"),t.nI1(13,"dsHasNoValue"),t.DNE(14,L,3,3,"div"),t.nI1(15,"async"),t.DNE(16,b,4,5,"div"),t.nI1(17,"async"),t.DNE(18,x,3,4,"a",7),t.nI1(19,"async"),t.k0s(),t.j41(20,"div",8),t.DNE(21,S,4,3,"button",9),t.nI1(22,"async"),t.DNE(23,A,3,3,"button",10),t.nI1(24,"async"),t.DNE(25,W,4,3,"button",11),t.nI1(26,"async"),t.k0s()()()),2&s){let e;const n=t.XpG();t.R7$(2),t.SpI(" ",t.bMT(3,10,n.roleName$)," "),t.R7$(3),t.Y8G("type","alert-info"),t.R7$(),t.JRh(t.bMT(8,14,"comcol-role.edit."+(null==(e=t.bMT(7,12,n.comcolRole$))?null:e.name)+".description")),t.R7$(5),t.vxM(t.bMT(13,18,t.bMT(12,16,n.groupRD$))?11:-1),t.R7$(3),t.vxM(t.bMT(15,20,n.hasNoGroup$)?14:-1),t.R7$(2),t.vxM(t.bMT(17,22,n.hasAnonymousGroup$)?16:-1),t.R7$(2),t.vxM(t.bMT(19,24,n.hasCustomGroup$)?18:-1),t.R7$(3),t.vxM(t.bMT(22,26,n.hasNoGroup$)?21:-1),t.R7$(2),t.vxM(t.bMT(24,28,n.hasAnonymousGroup$)?23:-1),t.R7$(2),t.vxM(t.bMT(26,30,n.hasCustomGroup$)?25:-1)}}let N=(()=>{class s{constructor(e,n,c,m,j,G){this.requestService=e,this.groupService=n,this.notificationsService=c,this.translateService=m,this.dsoNameService=j,this.modalService=G,this.comcolRole$=new _.t(void 0)}get groupLink(){return this.comcolRole.href}set comcolRole(e){this.comcolRole$.next(e)}get comcolRole(){return this.comcolRole$.getValue()}create(){this.groupService.createComcolGroup(this.dso,this.comcolRole.name,this.groupLink).pipe((0,a.qD)()).subscribe(e=>{e.hasSucceeded?(this.groupService.clearGroupsRequests(),this.requestService.setStaleByHrefSubstring(this.comcolRole.href)):this.notificationsService.error(this.roleName$.pipe((0,M.n)(n=>this.translateService.get("comcol-role.edit.create.error.title",{role:n}))),`${e.statusCode} ${e.errorMessage}`)})}delete(){this.groupService.deleteComcolGroup(this.groupLink).pipe((0,a.qD)()).subscribe(e=>{e.hasSucceeded?(this.groupService.clearGroupsRequests(),this.requestService.setStaleByHrefSubstring(this.comcolRole.href)):this.notificationsService.error(this.roleName$.pipe((0,M.n)(n=>this.translateService.get("comcol-role.edit.delete.error.title",{role:n}))),e.errorMessage)})}ngOnInit(){this.groupRD$=this.comcolRole$.pipe((0,d.p)(e=>(0,h.a4)(e)),(0,M.n)(e=>this.groupService.findByHref(e.href)),(0,a.bD)()),this.group$=this.groupRD$.pipe((0,r.T)(e=>{if((0,h.a4)(e.payload))return e.payload})),this.editGroupLink$=this.group$.pipe((0,r.T)(e=>(0,h.a4)(e)?(0,p.xl)(e.id):void 0)),this.hasNoGroup$=this.group$.pipe((0,r.T)(e=>(0,h.Tn)(e))),this.hasAnonymousGroup$=this.group$.pipe((0,r.T)(e=>(0,h.a4)(e)&&"Anonymous"===e.name)),this.hasCustomGroup$=this.group$.pipe((0,r.T)(e=>(0,h.a4)(e)&&"Anonymous"!==e.name)),this.roleName$=this.translateService.get(`comcol-role.edit.${this.comcolRole.name}.name`)}confirmDelete(e){const n=this.modalService.open(P.M);n.componentInstance.name=e,n.componentInstance.headerLabel="comcol-role.edit.delete.modal.header",n.componentInstance.infoLabel="comcol-role.edit.delete.modal.info",n.componentInstance.cancelLabel="comcol-role.edit.delete.modal.cancel",n.componentInstance.confirmLabel="comcol-role.edit.delete.modal.confirm",n.componentInstance.brandColor="danger",n.componentInstance.confirmIcon="fas fa-trash";const c=n.componentInstance.response.pipe((0,i.Q)(n.closed)).subscribe(m=>{!0===m&&this.delete()});n.result.then().finally(()=>{n.close(),c&&!c.closed&&c.unsubscribe()})}static{this.\u0275fac=function(n){return new(n||s)(t.rXU(C.B),t.rXU(T.GroupDataService),t.rXU(O.I),t.rXU(l.c$),t.rXU(D.f),t.rXU(y.Bq))}}static{this.\u0275cmp=t.VBU({type:s,selectors:[["ds-comcol-role"]],inputs:{dso:"dso",comcolRole:"comcolRole"},standalone:!0,features:[t.aNF],decls:4,vars:8,consts:[["class","card-body d-flex flex-column",4,"ngVar"],[1,"card-body","d-flex","flex-column"],[1,"h4","w-100"],[1,"mt-2","mb-2"],[3,"type"],[1,"d-flex","flex-md-row","justify-content-between","flex-column"],[1,"w-100","d-flex","align-items-center"],[3,"routerLink"],[1,"flex-shrink-0"],[1,"btn","btn-primary","create"],[1,"btn","btn-primary","restrict"],[1,"btn","btn-danger","delete"],[1,"btn","btn-primary","create",3,"click"],["aria-hidden","true",1,"fas","fa-plus"],[1,"btn","btn-primary","restrict",3,"click"],[1,"btn","btn-danger","delete",3,"click"],["aria-hidden","true",1,"fas","fa-trash"]],template:function(n,c){if(1&n&&(t.j41(0,"div"),t.nI1(1,"async"),t.DNE(2,K,27,32,"div",0),t.nI1(3,"async"),t.k0s()),2&n){let m;t.ZvI("card p-2 mb-3 mt-3 custom-alignment ",null==(m=t.bMT(1,4,c.comcolRole$))?null:m.name,""),t.R7$(2),t.Y8G("ngVar",t.bMT(3,6,c.group$))}},dependencies:[u.C,v.Jj,$.n,f.Wk,g.v,l.h,l.D9,U.r]})}}return s})()},41744:(I,E,o)=>{o.d(E,{M:()=>M});var v=o(96354),f=o(89777),l=o(54438),_=o(7901);let M=(()=>{class d{constructor(i,p){this.router=i,this.route=p,this.router.events.subscribe(()=>this.initPageParamsByRoute())}ngOnInit(){this.initPageParamsByRoute(),this.pages=this.route.routeConfig.children.map(i=>i.path).filter(i=>(0,f.hj)(i)),this.dsoRD$=this.route.data.pipe((0,v.T)(i=>i.dso))}getPageUrl(i){return this.router.url}initPageParamsByRoute(){this.currentPage=this.route.snapshot.firstChild.routeConfig.path,this.hideReturnButton=this.route.routeConfig.children.find(i=>i.path===this.currentPage).data.hideReturnButton}static{this.\u0275fac=function(p){return new(p||d)(l.rXU(_.Ix),l.rXU(_.nX))}}static{this.\u0275cmp=l.VBU({type:d,selectors:[["ds-edit-comcol"]],standalone:!0,features:[l.aNF],decls:0,vars:0,template:function(p,D){},encapsulation:2})}}return d})()},95038:(I,E,o)=>{o.d(E,{n:()=>l});var v=o(89777),f=o(54438);let l=(()=>{class _{transform(d){return(0,v.Tn)(d)}static{this.\u0275fac=function(r){return new(r||_)}}static{this.\u0275pipe=f.EJ8({name:"dsHasNoValue",type:_,pure:!0,standalone:!0})}}return _})()}}]);