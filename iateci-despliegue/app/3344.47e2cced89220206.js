"use strict";(self.webpackChunkdspace_angular=self.webpackChunkdspace_angular||[]).push([[3344],{3344:(tt,p,e)=>{e.r(p),e.d(p,{ROUTES:()=>q});var m=e(60177),r=e(68018),u=e(84412),h=e(44668),f=e(20140),c=e(96697),v=e(96354),g=e(88141),S=e(25558),R=e(94196),I=e(58956),T=e(31),$=e(4093),y=e(73409),C=e(64972),F=e(74082),l=e(89777),M=e(15202),P=e(2175),j=e(8417),t=e(54438),E=e(7901),x=e(15343),D=e(43446),G=(e(73685),e(79104)),V=e(3116),N=e(91880),X=(e(49886),e(84981)),d=e(41947),B=e(58003);const U=["ds-subscription-view",""];function J(s,a){if(1&s&&(t.nrm(0,"ds-type-badge",9),t.j41(1,"p")(2,"a",10),t.EFF(3),t.k0s()()),2&s){const n=t.XpG();t.Y8G("object",n.dso),t.R7$(2),t.Y8G("routerLink",n.getPageRoute(n.dso)),t.R7$(),t.JRh(n.dsoNameService.getName(n.dso))}}function L(s,a){1&s&&(t.j41(0,"p",11),t.EFF(1),t.nI1(2,"translate"),t.k0s(),t.j41(3,"p",12),t.EFF(4),t.nI1(5,"translate"),t.k0s()),2&s&&(t.R7$(),t.JRh(t.bMT(2,2,"subscriptions.table.not-available")),t.R7$(3),t.JRh(t.bMT(5,4,"subscriptions.table.not-available-message")))}function Y(s,a){if(1&s&&(t.j41(0,"span",1),t.EFF(1),t.k0s()),2&s){const n=t.XpG();t.R7$(),t.JRh(n.subscription.subscriptionType)}}function O(s,a){1&s&&(t.j41(0,"span"),t.EFF(1,","),t.k0s())}function z(s,a){if(1&s&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"translate"),t.DNE(3,O,2,0,"span"),t.k0s()),2&s){const n=a.$implicit,i=a.$index,o=t.XpG(2);t.R7$(),t.SpI(" ",t.bMT(2,2,"subscriptions.frequency."+n.value),""),t.R7$(2),t.vxM(i<o.subscription.subscriptionParameterList.length-1?3:-1)}}function W(s,a){if(1&s&&t.Z7z(0,z,4,4,"span",null,t.fX1),2&s){const n=t.XpG();t.Dyx(n.subscription.subscriptionParameterList)}}let A=(()=>{class s{constructor(n,i,o){this.modalService=n,this.subscriptionService=i,this.dsoNameService=o,this.reload=new t.bkB}getPageRoute(n){return(0,x.wN)(n)}deleteSubscriptionPopup(n){if((0,l.a4)(n.id)){const i=this.modalService.open(V.M);i.componentInstance.name=this.dsoNameService.getName(this.dso),i.componentInstance.headerLabel="confirmation-modal.delete-subscription.header",i.componentInstance.infoLabel="confirmation-modal.delete-subscription.info",i.componentInstance.cancelLabel="confirmation-modal.delete-subscription.cancel",i.componentInstance.confirmLabel="confirmation-modal.delete-subscription.confirm",i.componentInstance.brandColor="danger",i.componentInstance.confirmIcon="fas fa-trash",i.componentInstance.response.pipe((0,c.s)(1)).subscribe(o=>{o&&this.subscriptionService.deleteSubscription(n.id).subscribe(b=>{this.reload.emit()})})}}openSubscriptionModal(){this.modalRef=this.modalService.open(X.w),this.modalRef.componentInstance.dso=this.dso,this.modalRef.componentInstance.subscription=this.subscription,this.modalRef.componentInstance.updateSubscription.pipe((0,c.s)(1)).subscribe(n=>{this.subscription=n})}static{this.\u0275fac=function(i){return new(i||s)(t.rXU(B.Bq),t.rXU(d.SubscriptionsDataService),t.rXU(D.f))}}static{this.\u0275cmp=t.VBU({type:s,selectors:[["","ds-subscription-view",""]],inputs:{subscription:"subscription",dso:"dso",eperson:"eperson"},outputs:{reload:"reload"},standalone:!0,features:[t.aNF],attrs:U,decls:15,vars:11,consts:[[1,"dso-info"],[1,"subscription-type"],[1,"subscription-parameters"],[1,"subscription-actions"],[1,"btn-group","edit-field"],[1,"btn","btn-outline-primary","btn-sm","access-control-editEPersonButton",3,"click","dsBtnDisabled","title"],[1,"fas","fa-edit","fa-fw"],[1,"btn","btn-outline-danger","btn-sm","access-control-deleteEPersonButton",3,"click","title"],[1,"fas","fa-trash-alt","fa-fw"],[3,"object"],[3,"routerLink"],[1,"my-0"],[1,"text-muted","my-0"]],template:function(i,o){1&i&&(t.j41(0,"td",0),t.DNE(1,J,4,3)(2,L,6,6),t.k0s(),t.j41(3,"td"),t.DNE(4,Y,2,1,"span",1),t.k0s(),t.j41(5,"td",2),t.DNE(6,W,2,0),t.k0s(),t.j41(7,"td",3)(8,"div",4)(9,"button",5),t.nI1(10,"translate"),t.bIt("click",function(_){return _.preventDefault(),o.openSubscriptionModal()}),t.nrm(11,"i",6),t.k0s(),t.j41(12,"button",7),t.nI1(13,"translate"),t.bIt("click",function(){return o.deleteSubscriptionPopup(o.subscription)}),t.nrm(14,"i",8),t.k0s()()()),2&i&&(t.R7$(),t.vxM(o.dso?1:-1),t.R7$(),t.vxM(o.dso?-1:2),t.R7$(2),t.vxM(o.subscription?4:-1),t.R7$(2),t.vxM(o.subscription?6:-1),t.R7$(3),t.Y8G("dsBtnDisabled",!o.dso)("title",t.bMT(10,7,"subscriptions.table.edit")),t.R7$(3),t.Y8G("title",t.bMT(13,9,"subscriptions.table.delete")))},dependencies:[G.A,E.Wk,N.C,r.h,r.D9]})}}return s})();var Z=e(50186);function k(s,a){1&s&&t.nrm(0,"ds-loading")}function Q(s,a){if(1&s){const n=t.RV6();t.j41(0,"tr",11),t.nI1(1,"async"),t.nI1(2,"async"),t.bIt("reload",function(){t.eBV(n);const o=t.XpG(3);return t.Njj(o.refresh())}),t.k0s()}if(2&s){let n,i;const o=a.$implicit;t.Y8G("dso",null==(n=t.bMT(1,3,null==o?null:o.resource))?null:n.payload)("eperson",null==(i=t.bMT(2,5,null==o?null:o.eperson))||null==i.payload?null:i.payload.id)("subscription",o)}}function H(s,a){if(1&s&&(t.j41(0,"ds-pagination",4)(1,"div",6)(2,"table",7)(3,"thead")(4,"tr")(5,"th",8),t.EFF(6),t.nI1(7,"translate"),t.k0s(),t.j41(8,"th",9),t.EFF(9),t.nI1(10,"translate"),t.k0s(),t.j41(11,"th",9),t.EFF(12),t.nI1(13,"translate"),t.k0s(),t.j41(14,"th",9),t.EFF(15),t.nI1(16,"translate"),t.k0s()()(),t.j41(17,"tbody"),t.Z7z(18,Q,3,7,"tr",10,t.fX1),t.k0s()()()()),2&s){const n=t.XpG().ngVar,i=t.XpG();t.Y8G("paginationOptions",i.config)("collectionSize",null==n||null==n.pageInfo?null:n.pageInfo.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),t.R7$(6),t.JRh(t.bMT(7,8,"subscriptions.table.dso")),t.R7$(3),t.JRh(t.bMT(10,10,"subscriptions.table.subscription_type")),t.R7$(3),t.JRh(t.bMT(13,12,"subscriptions.table.subscription_frequency")),t.R7$(3),t.JRh(t.bMT(16,14,"subscriptions.table.action")),t.R7$(3),t.Dyx(null==n?null:n.page)}}function K(s,a){if(1&s&&(t.j41(0,"ds-alert",5),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&s){const n=t.XpG(2);t.Y8G("type",n.AlertType.Info),t.R7$(),t.SpI(" ",t.bMT(2,2,"subscriptions.table.empty.message")," ")}}function w(s,a){if(1&s&&(t.qex(0),t.DNE(1,H,20,16,"ds-pagination",4),t.nI1(2,"async"),t.DNE(3,K,3,4,"ds-alert",5),t.nI1(4,"async"),t.bVm()),2&s){const n=a.ngVar,i=t.XpG();t.R7$(),t.vxM((null==n||null==n.pageInfo?null:n.pageInfo.totalElements)>0&&!0!==t.bMT(2,2,i.loading$)?1:-1),t.R7$(2),t.vxM(0===(null==n||null==n.pageInfo?null:n.pageInfo.totalElements)&&!0!==t.bMT(4,4,i.loading$)?3:-1)}}const q=[{path:"",data:{title:"subscriptions.title"},children:[{path:"",component:(()=>{class s{constructor(n,i,o){this.paginationService=n,this.authService=i,this.subscriptionService=o,this.subscriptions$=new u.t((0,I.g)(new y.Q,[])),this.config=Object.assign(new j.W,{id:"elp",pageSize:10,currentPage:1}),this.loading$=new u.t(!1),this.sub=null,this.AlertType=F.v}ngOnInit(){this.ePersonId$=this.authService.getAuthenticatedUserFromStore().pipe((0,c.s)(1),(0,v.T)(n=>n.id),(0,h.t)({refCount:!1})),this.retrieveSubscriptions()}retrieveSubscriptions(){this.sub=this.paginationService.getCurrentPagination(this.config.id,this.config).pipe((0,f.v)(this.ePersonId$),(0,g.M)(()=>this.loading$.next(!0)),(0,S.n)(([n,i])=>this.subscriptionService.findByEPerson(i,{currentPage:n.currentPage,elementsPerPage:n.pageSize})),(0,$.bD)()).subscribe(n=>{n.hasSucceeded&&this.subscriptions$.next(n.payload),this.loading$.next(!1)})}refresh(){(0,l.a4)(this.sub)&&this.sub.unsubscribe(),this.retrieveSubscriptions()}ngOnDestroy(){(0,l.a4)(this.sub)&&this.sub.unsubscribe()}static{this.\u0275fac=function(i){return new(i||s)(t.rXU(T.m),t.rXU(R.uR),t.rXU(d.SubscriptionsDataService))}}static{this.\u0275cmp=t.VBU({type:s,selectors:[["ds-subscriptions-page"]],standalone:!0,features:[t.aNF],decls:12,vars:9,consts:[[1,"container"],[1,"row"],[1,"col-md-12","m-40"],[4,"ngVar"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage"],["data-test","empty-alert",3,"type"],[1,"table-responsive"],["id","formats","data-test","subscription-table",1,"table","table-striped","table-hover"],["scope","col",2,"width","50%"],["scope","col"],["ds-subscription-view","",3,"dso","eperson","subscription"],["ds-subscription-view","",3,"reload","dso","eperson","subscription"]],template:function(i,o){1&i&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),t.EFF(4),t.nI1(5,"translate"),t.k0s(),t.j41(6,"div",1)(7,"div",2),t.DNE(8,k,1,0,"ds-loading"),t.nI1(9,"async"),t.DNE(10,w,5,6,"ng-container",3),t.nI1(11,"async"),t.k0s()()()()()),2&i&&(t.R7$(4),t.JRh(t.bMT(5,3,"subscriptions.title")),t.R7$(4),t.vxM(t.bMT(9,5,o.loading$)?8:-1),t.R7$(2),t.Y8G("ngVar",t.bMT(11,7,o.subscriptions$)))},dependencies:[C.C,m.Jj,P.e,A,M.v,r.h,r.D9,Z.r]})}}return s})()}]}]}}]);