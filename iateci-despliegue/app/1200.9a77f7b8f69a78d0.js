"use strict";(self.webpackChunkdspace_angular=self.webpackChunkdspace_angular||[]).push([[1200,3271],{63271:(R,D,i)=>{i.r(D),i.d(D,{BulkAccessConfigDataService:()=>_});var r=i(57775),m=i(81948),C=i(3601),I=i(7094),T=i(84963),g=i(54438);let _=(()=>{class p extends T.O{constructor(h,A,o,u){super("bulkaccessconditionoptions",h,A,o,u),this.requestService=h,this.rdbService=A,this.objectCache=o,this.halService=u}static{this.\u0275fac=function(A){return new(A||p)(g.KVO(C.B),g.KVO(r.o),g.KVO(m.$),g.KVO(I.Y))}}static{this.\u0275prov=g.jDH({token:p,factory:p.\u0275fac,providedIn:"root"})}}return p})()},84963:(R,D,i)=>{i.d(D,{O:()=>I});var r=i(96354),m=i(20881),C=i(4093);class I extends m.W{findByHref(g,_=!0,p=!0,...S){return super.findByHref(g,_,p,...S).pipe((0,C.qD)(),(0,r.T)(h=>{if(h.hasFailed)throw new Error("Couldn't retrieve the config");return h}))}findByName(g,_=!0,p=!0,...S){return super.findById(g,_,p,...S)}}},21200:(R,D,i)=>{i.d(D,{o:()=>ce});var r=i(60177),m=i(89417),C=i(68018),I=i(84786),T=i(44668),g=i(70274),_=i(96354),p=i(96697),S=i(63271),A=(i(25788),i(4093)),o=i(64972),u=i(74082),d=i(79104),f=i(76089),b=i(58003),M=i(50813),e=i(54438);let F=(()=>{class a{transform(t){if(!t)return null;const n=new Date(t);return{year:n.getFullYear(),month:n.getMonth()+1,day:n.getDate()}}static{this.\u0275fac=function(n){return new(n||a)}}static{this.\u0275pipe=e.EJ8({name:"toDate",type:a,pure:!1,standalone:!0})}}return a})();const O=["ngForm"];function L(a,v){1&a&&(e.j41(0,"div",3),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&a&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"access-control-no-access-conditions-warning-message")," "))}function w(a,v){if(1&a&&(e.j41(0,"option",11),e.EFF(1),e.k0s()),2&a){const t=v.$implicit;e.Y8G("value",t.name),e.R7$(),e.SpI(" ",t.name," ")}}function $(a,v){if(1&a){const t=e.RV6();e.j41(0,"div",13)(1,"label",8),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"div",15)(5,"input",18,1),e.nI1(7,"toDate"),e.mxI("ngModelChange",function(s){e.eBV(t);const c=e.XpG().$implicit;return e.DH7(c.startDate,s)||(c.startDate=s),e.Njj(s)}),e.k0s(),e.j41(8,"div",19)(9,"button",20),e.bIt("click",function(){e.eBV(t);const s=e.sdS(6);return e.Njj(s.toggle())}),e.k0s()()(),e.j41(10,"small",12),e.EFF(11),e.nI1(12,"translate"),e.k0s()()}if(2&a){const t=e.XpG().$implicit;e.XpG();const n=e.sdS(1);e.R7$(),e.Mz_("for","accesscontrolstartdate-",t.id,""),e.R7$(),e.SpI(" ",e.bMT(3,11,"access-control-option-start-date")," "),e.R7$(3),e.Mz_("id","accesscontrolstartdate-",t.id,""),e.Mz_("name","startDate-",t.id,""),e.R50("ngModel",t.startDate),e.Y8G("maxDate",e.bMT(7,13,t.maxStartDate)),e.R7$(4),e.Y8G("dsBtnDisabled",n.disabled),e.R7$(2),e.SpI(" ",e.bMT(12,15,"access-control-option-start-date-note")," ")}}function x(a,v){if(1&a){const t=e.RV6();e.j41(0,"div",13)(1,"label",8),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"div",15)(5,"input",18,2),e.nI1(7,"toDate"),e.mxI("ngModelChange",function(s){e.eBV(t);const c=e.XpG().$implicit;return e.DH7(c.endDate,s)||(c.endDate=s),e.Njj(s)}),e.k0s(),e.j41(8,"div",19)(9,"button",20),e.bIt("click",function(){e.eBV(t);const s=e.sdS(6);return e.Njj(s.toggle())}),e.k0s()()(),e.j41(10,"small",12),e.EFF(11),e.nI1(12,"translate"),e.k0s()()}if(2&a){const t=e.XpG().$implicit;e.XpG();const n=e.sdS(1);e.R7$(),e.Mz_("for","accesscontrolenddate-",t.id,""),e.R7$(),e.SpI(" ",e.bMT(3,11,"access-control-option-end-date")," "),e.R7$(3),e.Mz_("id","accesscontrolenddate-",t.id,""),e.Mz_("name","endDate-",t.id,""),e.R50("ngModel",t.endDate),e.Y8G("maxDate",e.bMT(7,13,t.maxEndDate)),e.R7$(4),e.Y8G("dsBtnDisabled",n.disabled),e.R7$(2),e.SpI(" ",e.bMT(12,15,"access-control-option-end-date-note")," ")}}function P(a,v){if(1&a){const t=e.RV6();e.j41(0,"div",4)(1,"div",7)(2,"div")(3,"label",8),e.EFF(4),e.nI1(5,"translate"),e.k0s(),e.j41(6,"select",9),e.mxI("ngModelChange",function(s){const c=e.eBV(t).$implicit;return e.DH7(c.itemName,s)||(c.itemName=s),e.Njj(s)}),e.bIt("ngModelChange",function(s){const c=e.eBV(t).$implicit,k=e.XpG();return e.Njj(k.accessControlChanged(c,s))}),e.nrm(7,"option",10),e.Z7z(8,w,2,2,"option",11,e.fX1),e.k0s(),e.j41(10,"small",12),e.EFF(11),e.nI1(12,"translate"),e.k0s()(),e.DNE(13,$,13,17,"div",13)(14,x,13,17,"div",13),e.k0s(),e.j41(15,"div")(16,"span",14),e.EFF(17,"\xa0"),e.k0s(),e.j41(18,"div",15)(19,"button",16),e.nI1(20,"translate"),e.bIt("click",function(){const s=e.eBV(t).$implicit,c=e.XpG();return e.Njj(c.removeAccessControlItem(s.id))}),e.nrm(21,"i",17),e.k0s()()()()}if(2&a){const t=v.$implicit,n=e.XpG(),s=e.sdS(1);e.Mz_("ngModelGroup","access-control-item-",t.id,""),e.R7$(3),e.Mz_("for","accesscontroloption-",t.id,""),e.R7$(),e.SpI(" ",e.bMT(5,16,"access-control-option-label")," "),e.R7$(2),e.Mz_("id","accesscontroloption-",t.id,""),e.Mz_("name","itemName-",t.id,""),e.Y8G("disabled",s.disabled),e.R50("ngModel",t.itemName),e.R7$(2),e.Dyx(n.dropdownOptions),e.R7$(3),e.SpI(" ",e.bMT(12,18,"access-control-option-note")," "),e.R7$(2),e.vxM(t.hasStartDate?13:-1),e.R7$(),e.vxM(t.hasEndDate?14:-1),e.R7$(5),e.Y8G("dsBtnDisabled",s.disabled||1===n.form.accessControls.length),e.BMQ("aria-label",e.bMT(20,20,"access-control-remove"))}}let N=(()=>{class a{constructor(){this.dropdownOptions=[],this.form={accessControls:[B()]},this.formDisabled=!0,this.disable=()=>{this.ngForm.form.disable(),this.formDisabled=!0},this.enable=()=>{this.ngForm.form.enable(),this.formDisabled=!1}}ngOnInit(){this.disable()}get allControlsAreEmpty(){return this.form.accessControls.every(t=>null===t.itemName||""===t.itemName)}get showWarning(){return"replace"===this.mode&&this.allControlsAreEmpty&&!this.formDisabled}addAccessControlItem(t=null){this.form.accessControls=[...this.form.accessControls,{...B(),itemName:t}]}removeAccessControlItem(t){this.form.accessControls=this.form.accessControls.filter(n=>n.id!==t)}getValue(){return this.form.accessControls.filter(t=>null!==t.itemName&&""!==t.itemName).map(t=>({name:t.itemName,startDate:t.startDate?(0,M.Sd)(t.startDate):null,endDate:t.endDate?(0,M.Sd)(t.endDate):null}))}reset(){this.form.accessControls=[],this.addAccessControlItem(),this.disable()}accessControlChanged(t,n){const s=this.dropdownOptions.find(c=>c.name===n);t.startDate=null,t.endDate=null,t.hasStartDate=s?.hasStartDate||!1,t.hasEndDate=s?.hasEndDate||!1,t.maxStartDate=s?.maxStartDate||null,t.maxEndDate=s?.maxEndDate||null}trackById(t,n){return n.id}isValid(){return this.ngForm.valid}static{this.\u0275fac=function(n){return new(n||a)}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["ds-access-control-array-form"]],viewQuery:function(n,s){if(1&n&&e.GBs(O,7),2&n){let c;e.mGM(c=e.lsd())&&(s.ngForm=c.first)}},inputs:{dropdownOptions:"dropdownOptions",mode:"mode",type:"type"},exportAs:["accessControlArrayForm"],standalone:!0,features:[e.aNF],decls:9,vars:7,consts:[["ngForm","ngForm"],["d","ngbDatepicker"],["d1","ngbDatepicker"],[1,"alert","alert-warning"],[1,"access-control-item","mt-3",3,"ngModelGroup"],["type","button",1,"btn","btn-outline-primary","mt-3",3,"click","id","dsBtnDisabled"],[1,"fas","fa-plus"],[1,"d-flex","flex-column"],[1,"form-label",3,"for"],[1,"form-select",3,"ngModelChange","id","disabled","ngModel","name"],["value",""],[3,"value"],[1,"form-text","text-muted"],[1,"mt-3"],["aria-hidden","true",1,"mb-2","d-inline-block"],[1,"input-group"],["type","button",1,"btn","btn-outline-danger",3,"click","dsBtnDisabled"],[1,"fas","fa-trash"],["placeholder","yyyy-mm-dd","ngbDatepicker","","placement","top-start top-end bottom-start bottom-end",1,"form-control",3,"ngModelChange","id","ngModel","name","maxDate"],[1,"input-group-append"],["type","button",1,"btn","btn-outline-secondary","fas","fa-calendar",3,"click","dsBtnDisabled"]],template:function(n,s){if(1&n){const c=e.RV6();e.j41(0,"form",null,0),e.DNE(2,L,3,3,"div",3),e.Z7z(3,P,22,22,"div",4,s.trackById,!0),e.j41(5,"button",5),e.bIt("click",function(){return e.eBV(c),e.Njj(s.addAccessControlItem())}),e.nrm(6,"i",6),e.EFF(7),e.nI1(8,"translate"),e.k0s()()}if(2&n){const c=e.sdS(1);e.R7$(2),e.vxM(s.showWarning?2:-1),e.R7$(),e.Dyx(s.form.accessControls),e.R7$(2),e.Mz_("id","add-btn-",s.type,""),e.Y8G("dsBtnDisabled",c.disabled),e.R7$(2),e.SpI(" ",e.bMT(8,5,"access-control-add-more")," ")}},dependencies:[d.A,m.YN,m.qT,m.xH,m.y7,m.me,m.wz,m.BC,m.cb,m.vS,m.Y4,m.cV,b.IQ,b.cw,F,C.h,C.D9],styles:[".access-control-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 50px;grid-gap:10px;padding-bottom:15px;border-bottom:2px dotted gray}"]})}}return a})();const B=()=>({id:V(),itemName:null,startDate:null,hasStartDate:!1,maxStartDate:null,endDate:null,hasEndDate:!1,maxEndDate:null}),V=()=>Math.floor(1e6*Math.random());var G=i(85092),U=i(25558),X=i(40940),K=i(4266),Y=i(31),W=(i(15862),i(52186)),z=i(8417);const H=a=>({repeatable:!0,listId:a});function J(a,v){if(1&a&&e.nrm(0,"ds-viewable-collection",6),2&a){const t=e.XpG(),n=e.XpG();e.Y8G("config",n.paginationConfig)("context",n.context)("objects",t)("selectable",!0)("selectionConfig",e.eq3(6,H,n.LIST_ID))("showPaginator",!0)}}function Q(a,v){1&a&&(e.j41(0,"div",7),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&a&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"access-control-select-bitstreams-modal.no-items")," "))}function Z(a,v){if(1&a&&e.DNE(0,J,1,8,"ds-viewable-collection",6)(1,Q,3,3,"div",7),2&a){const t=v;e.vxM(t.payload.page.length>0?0:-1),e.R7$(),e.vxM(t&&0===t.payload.page.length?1:-1)}}const E="item-access-control-select-bitstreams";let q=(()=>{class a{constructor(t,n,s,c){this.bitstreamService=t,this.paginationService=n,this.translateService=s,this.activeModal=c,this.LIST_ID=E,this.selectedBitstreams=[],this.context=X.o.Bitstream,this.paginationConfig=Object.assign(new z.W,{id:"iacsbm",currentPage:1,pageSize:5})}ngOnInit(){this.bitstreams$=this.paginationService.getCurrentPagination(this.paginationConfig.id,this.paginationConfig).pipe((0,U.n)(t=>this.bitstreamService.findAllByItemAndBundleName(this.item,"ORIGINAL",{elementsPerPage:t.pageSize,currentPage:t.currentPage},!0,!0)))}ngOnDestroy(){this.paginationService.clearPagination(this.paginationConfig.id)}static{this.\u0275fac=function(n){return new(n||a)(e.rXU(K.BitstreamDataService),e.rXU(Y.m),e.rXU(C.c$),e.rXU(b.Lw))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["ds-item-access-control-select-bitstreams-modal"]],inputs:{item:"item",selectedBitstreams:"selectedBitstreams"},standalone:!0,features:[e.aNF],decls:12,vars:9,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark",3,"click"],[3,"config","context","objects","selectable","selectionConfig","showPaginator"],["role","alert",1,"alert","alert-info","w-100"]],template:function(n,s){if(1&n&&(e.j41(0,"div",0)(1,"h4",1),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"button",2),e.bIt("click",function(){return s.activeModal.dismiss("Cross click")}),e.k0s()(),e.j41(5,"div",3),e.DNE(6,Z,2,2),e.nI1(7,"async"),e.k0s(),e.j41(8,"div",4)(9,"button",5),e.bIt("click",function(){return s.activeModal.close("Close click")}),e.EFF(10),e.nI1(11,"translate"),e.k0s()()),2&n){let c;e.R7$(2),e.SpI(" ",e.bMT(3,3,"access-control-select-bitstreams-modal.title")," "),e.R7$(4),e.vxM((c=e.bMT(7,5,s.bitstreams$))?6:-1,c),e.R7$(4),e.SpI(" ",e.bMT(11,7,"access-control-select-bitstreams-modal.close")," ")}},dependencies:[r.Jj,W.h,C.h,C.D9]})}}return a})();const ee=["bitstreamAccessCmp"],te=["itemAccessCmp"],j=()=>[];function se(a,v){if(1&a&&e.nrm(0,"ds-alert",5),2&a){const t=e.XpG();e.Y8G("type",t.AlertType.Info)("content",t.titleMessage)}}function oe(a,v){if(1&a){const t=e.RV6();e.j41(0,"button",34),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const s=e.XpG(2);return e.Njj(s.openSelectBitstreamsModal(s.itemRD.payload))}),e.nrm(2,"i",35),e.k0s()}if(2&a){const t=e.XpG(2);e.Y8G("dsBtnDisabled",!t.state.bitstream.toggleStatus||"selected"!==t.state.bitstream.changesLimit),e.BMQ("aria-label",e.bMT(1,2,"access-control-bitstreams-select"))}}function ne(a,v){if(1&a){const t=e.RV6();e.j41(0,"div",11)(1,"fieldset",27)(2,"legend",28),e.EFF(3),e.nI1(4,"translate"),e.k0s(),e.j41(5,"div",14)(6,"input",29),e.mxI("ngModelChange",function(s){e.eBV(t);const c=e.XpG();return e.DH7(c.state.bitstream.changesLimit,s)||(c.state.bitstream.changesLimit=s),e.Njj(s)}),e.k0s(),e.j41(7,"label",30),e.EFF(8),e.nI1(9,"translate"),e.k0s()(),e.j41(10,"div",14)(11,"input",31),e.mxI("ngModelChange",function(s){e.eBV(t);const c=e.XpG();return e.DH7(c.state.bitstream.changesLimit,s)||(c.state.bitstream.changesLimit=s),e.Njj(s)}),e.k0s(),e.j41(12,"label",32),e.EFF(13),e.nI1(14,"translate"),e.DNE(15,oe,3,4,"button",33),e.k0s()()()()}if(2&a){const t=e.XpG();e.R7$(3),e.SpI(" ",e.bMT(4,9,"access-control-limit-to-specific")," "),e.R7$(3),e.Y8G("disabled",!t.state.bitstream.toggleStatus),e.R50("ngModel",t.state.bitstream.changesLimit),e.R7$(2),e.SpI(" ",e.bMT(9,11,"access-control-process-all-bitstreams")," "),e.R7$(3),e.Y8G("disabled",!t.state.bitstream.toggleStatus),e.R50("ngModel",t.state.bitstream.changesLimit),e.R7$(2),e.Lme(" ",t.state.bitstream.selectedBitstreams.length," ",e.bMT(14,13,"access-control-bitstreams-selected")," "),e.R7$(2),e.vxM(t.itemRD?15:-1)}}function ae(a,v){1&a&&e.nrm(0,"hr")}function ie(a,v){if(1&a){const t=e.RV6();e.j41(0,"div",26)(1,"button",36),e.bIt("click",function(){e.eBV(t);const s=e.XpG();return e.Njj(s.reset())}),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"button",37),e.bIt("click",function(){e.eBV(t);const s=e.XpG();return e.Njj(s.submit())}),e.EFF(5),e.nI1(6,"translate"),e.k0s()()}if(2&a){const t=e.XpG();e.R7$(2),e.SpI(" ",e.bMT(3,3,"access-control-cancel")," "),e.R7$(2),e.Y8G("dsBtnDisabled",!t.state.item.toggleStatus&&!t.state.bitstream.toggleStatus),e.R7$(),e.SpI(" ",e.bMT(6,5,"access-control-execute")," ")}}let ce=(()=>{class a{constructor(t,n,s,c,k){this.bulkAccessConfigService=t,this.bulkAccessControlService=n,this.selectableListService=s,this.modalService=c,this.cdr=k,this.showLimitToSpecificBitstreams=!1,this.titleMessage="",this.showSubmit=!0,this.AlertType=u.v,this.state={item:{toggleStatus:!1,accessMode:"replace"},bitstream:{toggleStatus:!1,accessMode:"replace",changesLimit:"all",selectedBitstreams:[]}},this.dropdownData$=this.bulkAccessConfigService.findByName("default").pipe((0,A.qD)(),(0,_.T)(l=>l.hasSucceeded?l.payload:null),(0,T.t)({refCount:!1,bufferSize:1}))}getFormValue(){return console.log({bitstream:this.bitstreamAccessCmp.getValue(),item:this.itemAccessCmp.getValue(),state:this.state}),{bitstream:this.bitstreamAccessCmp.getValue(),item:this.itemAccessCmp.getValue(),state:this.state}}reset(){this.bitstreamAccessCmp.reset(),this.itemAccessCmp.reset(),this.state={item:{toggleStatus:!1,accessMode:"replace"},bitstream:{toggleStatus:!1,accessMode:"replace",changesLimit:"all",selectedBitstreams:[]}}}submit(){const t=this.bitstreamAccessCmp.getValue(),n=this.itemAccessCmp.getValue(),{file:s}=this.bulkAccessControlService.createPayloadFile({bitstreamAccess:t,itemAccess:n,state:this.state});this.bulkAccessControlService.executeScript([this.itemRD.payload.uuid],s).pipe((0,p.s)(1)).subscribe(c=>{console.log("success",c)})}handleStatusChange(t,n){"bitstream"===t?n?this.bitstreamAccessCmp.enable():this.bitstreamAccessCmp.disable():"item"===t&&(n?this.itemAccessCmp.enable():this.itemAccessCmp.disable())}openSelectBitstreamsModal(t){const n=this.modalService.open(q);n.componentInstance.selectedBitstreams=this.state.bitstream.selectedBitstreams,n.componentInstance.item=t,n.closed.pipe((0,g.H)(()=>this.selectableListService.getSelectableList(E)),(0,p.s)(1)).subscribe(s=>{this.state.bitstream.selectedBitstreams=s?.selection||[],this.cdr.detectChanges()})}ngOnDestroy(){this.selectableListService.deselectAll(E)}isValid(){return this.bitstreamAccessCmp.isValid()||this.itemAccessCmp.isValid()}static{this.\u0275fac=function(n){return new(n||a)(e.rXU(S.BulkAccessConfigDataService),e.rXU(G.r),e.rXU(f.K),e.rXU(b.Bq),e.rXU(e.gRc))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["ds-access-control-form-container"]],viewQuery:function(n,s){if(1&n&&(e.GBs(ee,7),e.GBs(te,7)),2&n){let c;e.mGM(c=e.lsd())&&(s.bitstreamAccessCmp=c.first),e.mGM(c=e.lsd())&&(s.itemAccessCmp=c.first)}},inputs:{showLimitToSpecificBitstreams:"showLimitToSpecificBitstreams",titleMessage:"titleMessage",itemRD:"itemRD",showSubmit:"showSubmit"},exportAs:["dsAccessControlForm"],standalone:!0,features:[e.aNF],decls:68,vars:62,consts:[["itemAccessCmp",""],["bitstreamAccessCmp",""],[1,"container"],[1,"card","border-0"],[1,"card-body"],[1,"d-block","pb-3",3,"type","content"],[1,"row","mt-5"],[1,"col-12","col-md-6","border-end","d-flex","flex-column","justify-content-between"],[1,"d-flex","align-items-center"],[1,"h3","mb-0","me-4"],[3,"ngModelChange","ariaLabel","ngModel"],[1,"row","mt-3"],[1,"h4","col-12","col-md-3"],[1,"col-12","col-md-8"],[1,"form-check"],["type","radio","name","itemMode","id","itemReplace","value","replace",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","itemReplace",1,"form-check-label"],["type","radio","name","itemMode","id","itemAdd","value","add",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","itemAdd",1,"form-check-label"],[1,"h4","mt-3"],[3,"type","mode","dropdownOptions"],[1,"col-12","col-md-6","d-flex","flex-column","justify-content-between"],["type","radio","name","bitstreamMode","id","bitstreamReplace","value","replace",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","bitstreamReplace",1,"form-check-label"],["type","radio","name","bitstreamMode","id","bitstreamAdd","value","add",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","bitstreamAdd",1,"form-check-label"],[1,"d-flex","justify-content-end"],[1,"col-12"],[1,"h4"],["type","radio","name","changesLimit","id","processAll","value","all",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","processAll",1,"form-check-label"],["type","radio","name","changesLimit","id","processSelected","value","selected",1,"form-check-input","mt-2",3,"ngModelChange","disabled","ngModel"],["for","processSelected",1,"form-check-label"],["type","button",1,"btn","btn-outline-dark","border-0",3,"dsBtnDisabled"],["type","button",1,"btn","btn-outline-dark","border-0",3,"click","dsBtnDisabled"],[1,"fa","fa-search"],["type","button",1,"btn","btn-outline-primary","me-3",3,"click"],["type","submit",1,"btn","btn-primary",3,"click","dsBtnDisabled"]],template:function(n,s){if(1&n){const c=e.RV6();e.j41(0,"div",2)(1,"div",3)(2,"div",4),e.DNE(3,se,1,2,"ds-alert",5),e.j41(4,"div",6)(5,"div",7)(6,"div")(7,"div",8)(8,"h2",9),e.EFF(9),e.nI1(10,"translate"),e.k0s(),e.j41(11,"ui-switch",10),e.nI1(12,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(c),e.DH7(s.state.item.toggleStatus,l)||(s.state.item.toggleStatus=l),e.Njj(l)}),e.bIt("ngModelChange",function(l){return e.eBV(c),e.Njj(s.handleStatusChange("item",l))}),e.k0s()(),e.j41(13,"fieldset",11)(14,"legend",12),e.EFF(15),e.nI1(16,"translate"),e.k0s(),e.j41(17,"div",13)(18,"div",14)(19,"input",15),e.mxI("ngModelChange",function(l){return e.eBV(c),e.DH7(s.state.item.accessMode,l)||(s.state.item.accessMode=l),e.Njj(l)}),e.k0s(),e.j41(20,"label",16),e.EFF(21),e.nI1(22,"translate"),e.k0s()(),e.j41(23,"div",14)(24,"input",17),e.mxI("ngModelChange",function(l){return e.eBV(c),e.DH7(s.state.item.accessMode,l)||(s.state.item.accessMode=l),e.Njj(l)}),e.k0s(),e.j41(25,"label",18),e.EFF(26),e.nI1(27,"translate"),e.k0s()()()()(),e.j41(28,"div")(29,"h3",19),e.EFF(30),e.nI1(31,"translate"),e.k0s(),e.nrm(32,"ds-access-control-array-form",20,0),e.nI1(34,"async"),e.k0s()(),e.j41(35,"div",21)(36,"div")(37,"div",8)(38,"h2",9),e.EFF(39),e.nI1(40,"translate"),e.k0s(),e.j41(41,"ui-switch",10),e.nI1(42,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(c),e.DH7(s.state.bitstream.toggleStatus,l)||(s.state.bitstream.toggleStatus=l),e.Njj(l)}),e.bIt("ngModelChange",function(l){return e.eBV(c),e.Njj(s.handleStatusChange("bitstream",l))}),e.k0s()(),e.DNE(43,ne,16,15,"div",11),e.k0s(),e.j41(44,"fieldset",11)(45,"legend",12),e.EFF(46),e.nI1(47,"translate"),e.k0s(),e.j41(48,"div",13)(49,"div",14)(50,"input",22),e.mxI("ngModelChange",function(l){return e.eBV(c),e.DH7(s.state.bitstream.accessMode,l)||(s.state.bitstream.accessMode=l),e.Njj(l)}),e.k0s(),e.j41(51,"label",23),e.EFF(52),e.nI1(53,"translate"),e.k0s()(),e.j41(54,"div",14)(55,"input",24),e.mxI("ngModelChange",function(l){return e.eBV(c),e.DH7(s.state.bitstream.accessMode,l)||(s.state.bitstream.accessMode=l),e.Njj(l)}),e.k0s(),e.j41(56,"label",25),e.EFF(57),e.nI1(58,"translate"),e.k0s()()()(),e.j41(59,"div")(60,"h3",19),e.EFF(61),e.nI1(62,"translate"),e.k0s(),e.nrm(63,"ds-access-control-array-form",20,1),e.nI1(65,"async"),e.k0s()()(),e.DNE(66,ae,1,0,"hr")(67,ie,7,7,"div",26),e.k0s()()()}if(2&n){let c,k;e.R7$(3),e.vxM(s.titleMessage?3:-1),e.R7$(6),e.SpI(" ",e.bMT(10,32,"access-control-item-header-toggle")," "),e.R7$(2),e.Y8G("ariaLabel",e.bMT(12,34,s.state.bitstream.toggleStatus?"access-control-item-toggle.disable":"access-control-item-toggle.enable")),e.R50("ngModel",s.state.item.toggleStatus),e.R7$(4),e.SpI(" ",e.bMT(16,36,"access-control-mode")," "),e.R7$(4),e.Y8G("disabled",!s.state.item.toggleStatus),e.R50("ngModel",s.state.item.accessMode),e.R7$(2),e.SpI(" ",e.bMT(22,38,"access-control-replace-all")," "),e.R7$(3),e.Y8G("disabled",!s.state.item.toggleStatus),e.R50("ngModel",s.state.item.accessMode),e.R7$(2),e.SpI(" ",e.bMT(27,40,"access-control-add-to-existing")," "),e.R7$(4),e.JRh(e.bMT(31,42,"access-control-access-conditions")),e.R7$(2),e.Y8G("type","item")("mode",s.state.item.accessMode)("dropdownOptions",(null==(c=e.bMT(34,44,s.dropdownData$))?null:c.itemAccessConditionOptions)||e.lJ4(60,j)),e.R7$(7),e.SpI(" ",e.bMT(40,46,"access-control-bitstream-header-toggle")," "),e.R7$(2),e.Y8G("ariaLabel",e.bMT(42,48,s.state.bitstream.toggleStatus?"access-control-bitstream-toggle.disable":"access-control-bitstream-toggle.enable")),e.R50("ngModel",s.state.bitstream.toggleStatus),e.R7$(2),e.vxM(s.showLimitToSpecificBitstreams?43:-1),e.R7$(3),e.SpI(" ",e.bMT(47,50,"access-control-mode")," "),e.R7$(4),e.Y8G("disabled",!s.state.bitstream.toggleStatus),e.R50("ngModel",s.state.bitstream.accessMode),e.R7$(2),e.SpI(" ",e.bMT(53,52,"access-control-replace-all")," "),e.R7$(3),e.Y8G("disabled",!s.state.bitstream.toggleStatus),e.R50("ngModel",s.state.bitstream.accessMode),e.R7$(2),e.SpI(" ",e.bMT(58,54,"access-control-add-to-existing")," "),e.R7$(4),e.JRh(e.bMT(62,56,"access-control-access-conditions")),e.R7$(2),e.Y8G("type","bitstream")("mode",s.state.bitstream.accessMode)("dropdownOptions",(null==(k=e.bMT(65,58,s.dropdownData$))?null:k.bitstreamAccessConditionOptions)||e.lJ4(61,j)),e.R7$(3),e.vxM(s.showSubmit?66:-1),e.R7$(),e.vxM(s.showSubmit?67:-1)}},dependencies:[N,o.C,r.Jj,d.A,m.YN,m.me,m.Fm,m.BC,m.vS,C.h,C.D9,I.z,I.S],styles:["fieldset[_ngcontent-%COMP%] > legend.col-12.col-md-3[_ngcontent-%COMP%]{width:100%}"]})}}return a})()},85092:(R,D,i)=>{i.d(D,{r:()=>h});var r=i(96354),m=i(60696),C=i(4093),I=i(44280),T=i(89777),g=i(9847),_=i(54438),p=i(7901),S=i(68018);let h=(()=>{class o{constructor(d,f,b,M){this.notificationsService=d,this.router=f,this.scriptService=b,this.translationService=M}createPayloadFile(d){const f=A(d),b=new Blob([JSON.stringify(f,null,2)],{type:"application/json"}),M=new File([b],"data.json",{type:"application/json"});return{url:URL.createObjectURL(M),file:M}}executeScript(d,f){console.log("execute",{uuids:d,file:f});const b=[{name:"-f",value:f.name}];return d.forEach(M=>{b.push({name:"-u",value:M})}),this.scriptService.invoke("bulk-access-control",b,[f]).pipe((0,C.qD)(),(0,r.T)(M=>{if(M.hasSucceeded){const e=this.translationService.get("process.new.notification.success.title"),F=this.translationService.get("process.new.notification.success.content");return this.notificationsService.success(e,F),(0,T.hj)(M.payload)&&this.router.navigateByUrl((0,I.yJ)(M.payload.processId)),!0}{const e=this.translationService.get("process.new.notification.error.title"),F=this.translationService.get("process.new.notification.error.content");return this.notificationsService.error(e,F),!1}}))}static{this.\u0275fac=function(f){return new(f||o)(_.KVO(g.I),_.KVO(p.Ix),_.KVO(m.ScriptDataService),_.KVO(S.c$))}}static{this.\u0275prov=_.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();const A=o=>{const u={},f=o.state.bitstream.toggleStatus;if(o.state.item.toggleStatus&&(u.item={mode:o.state.item.accessMode,accessConditions:o.itemAccess}),f){const b={uuid:[]};f&&"selected"===o.state.bitstream.changesLimit&&(b.uuid=o.state.bitstream.selectedBitstreams.map(M=>M.id)),u.bitstream={constraints:b,mode:o.state.bitstream.accessMode,accessConditions:o.bitstreamAccess}}return u}},84786:(R,D,i)=>{i.d(D,{S:()=>p,z:()=>S});var r=i(54438),m=i(89417),C=i(60177);const I=["*"];function T(h,A){if(1&h&&(r.j41(0,"label",2)(1,"span",3),r.EFF(2),r.k0s(),r.j41(3,"span",4),r.EFF(4),r.k0s()()),2&h){const o=r.XpG();r.R7$(),r.xc7("color",o.getColor("checkedTextColor")),r.BMQ("aria-label",o.checkedLabel),r.R7$(),r.JRh(o.checkedLabel),r.R7$(),r.xc7("color",o.getColor("uncheckedTextColor")),r.BMQ("aria-label",o.uncheckedLabel),r.R7$(),r.JRh(o.uncheckedLabel)}}const g=new r.nKC("UI_SWITCH_OPTIONS"),_={provide:m.kq,useExisting:(0,r.Rfq)(()=>p),multi:!0};let p=(()=>{class h{cdr;_checked;_disabled;_reverse;_loading;_beforeChange;size;color;switchOffColor;switchColor;defaultBgColor;defaultBoColor;checkedLabel;uncheckedLabel;checkedTextColor;uncheckedTextColor;beforeChange;ariaLabel;set checked(o){this._checked=!1!==o}get checked(){return this._checked}set disabled(o){this._disabled=!1!==o}get disabled(){return this._disabled}set reverse(o){this._reverse=!1!==o}get reverse(){return this._reverse}set loading(o){this._loading=!1!==o}get loading(){return this._loading}change=new r.bkB;changeEvent=new r.bkB;valueChange=new r.bkB;constructor(o={},u){this.cdr=u,this.size=o&&o.size||"medium",this.color=o&&o.color,this.switchOffColor=o&&o.switchOffColor,this.switchColor=o&&o.switchColor,this.defaultBgColor=o&&o.defaultBgColor,this.defaultBoColor=o&&o.defaultBoColor,this.checkedLabel=o&&o.checkedLabel,this.uncheckedLabel=o&&o.uncheckedLabel,this.checkedTextColor=o&&o.checkedTextColor,this.uncheckedTextColor=o&&o.uncheckedTextColor}getColor(o=""){return"borderColor"===o?this.defaultBoColor:"switchColor"===o?this.reverse?this.checked&&this.switchOffColor||this.switchColor:this.checked?this.switchColor:this.switchOffColor||this.switchColor:"checkedTextColor"===o?this.reverse?this.uncheckedTextColor:this.checkedTextColor:"uncheckedTextColor"===o?this.reverse?this.checkedTextColor:this.uncheckedTextColor:this.reverse?this.checked?this.defaultBgColor:this.color:this.checked?this.color:this.defaultBgColor}onClick(o){this.disabled||(this.checked=!this.checked,this.change.emit(this.checked),this.valueChange.emit(this.checked),this.changeEvent.emit(o),this.onChangeCallback(this.checked),this.onTouchedCallback(this.checked),this.cdr.markForCheck())}onToggle(o){this.disabled||(this.beforeChange?this._beforeChange=this.beforeChange.subscribe(u=>{u&&this.onClick(o)}):this.onClick(o))}writeValue(o){o!==this.checked&&(this.checked=!!o),this.onChangeCallback(this.checked),this.cdr&&this.cdr.markForCheck()}registerOnChange(o){this.onChangeCallback=o}registerOnTouched(o){this.onTouchedCallback=o}setDisabledState(o){this.disabled=o}onTouchedCallback=o=>{};onChangeCallback=o=>{};ngOnDestroy(){this._beforeChange&&this._beforeChange.unsubscribe()}static \u0275fac=function(u){return new(u||h)(r.rXU(g,8),r.rXU(r.gRc))};static \u0275cmp=r.VBU({type:h,selectors:[["ui-switch"]],hostBindings:function(u,d){1&u&&r.bIt("click",function(b){return d.onToggle(b)})},inputs:{size:"size",color:"color",switchOffColor:"switchOffColor",switchColor:"switchColor",defaultBgColor:"defaultBgColor",defaultBoColor:"defaultBoColor",checkedLabel:"checkedLabel",uncheckedLabel:"uncheckedLabel",checkedTextColor:"checkedTextColor",uncheckedTextColor:"uncheckedTextColor",beforeChange:"beforeChange",ariaLabel:"ariaLabel",checked:"checked",disabled:"disabled",reverse:"reverse",loading:"loading"},outputs:{change:"change",changeEvent:"changeEvent",valueChange:"valueChange"},features:[r.Jv_([_])],ngContentSelectors:I,decls:4,vars:21,consts:[["type","button","role","switch",1,"switch"],["class","switch-pane",4,"ngIf"],[1,"switch-pane"],[1,"switch-label-checked"],[1,"switch-label-unchecked"]],template:function(u,d){1&u&&(r.NAR(),r.j41(0,"button",0),r.DNE(1,T,5,8,"label",1),r.j41(2,"small"),r.SdG(3),r.k0s()()),2&u&&(r.xc7("background-color",d.getColor())("border-color",d.getColor("borderColor")),r.AVh("checked",d.checked)("disabled",d.disabled)("loading",d.loading)("switch-large","large"===d.size)("switch-medium","medium"===d.size)("switch-small","small"===d.size),r.BMQ("aria-checked",d.checked)("aria-label",d.ariaLabel),r.R7$(),r.Y8G("ngIf",d.checkedLabel||d.uncheckedLabel),r.R7$(),r.xc7("background",d.getColor("switchColor")))},dependencies:[C.bT],encapsulation:2})}return h})(),S=(()=>{class h{static forRoot(o){return{ngModule:h,providers:[{provide:g,useValue:o||{}}]}}static \u0275fac=function(u){return new(u||h)};static \u0275mod=r.$C({type:h});static \u0275inj=r.G2t({imports:[C.MD,m.YN,m.YN]})}return h})()}}]);