(self.webpackChunkdspace_angular=self.webpackChunkdspace_angular||[]).push([[906,284],{80495:(N,x,n)=>{"use strict";n.d(x,{Q:()=>I});class I{constructor(v,m){this.text=v,this.url=m}}},46541:(N,x,n)=>{"use strict";n.d(x,{U:()=>F});var I=n(7673),i=n(47677),v=n(25558),m=n(96354),O=n(15343),D=n(80495),a=n(89777),S=n(4600),$=n(8177),C=n(43446),o=n(54438);let F=(()=>{class b{constructor(T,p){this.linkService=T,this.dsoNameService=p}getBreadcrumbs(T,p){const V=this.dsoNameService.getName(T),y=new D.Q(V,p),M=T.getParentLinkKey();return this.linkService.resolveLink(T,(0,S.s)(M))[M].pipe((0,i.I)(d=>d.hasSucceeded||204===d.statusCode),(0,v.n)(d=>{if((0,a.a4)(d)&&(0,a.a4)(d.payload)){const e=d.payload;return this.getBreadcrumbs(e,(0,O.wN)(e))}return(0,I.of)([])}),(0,m.T)(d=>[...d,y]))}static{this.\u0275fac=function(p){return new(p||b)(o.KVO($._),o.KVO(C.f))}}static{this.\u0275prov=o.jDH({token:b,factory:b.\u0275fac,providedIn:"root"})}}return b})()},20284:(N,x,n)=>{"use strict";n.r(x),n.d(x,{NotifyRequestsStatusDataService:()=>C});var I=n(96354),i=n(96697),v=n(57775),m=n(81948),O=n(7094),D=n(20881),a=n(49755),S=n(3601),$=n(54438);let C=(()=>{class o extends D.W{constructor(b,_,T,p){super("notifyrequests",b,_,T,p),this.requestService=b,this.rdbService=_,this.objectCache=T,this.halService=p}getNotifyRequestsStatus(b){const _=this.getEndpoint().pipe((0,I.T)(T=>T+"/"+b));return _.pipe((0,i.s)(1)).subscribe(T=>{const p=new a.IP(this.requestService.generateRequestId(),T);this.requestService.send(p,!0)}),this.rdbService.buildFromHref(_)}static{this.\u0275fac=function(_){return new(_||o)($.KVO(S.B),$.KVO(v.o),$.KVO(m.$),$.KVO(O.Y))}}static{this.\u0275prov=$.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})()},46828:(N,x,n)=>{"use strict";n.d(x,{z:()=>a});var I=n(7673),i=n(99437),v=n(96354),m=n(79096),O=n(32506),D=n(54438);let a=(()=>{class S{constructor(C,o){this.appConfig=C,this.restService=o}getLinks(C){return this.restService.get(`${this.appConfig.rest.baseUrl}/signposting/links/${C}`).pipe((0,i.W)(F=>(0,I.of)([])),(0,v.T)(F=>200===F.statusCode?F.payload:[]))}static{this.\u0275fac=function(o){return new(o||S)(D.KVO(m.vQ),D.KVO(O.Y))}}static{this.\u0275prov=D.jDH({token:S,factory:S.\u0275fac,providedIn:"root"})}}return S})()},91274:(N,x,n)=>{"use strict";n.r(x),n.d(x,{ItemAlertsComponent:()=>y});var I=n(60177),i=n(7901),v=n(68018),m=n(96354),O=n(84572),D=n(4093),a=n(11873),S=n(6170),C=(n(15862),n(23743)),o=n(64972),F=n(74082),b=n(82418),_=n(54438);function T(M,d){if(1&M&&(_.j41(0,"div",0),_.nrm(1,"ds-alert",2),_.nI1(2,"translate"),_.k0s()),2&M){const e=_.XpG();_.R7$(),_.Y8G("type",e.AlertTypeEnum.Warning)("content",_.bMT(2,2,"item.alerts.private"))}}function p(M,d){if(1&M){const e=_.RV6();_.j41(0,"a",9),_.bIt("click",function(){_.eBV(e);const f=_.XpG(2);return _.Njj(f.openReinstateModal())}),_.EFF(1),_.nI1(2,"translate"),_.k0s()}2&M&&(_.R7$(),_.JRh(_.bMT(2,1,"item.alerts.reinstate-request")))}function V(M,d){if(1&M&&(_.j41(0,"div",1)(1,"ds-alert",3)(2,"div",4)(3,"span",5),_.EFF(4),_.nI1(5,"translate"),_.k0s(),_.j41(6,"div",6)(7,"a",7),_.EFF(8),_.nI1(9,"translate"),_.k0s(),_.DNE(10,p,3,3,"a",8),_.nI1(11,"async"),_.k0s()()()()),2&M){const e=_.XpG();_.R7$(),_.Y8G("type",e.AlertTypeEnum.Warning),_.R7$(3),_.JRh(_.bMT(5,4,"item.alerts.withdrawn")),_.R7$(4),_.JRh(_.bMT(9,6,"404.link.home-page")),_.R7$(2),_.vxM(_.bMT(11,8,e.showReinstateButton$)?10:-1)}}let y=(()=>{class M{constructor(e,c,f){this.authService=e,this.dsoWithdrawnReinstateModalService=c,this.correctionTypeDataService=f,this.AlertTypeEnum=F.v}ngOnChanges(e){e.item?.currentValue.withdrawn&&this.showReinstateButton$&&(this.showReinstateButton$=this.shouldShowReinstateButton())}shouldShowReinstateButton(){const e=this.correctionTypeDataService.findByItem(this.item.uuid,!0).pipe((0,D.qD)(),(0,m.T)(f=>f.hasSucceeded?f.payload.page:[])),c=this.authService.isAuthorized(S._.AdministratorOf);return(0,O.z)([c,e]).pipe((0,m.T)(([f,G])=>!f&&G.some(X=>X.topic===b.el)))}openReinstateModal(){this.dsoWithdrawnReinstateModalService.openCreateWithdrawnReinstateModal(this.item,"request-reinstate",this.item.isArchived)}static{this.\u0275fac=function(c){return new(c||M)(_.rXU(a.AuthorizationDataService),_.rXU(b.Ee),_.rXU(C.CorrectionTypeDataService))}}static{this.\u0275cmp=_.VBU({type:M,selectors:[["ds-base-item-alerts"]],inputs:{item:"item"},standalone:!0,features:[_.OA$,_.aNF],decls:3,vars:2,consts:[[1,"private-warning"],[1,"withdrawn-warning"],[3,"type","content"],[3,"type"],[1,"d-flex","justify-content-between","flex-wrap"],[1,"align-self-center"],[1,"gap-2","d-flex"],["routerLink","/home","role","button","tabindex","0",1,"btn","btn-primary","btn-sm"],[1,"btn","btn-primary","btn-sm"],[1,"btn","btn-primary","btn-sm",3,"click"]],template:function(c,f){1&c&&(_.j41(0,"div"),_.DNE(1,T,3,4,"div",0)(2,V,12,10,"div",1),_.k0s()),2&c&&(_.R7$(),_.vxM(f.item&&!f.item.isDiscoverable?1:-1),_.R7$(),_.vxM(f.item&&f.item.isWithdrawn?2:-1))},dependencies:[o.C,I.Jj,i.Wk,v.h,v.D9]})}}return M})()},29762:(N,x,n)=>{"use strict";n.d(x,{R:()=>a}),n(15862);var i=n(29710),m=(n(91274),n(54438));const O=["*"];function D(S,$){}let a=(()=>{class S extends i.J{constructor(){super(...arguments),this.inAndOutputNames=["item"]}getComponentName(){return"ItemAlertsComponent"}importThemedComponent(C){return n(42176)(`./${C}/app/item-page/alerts/item-alerts.component`)}importUnthemedComponent(){return Promise.resolve().then(n.bind(n,91274))}static{this.\u0275fac=(()=>{let C;return function(F){return(C||(C=m.xGo(S)))(F||S)}})()}static{this.\u0275cmp=m.VBU({type:S,selectors:[["ds-item-alerts"]],inputs:{item:"item"},standalone:!0,features:[m.Vt3,m.aNF],ngContentSelectors:O,decls:5,vars:0,consts:[["vcr",""],["content",""]],template:function(o,F){1&o&&(m.NAR(),m.DNE(0,D,0,0,"ng-template",null,0,m.C5r),m.j41(2,"div",null,1),m.SdG(4),m.k0s())},encapsulation:2})}}return S})()},89570:(N,x,n)=>{"use strict";n.r(x),n.d(x,{FullFileSectionComponent:()=>tt});var I=n(60177),i=n(68018),v=n(25558),m=n(88141),O=n(79096),D=n(43446),a=n(4266),S=n(31),C=(n(15862),n(89777)),o=n(96044),F=n(72862),b=n(9847),_=n(2175),T=n(8417),p=n(81829),V=n(4600),y=n(50186),M=n(49170),d=n(57047),e=n(54438);function c(A,k){if(1&A&&(e.j41(0,"dt",9),e.EFF(1),e.nI1(2,"translate"),e.k0s(),e.j41(3,"dd",10),e.EFF(4),e.k0s()),2&A){const E=e.XpG().$implicit;e.R7$(),e.SpI(" ",e.bMT(2,2,"item.page.filesection.description")," "),e.R7$(3),e.SpI(" ",E.firstMetadataValue("dc.description")," ")}}function f(A,k){if(1&A&&(e.j41(0,"div",4)(1,"div",5),e.nrm(2,"ds-thumbnail",6),e.nI1(3,"async"),e.k0s(),e.j41(4,"div",7)(5,"dl",8)(6,"dt",9),e.EFF(7),e.nI1(8,"translate"),e.k0s(),e.j41(9,"dd",10),e.EFF(10),e.k0s(),e.j41(11,"dt",9),e.EFF(12),e.nI1(13,"translate"),e.k0s(),e.j41(14,"dd",10),e.EFF(15),e.nI1(16,"dsFileSize"),e.k0s(),e.j41(17,"dt",9),e.EFF(18),e.nI1(19,"translate"),e.k0s(),e.j41(20,"dd",10),e.EFF(21),e.nI1(22,"async"),e.k0s(),e.DNE(23,c,5,4),e.k0s()(),e.j41(24,"div",11)(25,"ds-file-download-link",12)(26,"span",13),e.EFF(27),e.nI1(28,"translate"),e.k0s()()()()),2&A){let E,j;const L=k.$implicit,H=e.XpG(4);e.R7$(2),e.Y8G("thumbnail",null==(E=e.bMT(3,12,L.thumbnail))?null:E.payload),e.R7$(5),e.SpI(" ",e.bMT(8,14,"item.page.filesection.name")," "),e.R7$(3),e.JRh(H.dsoNameService.getName(L)),e.R7$(2),e.SpI(" ",e.bMT(13,16,"item.page.filesection.size")," "),e.R7$(3),e.JRh(e.bMT(16,18,L.sizeBytes)),e.R7$(3),e.SpI(" ",e.bMT(19,20,"item.page.filesection.format")," "),e.R7$(3),e.SpI(" ",null==(j=e.bMT(22,22,L.format))||null==j.payload?null:j.payload.description," "),e.R7$(2),e.vxM(L.hasMetadata("dc.description")?23:-1),e.R7$(2),e.Y8G("showIcon",!0)("bitstream",L)("item",H.item),e.R7$(2),e.SpI(" ",e.bMT(28,24,"item.page.filesection.download")," ")}}function G(A,k){if(1&A&&(e.j41(0,"ds-pagination",3),e.Z7z(1,f,29,26,"div",4,e.fX1),e.k0s()),2&A){const E=e.XpG(2).ngVar,j=e.XpG();e.Y8G("hideGear",!0)("hidePagerWhenSinglePage",!0)("paginationOptions",j.originalOptions)("collectionSize",null==E?null:E.totalElements)("retainScrollPosition",!0),e.R7$(),e.Dyx(null==E?null:E.page)}}function X(A,k){if(1&A&&(e.j41(0,"div")(1,"h3",2),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.DNE(4,G,3,5,"ds-pagination",3),e.k0s()),2&A){const E=e.XpG().ngVar;e.R7$(2),e.SpI(" ",e.bMT(3,2,"item.page.filesection.original.bundle")," "),e.R7$(2),e.vxM((null==E||null==E.page?null:E.page.length)>0?4:-1)}}function t(A,k){if(1&A&&(e.j41(0,"div"),e.DNE(1,X,5,4,"div"),e.k0s()),2&A){const E=k.ngVar,j=e.XpG();e.R7$(),e.vxM(j.hasValuesInBundle(E)?1:-1)}}function nt(A,k){if(1&A&&(e.j41(0,"div",14)(1,"div",5),e.nrm(2,"ds-thumbnail",6),e.nI1(3,"async"),e.k0s(),e.j41(4,"div",7)(5,"dl",8)(6,"dt",9),e.EFF(7),e.nI1(8,"translate"),e.k0s(),e.j41(9,"dd",10),e.EFF(10),e.k0s(),e.j41(11,"dt",9),e.EFF(12),e.nI1(13,"translate"),e.k0s(),e.j41(14,"dd",10),e.EFF(15),e.nI1(16,"dsFileSize"),e.k0s(),e.j41(17,"dt",9),e.EFF(18),e.nI1(19,"translate"),e.k0s(),e.j41(20,"dd",10),e.EFF(21),e.nI1(22,"async"),e.k0s(),e.j41(23,"dt",9),e.EFF(24),e.nI1(25,"translate"),e.k0s(),e.j41(26,"dd",10),e.EFF(27),e.k0s()()(),e.j41(28,"div",11)(29,"ds-file-download-link",12)(30,"span",13),e.EFF(31),e.nI1(32,"translate"),e.k0s()()()()),2&A){let E,j;const L=k.$implicit,H=e.XpG(4);e.R7$(2),e.Y8G("thumbnail",null==(E=e.bMT(3,13,L.thumbnail))?null:E.payload),e.R7$(5),e.SpI(" ",e.bMT(8,15,"item.page.filesection.name")," "),e.R7$(3),e.JRh(H.dsoNameService.getName(L)),e.R7$(2),e.SpI(" ",e.bMT(13,17,"item.page.filesection.size")," "),e.R7$(3),e.JRh(e.bMT(16,19,L.sizeBytes)),e.R7$(3),e.SpI(" ",e.bMT(19,21,"item.page.filesection.format")," "),e.R7$(3),e.SpI(" ",null==(j=e.bMT(22,23,L.format))||null==j.payload?null:j.payload.description," "),e.R7$(3),e.SpI(" ",e.bMT(25,25,"item.page.filesection.description")," "),e.R7$(3),e.SpI(" ",L.firstMetadataValue("dc.description")," "),e.R7$(2),e.Y8G("showIcon",!0)("bitstream",L)("item",H.item),e.R7$(2),e.SpI(" ",e.bMT(32,27,"item.page.filesection.download")," ")}}function Q(A,k){if(1&A&&(e.j41(0,"ds-pagination",3),e.Z7z(1,nt,33,29,"div",14,e.fX1),e.k0s()),2&A){const E=e.XpG(2).ngVar,j=e.XpG();e.Y8G("hideGear",!0)("hidePagerWhenSinglePage",!0)("paginationOptions",j.licenseOptions)("collectionSize",null==E?null:E.totalElements)("retainScrollPosition",!0),e.R7$(),e.Dyx(null==E?null:E.page)}}function ot(A,k){if(1&A&&(e.j41(0,"div")(1,"h3",2),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.DNE(4,Q,3,5,"ds-pagination",3),e.k0s()),2&A){const E=e.XpG().ngVar;e.R7$(2),e.SpI(" ",e.bMT(3,2,"item.page.filesection.license.bundle")," "),e.R7$(2),e.vxM((null==E||null==E.page?null:E.page.length)>0?4:-1)}}function Z(A,k){if(1&A&&(e.j41(0,"div"),e.DNE(1,ot,5,4,"div"),e.k0s()),2&A){const E=k.ngVar,j=e.XpG();e.R7$(),e.vxM(j.hasValuesInBundle(E)?1:-1)}}let tt=(()=>{class A extends d.FileSectionComponent{constructor(E,j,L,H,P,B){super(E,j,L,P,B),this.notificationsService=j,this.translateService=L,this.paginationService=H,this.dsoNameService=P,this.appConfig=B,this.originalOptions=Object.assign(new T.W,{id:"obo",currentPage:1,pageSize:this.appConfig.item.bitstream.pageSize}),this.licenseOptions=Object.assign(new T.W,{id:"lbo",currentPage:1,pageSize:this.appConfig.item.bitstream.pageSize})}ngOnInit(){this.initialize()}initialize(){this.originals$=this.paginationService.getCurrentPagination(this.originalOptions.id,this.originalOptions).pipe((0,v.n)(E=>this.bitstreamDataService.findAllByItemAndBundleName(this.item,"ORIGINAL",{elementsPerPage:E.pageSize,currentPage:E.currentPage},!0,!0,(0,V.s)("format"),(0,V.s)("thumbnail"),(0,V.s)("accessStatus"))),(0,m.M)(E=>{(0,C.a4)(E.errorMessage)&&this.notificationsService.error(this.translateService.get("file-section.error.header"),`${E.statusCode} ${E.errorMessage}`)})),this.licenses$=this.paginationService.getCurrentPagination(this.licenseOptions.id,this.licenseOptions).pipe((0,v.n)(E=>this.bitstreamDataService.findAllByItemAndBundleName(this.item,"LICENSE",{elementsPerPage:E.pageSize,currentPage:E.currentPage},!0,!0,(0,V.s)("format"),(0,V.s)("thumbnail"),(0,V.s)("accessStatus"))),(0,m.M)(E=>{(0,C.a4)(E.errorMessage)&&this.notificationsService.error(this.translateService.get("file-section.error.header"),`${E.statusCode} ${E.errorMessage}`)}))}hasValuesInBundle(E){return(0,C.a4)(E)&&!(0,C.Im)(E.page)}ngOnDestroy(){this.paginationService.clearPagination(this.originalOptions.id),this.paginationService.clearPagination(this.licenseOptions.id)}static{this.\u0275fac=function(j){return new(j||A)(e.rXU(a.BitstreamDataService),e.rXU(b.I),e.rXU(i.c$),e.rXU(S.m),e.rXU(D.f),e.rXU(O.vQ))}}static{this.\u0275cmp=e.VBU({type:A,selectors:[["ds-base-item-page-full-file-section"]],inputs:{item:"item"},standalone:!0,features:[e.Vt3,e.aNF],decls:6,vars:9,consts:[[3,"label"],[4,"ngVar"],[1,"h5","simple-view-element-header"],[3,"hideGear","hidePagerWhenSinglePage","paginationOptions","collectionSize","retainScrollPosition"],[1,"file-section","row","mb-3"],[1,"col-3"],[3,"thumbnail"],[1,"col-7"],[1,"row"],[1,"col-md-4"],[1,"col-md-8"],[1,"col-2"],["cssClasses","btn btn-outline-primary btn-download",3,"showIcon","bitstream","item"],[1,"d-none","d-md-inline"],[1,"file-section","row"]],template:function(j,L){if(1&j&&(e.j41(0,"ds-metadata-field-wrapper",0),e.nI1(1,"translate"),e.DNE(2,t,2,1,"div",1),e.nI1(3,"async"),e.DNE(4,Z,2,1,"div",1),e.nI1(5,"async"),e.k0s()),2&j){let H,P;e.Y8G("label",e.bMT(1,3,L.label)),e.R7$(2),e.Y8G("ngVar",null==(H=e.bMT(3,5,L.originals$))?null:H.payload),e.R7$(2),e.Y8G("ngVar",null==(P=e.bMT(5,7,L.licenses$))?null:P.payload)}},dependencies:[I.Jj,p.s,F.Q,_.e,o.z,M.T,i.h,i.D9,y.r],styles:["@media screen and (min-width: 768px){dt[_ngcontent-%COMP%]{text-align:right}}"]})}}return A})()},72324:(N,x,n)=>{"use strict";n.d(x,{n:()=>a}),n(15862);var i=n(29710),m=(n(89570),n(54438));const O=["*"];function D(S,$){}let a=(()=>{class S extends i.J{constructor(){super(...arguments),this.inAndOutputNames=["item"]}getComponentName(){return"FullFileSectionComponent"}importThemedComponent(C){return n(63614)(`./${C}/app/item-page/full/field-components/file-section/full-file-section.component`)}importUnthemedComponent(){return Promise.resolve().then(n.bind(n,89570))}static{this.\u0275fac=(()=>{let C;return function(F){return(C||(C=m.xGo(S)))(F||S)}})()}static{this.\u0275cmp=m.VBU({type:S,selectors:[["ds-item-page-full-file-section"]],inputs:{item:"item"},standalone:!0,features:[m.Vt3,m.aNF],ngContentSelectors:O,decls:5,vars:0,consts:[["vcr",""],["content",""]],template:function(o,F){1&o&&(m.NAR(),m.DNE(0,D,0,0,"ng-template",null,0,m.C5r),m.j41(2,"div",null,1),m.SdG(4),m.k0s())},encapsulation:2})}}return S})()},73042:(N,x,n)=>{"use strict";n.r(x),n.d(x,{FullItemPageComponent:()=>H});var I=n(60177),i=n(54438),v=n(7901),m=n(68018),O=n(96354),D=n(5964),a=n(85500),S=n(11873),$=n(61206),C=n(46828),o=n(80193),F=n(2180),b=n(44087),_=n(89777),T=n(14744),p=n(15202),V=n(50186),y=n(29762),M=n(39264),d=n(31893),e=n(43883),c=n(69838),f=n(90670),G=n(72324),X=n(47561);const t=P=>[P];function nt(P,B){if(1&P&&(i.j41(0,"div",8)(1,"a",13),i.nI1(2,"async"),i.EFF(3),i.nI1(4,"translate"),i.k0s()()),2&P){const g=i.XpG(5);i.R7$(),i.Y8G("routerLink",i.eq3(6,t,i.bMT(2,2,g.itemPageRoute$))),i.R7$(2),i.SpI(" ",i.bMT(4,4,"item.page.link.simple")," ")}}function Q(P,B){if(1&P&&(i.j41(0,"tr")(1,"td"),i.EFF(2),i.k0s(),i.j41(3,"td"),i.EFF(4),i.k0s(),i.j41(5,"td"),i.EFF(6),i.k0s()()),2&P){const g=B.$implicit,h=i.XpG().$implicit;i.R7$(2),i.JRh(h.key),i.R7$(2),i.JRh(g.value),i.R7$(2),i.JRh(g.language)}}function ot(P,B){1&P&&i.Z7z(0,Q,7,3,"tr",null,i.fX1),2&P&&i.Dyx(B.$implicit.value)}function Z(P,B){if(1&P){const g=i.RV6();i.j41(0,"div",12)(1,"div",14)(2,"button",15),i.bIt("click",function(){i.eBV(g);const U=i.XpG(5);return i.Njj(U.back())}),i.nrm(3,"i",16),i.EFF(4),i.nI1(5,"translate"),i.k0s()()()}2&P&&(i.R7$(4),i.SpI(" ",i.bMT(5,1,"item.page.return"),""))}function tt(P,B){if(1&P&&(i.j41(0,"div",5)(1,"div",6),i.nrm(2,"ds-item-page-title-field",7)(3,"ds-dso-edit-menu"),i.k0s(),i.DNE(4,nt,5,8,"div",8),i.j41(5,"div",9)(6,"table",10)(7,"tbody"),i.Z7z(8,ot,2,0,null,null,i.fX1),i.nI1(10,"async"),i.nI1(11,"keyvalue"),i.k0s()()(),i.nrm(12,"ds-item-page-full-file-section",4)(13,"ds-item-page-collections",4)(14,"ds-item-versions",11),i.DNE(15,Z,6,3,"div",12),i.k0s()),2&P){const g=i.XpG(),h=i.XpG(3);i.R7$(2),i.Y8G("item",g),i.R7$(2),i.vxM(h.fromSubmissionObject?-1:4),i.R7$(4),i.Dyx(i.bMT(11,8,i.bMT(10,6,h.metadata$))),i.R7$(4),i.Y8G("item",g),i.R7$(),i.Y8G("item",g),i.R7$(),i.Y8G("item",g),i.R7$(),i.vxM(h.fromSubmissionObject?15:-1)}}function A(P,B){if(1&P&&(i.j41(0,"div"),i.nrm(1,"ds-item-alerts",4)(2,"ds-item-versions-notice",4),i.DNE(3,tt,16,10,"div",5),i.nI1(4,"async"),i.k0s()),2&P){const g=B,h=i.XpG(3);i.R7$(),i.Y8G("item",g),i.R7$(),i.Y8G("item",g),i.R7$(),i.vxM(!g.isWithdrawn||i.bMT(4,3,h.isAdmin$)?3:-1)}}function k(P,B){if(1&P&&(i.j41(0,"div",2),i.DNE(1,A,5,5,"div"),i.k0s()),2&P){let g;const h=i.XpG().ngVar;i.Y8G("@fadeInOut",void 0),i.R7$(),i.vxM((g=null==h?null:h.payload)?1:-1,g)}}function E(P,B){1&P&&(i.nrm(0,"ds-error",3),i.nI1(1,"translate")),2&P&&i.FS9("message",i.bMT(1,1,"error.item"))}function j(P,B){1&P&&(i.nrm(0,"ds-loading",3),i.nI1(1,"translate")),2&P&&i.FS9("message",i.bMT(1,1,"loading.item"))}function L(P,B){if(1&P&&(i.j41(0,"div",1),i.DNE(1,k,2,2,"div",2)(2,E,2,3,"ds-error",3)(3,j,2,3,"ds-loading",3),i.k0s()),2&P){const g=B.ngVar;i.R7$(),i.vxM(null!=g&&g.hasSucceeded?1:-1),i.R7$(),i.vxM(null!=g&&g.hasFailed?2:-1),i.R7$(),i.vxM(null!=g&&g.isLoading?3:-1)}}let H=(()=>{class P extends e.ItemPageComponent{constructor(g,h,U,z,Y,K,w,at,rt,lt){super(g,h,U,z,K,w,at,rt,lt),this.route=g,this.router=h,this.items=U,this.authorizationService=z,this._location=Y,this.responseService=K,this.signpostingDataService=w,this.linkHeadService=at,this.notifyInfoService=rt,this.platformId=lt,this.fromSubmissionObject=!1,this.subs=[]}ngOnInit(){super.ngOnInit(),this.metadata$=this.itemRD$.pipe((0,O.T)(g=>g.payload),(0,D.p)(g=>(0,_.a4)(g)),(0,O.T)(g=>g.metadata)),this.subs.push(this.route.data.subscribe(g=>{this.fromSubmissionObject=(0,_.a4)(g.wfi)||(0,_.a4)(g.wsi)}))}back(){this._location.back()}ngOnDestroy(){this.subs.filter(g=>(0,_.a4)(g)).forEach(g=>g.unsubscribe())}static{this.\u0275fac=function(h){return new(h||P)(i.rXU(v.nX),i.rXU(v.Ix),i.rXU($.ItemDataService),i.rXU(S.AuthorizationDataService),i.rXU(I.aZ),i.rXU(o.w),i.rXU(C.z),i.rXU(X.m),i.rXU(a.P),i.rXU(i.Agw))}}static{this.\u0275cmp=i.VBU({type:P,selectors:[["ds-base-full-item-page"]],standalone:!0,features:[i.Vt3,i.aNF],decls:2,vars:3,consts:[["class","container",4,"ngVar"],[1,"container"],[1,"item-page"],[3,"message"],[3,"item"],[1,"full-item-info"],[1,"d-flex","flex-row"],[1,"me-auto",3,"item"],[1,"simple-view-link","my-3"],[1,"table-responsive"],[1,"table","table-striped"],[1,"mt-2",3,"item"],[1,"button-row","bottom"],[1,"btn","btn-outline-primary",3,"routerLink"],[1,"text-end"],[1,"btn","btn-outline-secondary","me-1",3,"click"],[1,"fas","fa-arrow-left"]],template:function(h,U){1&h&&(i.DNE(0,L,4,3,"div",0),i.nI1(1,"async")),2&h&&i.Y8G("ngVar",i.bMT(1,1,U.itemRD$))},dependencies:[I.Jj,M.r,b.T,T.A,c.I,f.s,I.lG,v.Wk,G.n,y.R,d.V,p.v,m.h,m.D9,V.r],styles:["[_nghost-%COMP%]   div.simple-view-link[_ngcontent-%COMP%]{text-align:center}[_nghost-%COMP%]   div.simple-view-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{min-width:25%}"],data:{animation:[F.Ws]},changeDetection:0})}}return P})()},54766:(N,x,n)=>{"use strict";n.d(x,{i:()=>D});var I=n(29710),v=(n(73042),n(54438));const m=["*"];function O(a,S){}let D=(()=>{class a extends I.J{getComponentName(){return"FullItemPageComponent"}importThemedComponent($){return n(4872)(`./${$}/app/item-page/full/full-item-page.component`)}importUnthemedComponent(){return Promise.resolve().then(n.bind(n,73042))}static{this.\u0275fac=(()=>{let $;return function(o){return($||($=v.xGo(a)))(o||a)}})()}static{this.\u0275cmp=v.VBU({type:a,selectors:[["ds-full-item-page"]],standalone:!0,features:[v.Vt3,v.aNF],ngContentSelectors:m,decls:5,vars:0,consts:[["vcr",""],["content",""]],template:function(C,o){1&C&&(v.NAR(),v.DNE(0,O,0,0,"ng-template",null,0,v.C5r),v.j41(2,"div",null,1),v.SdG(4),v.k0s())},encapsulation:2})}}return a})()},99728:(N,x,n)=>{"use strict";n.d(x,{f:()=>T});var I=n(60177),i=n(68018),v=n(96354),m=n(50813),O=n(89777),D=n(50186),a=n(54438),S=n(7901);function $(p,V){1&p&&(a.j41(0,"div",1)(1,"p")(2,"span",4),a.nI1(3,"translate"),a.nrm(4,"i",5),a.k0s(),a.EFF(5),a.nI1(6,"translate"),a.k0s(),a.j41(7,"p"),a.EFF(8),a.nI1(9,"translate"),a.k0s()()),2&p&&(a.R7$(2),a.BMQ("aria-label",a.bMT(3,3,"bitstream-request-a-copy.access-by-token.alt-text")),a.R7$(3),a.JRh(a.bMT(6,5,"bitstream-request-a-copy.access-by-token.not-granted")),a.R7$(3),a.JRh(a.bMT(9,7,"bitstream-request-a-copy.access-by-token.re-request")))}function C(p,V){if(1&p&&(a.j41(0,"div",2)(1,"p")(2,"span",4),a.nI1(3,"translate"),a.nrm(4,"i",5),a.k0s(),a.EFF(5),a.nI1(6,"translate"),a.k0s(),a.j41(7,"p"),a.EFF(8),a.nI1(9,"translate"),a.k0s()()),2&p){const y=a.XpG(2).ngVar,M=a.XpG();a.R7$(2),a.BMQ("aria-label",a.bMT(3,4,"bitstream-request-a-copy.access-by-token.alt-text")),a.R7$(3),a.Lme("",a.bMT(6,6,"bitstream-request-a-copy.access-by-token.expired")," ",M.formatDate(y.accessExpiry),""),a.R7$(3),a.JRh(a.bMT(9,8,"bitstream-request-a-copy.access-by-token.re-request"))}}function o(p,V){if(1&p&&(a.j41(0,"p"),a.EFF(1),a.nI1(2,"translate"),a.k0s()),2&p){const y=a.XpG(3).ngVar,M=a.XpG();a.R7$(),a.Lme("",a.bMT(2,2,"bitstream-request-a-copy.access-by-token.expiry-label")," ",M.formatDate(y.accessExpiry),"")}}function F(p,V){if(1&p&&(a.j41(0,"div",3)(1,"p")(2,"span",6),a.nI1(3,"translate"),a.nrm(4,"i",7),a.k0s(),a.EFF(5),a.nI1(6,"translate"),a.k0s(),a.DNE(7,o,3,4,"p"),a.k0s()),2&p){const y=a.XpG(2).ngVar,M=a.XpG();a.R7$(2),a.BMQ("aria-label",a.bMT(3,3,"bitstream-request-a-copy.access-by-token.alt-text")),a.R7$(3),a.JRh(a.bMT(6,5,"bitstream-request-a-copy.access-by-token.warning")),a.R7$(2),a.vxM(M.hasValue(y.accessExpiry)&&!y.accessExpiry.startsWith("+294276")?7:-1)}}function b(p,V){if(1&p&&a.DNE(0,$,10,9,"div",1)(1,C,10,10,"div",2)(2,F,8,7,"div",3),2&p){const y=a.XpG().ngVar;a.vxM(y.acceptRequest?y.accessExpired?1:2:0)}}function _(p,V){if(1&p&&(a.qex(0),a.DNE(1,b,3,1),a.bVm()),2&p){const y=V.ngVar,M=a.XpG();a.R7$(),a.vxM(M.hasValue(y)?1:-1)}}let T=(()=>{class p{constructor(y){this.route=y,this.hasValue=O.a4}ngOnInit(){this.itemRequest$=this.route.data.pipe((0,v.T)(y=>y.itemRequest))}formatDate(y){return(0,O.hj)(y)?(0,m.$T)((0,m.PR)(y)):""}static{this.\u0275fac=function(M){return new(M||p)(a.rXU(S.nX))}}static{this.\u0275cmp=a.VBU({type:p,selectors:[["ds-access-by-token-notification"]],standalone:!0,features:[a.aNF],decls:2,vars:3,consts:[[4,"ngVar"],[1,"alert","alert-danger","wb-100","mb-2","request-a-copy-access-success"],[1,"alert","alert-danger","wb-100","mb-2","request-a-copy-access-expired"],[1,"alert","alert-warning","wb-100","mb-2","request-a-copy-access-denied"],["role","img",1,"request-a-copy-access-error-icon"],[1,"fa-solid","fa-lock"],["role","img",1,"request-a-copy-access-icon"],[1,"fa-solid","fa-lock-open"]],template:function(M,d){1&M&&(a.DNE(0,_,2,1,"ng-container",0),a.nI1(1,"async")),2&M&&a.Y8G("ngVar",a.bMT(1,1,d.itemRequest$))},dependencies:[I.Jj,i.h,i.D9,D.r],styles:[".request-a-copy-access-icon[_ngcontent-%COMP%]{margin-right:4px;color:var(--bs-success)}.request-a-copy-access-error-icon[_ngcontent-%COMP%]{margin-right:4px}"]})}}return p})()},43883:(N,x,n)=>{"use strict";n.r(x),n.d(x,{ItemPageComponent:()=>P});var I=n(60177),i=n(54438),v=n(68018),m=n(84572),O=n(7673),D=n(96354),a=n(96697),S=n(25558),$=n(85500),C=n(11873),o=n(6170),F=n(61206),b=n(46828),_=n(80193),T=n(4093),p=n(19192),V=n(2180),y=n(89777),M=n(14744),d=n(15202),e=n(8447),c=n(50186),f=n(29762),G=n(92767),X=n(69838),t=n(90670),nt=n(99728),Q=n(44514),ot=n(24251),Z=n(7901),tt=n(47561);function A(B,g){if(1&B&&i.nrm(0,"ds-listable-object-component-loader",6),2&B){const h=i.XpG(),U=i.XpG(3);i.Y8G("object",h)("viewMode",U.viewMode)}}function k(B,g){if(1&B&&(i.j41(0,"div"),i.nrm(1,"ds-item-alerts",4)(2,"ds-access-by-token-notification")(3,"ds-qa-event-notification",4)(4,"ds-notify-requests-status",5)(5,"ds-item-versions-notice",4),i.DNE(6,A,1,2,"ds-listable-object-component-loader",6),i.nI1(7,"async"),i.nrm(8,"ds-item-versions",7),i.k0s()),2&B){const h=g,U=i.XpG(3);i.R7$(),i.Y8G("item",h),i.R7$(2),i.Y8G("item",h),i.R7$(),i.Y8G("itemUuid",h.uuid),i.R7$(),i.Y8G("item",h),i.R7$(),i.vxM(!h.isWithdrawn||i.bMT(7,7,U.isAdmin$)?6:-1),i.R7$(2),i.Y8G("item",h)("displayActions",!1)}}function E(B,g){if(1&B&&(i.j41(0,"div",2),i.DNE(1,k,9,9,"div"),i.k0s()),2&B){let h;const U=i.XpG().ngVar;i.Y8G("@fadeInOut",void 0),i.R7$(),i.vxM((h=null==U?null:U.payload)?1:-1,h)}}function j(B,g){1&B&&(i.nrm(0,"ds-error",3),i.nI1(1,"translate")),2&B&&i.FS9("message",i.bMT(1,1,"error.item"))}function L(B,g){1&B&&(i.nrm(0,"ds-loading",3),i.nI1(1,"translate")),2&B&&i.FS9("message",i.bMT(1,1,"loading.item"))}function H(B,g){if(1&B&&(i.j41(0,"div",1),i.DNE(1,E,2,2,"div",2)(2,j,2,3,"ds-error",3)(3,L,2,3,"ds-loading",3),i.k0s()),2&B){const h=g.ngVar;i.R7$(),i.vxM(null!=h&&h.hasSucceeded?1:-1),i.R7$(),i.vxM(null!=h&&h.hasFailed?2:-1),i.R7$(),i.vxM(null!=h&&h.isLoading?3:-1)}}let P=(()=>{class B{constructor(h,U,z,Y,K,w,at,rt,lt){this.route=h,this.router=U,this.items=z,this.authorizationService=Y,this.responseService=K,this.signpostingDataService=w,this.linkHeadService=at,this.notifyInfoService=rt,this.platformId=lt,this.viewMode=p.n.StandalonePage,this.signpostingLinks=[],this.inboxTags=[],this.coarRestApiUrls=[],this.hasValue=y.a4,this.initPageLinks()}ngOnInit(){this.itemRD$=this.route.data.pipe((0,D.T)(h=>h.dso)),this.itemPageRoute$=this.itemRD$.pipe((0,T.Hz)(),(0,D.T)(h=>(0,G._o)(h))),this.isAdmin$=this.authorizationService.isAuthorized(o._.AdministratorOf)}initPageLinks(){this.route.params.subscribe(h=>{(0,m.z)([this.signpostingDataService.getLinks(h.id).pipe((0,a.s)(1)),this.getCoarLdnLocalInboxUrls()]).subscribe(([U,z])=>{let Y="";if(this.signpostingLinks=U,U.forEach(K=>{Y=Y+((0,y.hj)(Y)?", ":"")+`<${K.href}> ; rel="${K.rel}"`+((0,y.hj)(K.type)?` ; type="${K.type}" `:" ")+((0,y.hj)(K.profile)?` ; profile="${K.profile}" `:"");let w={href:K.href,rel:K.rel};(0,y.hj)(K.type)&&(w=Object.assign(w,{type:K.type})),(0,y.hj)(K.profile)&&(w=Object.assign(w,{profile:K.profile})),this.linkHeadService.addTag(w)}),z.length>0){const K=this.initPageInboxLinks(z);Y=Y+((0,y.hj)(Y)?", ":"")+K}(0,I.Vy)(this.platformId)&&this.responseService.setHeader("Link",Y)})})}getCoarLdnLocalInboxUrls(){return this.notifyInfoService.isCoarConfigEnabled().pipe((0,S.n)(h=>h?this.notifyInfoService.getCoarLdnLocalInboxUrls():(0,O.of)([])))}initPageInboxLinks(h){const U=this.notifyInfoService.getInboxRelationLink();let z="";return h.forEach(Y=>{const K={href:Y,rel:U};this.inboxTags.push(K),this.linkHeadService.addTag(K),z=z+((0,y.hj)(z)?", ":"")+`<${Y}> ; rel="${U}"`}),z}ngOnDestroy(){this.signpostingLinks.forEach(h=>{this.linkHeadService.removeTag(`href='${h.href}'`)}),this.inboxTags.forEach(h=>{this.linkHeadService.removeTag(`href='${h.href}'`)})}getAccessPeriodEndDate(h,U){if((0,y.a4)(h)&&h>0&&(0,y.a4)(U)){const z=new Date(U);return z.setUTCSeconds(z.getUTCSeconds()+h),z}}static{this.\u0275fac=function(U){return new(U||B)(i.rXU(Z.nX),i.rXU(Z.Ix),i.rXU(F.ItemDataService),i.rXU(C.AuthorizationDataService),i.rXU(_.w),i.rXU(b.z),i.rXU(tt.m),i.rXU($.P),i.rXU(i.Agw))}}static{this.\u0275cmp=i.VBU({type:B,selectors:[["ds-base-item-page"]],standalone:!0,features:[i.aNF],decls:2,vars:3,consts:[["class","container",4,"ngVar"],[1,"container"],[1,"item-page"],[3,"message"],[3,"item"],[3,"itemUuid"],[3,"object","viewMode"],[1,"mt-2",3,"item","displayActions"]],template:function(U,z){1&U&&(i.DNE(0,H,4,3,"div",0),i.nI1(1,"async")),2&U&&i.Y8G("ngVar",i.bMT(1,1,z.itemRD$))},dependencies:[nt.f,I.Jj,M.A,X.I,t.s,e.v,Q.x,ot.f,f.R,d.v,v.h,v.D9,c.r],styles:["@media (max-width: 991.98px){.container[_ngcontent-%COMP%]{width:100%;max-width:none}}"],data:{animation:[V.Ws]},changeDetection:0})}}return B})()},44514:(N,x,n)=>{"use strict";n.d(x,{x:()=>M});var I=n(60177),i=n(5964),v=n(96354),m=n(20284),O=n(4093),D=n(89777),a=n(68018),S=n(24100),$=n(25713),C=function(d){return d.ACCEPTED="ACCEPTED",d.REJECTED="REJECTED",d.REQUESTED="REQUESTED",d.TENTATIVE_REJECT="TENTATIVE_REJECT",d}(C||{}),o=n(54438);const F=d=>({"align-items-center":d}),b=(d,e,c)=>({serviceName:d,serviceUrl:e,offerType:c});function _(d,e){if(1&d&&(o.nrm(0,"div",6),o.nI1(1,"translate")),2&d){const c=e.$implicit,f=o.XpG(2);o.Y8G("innerHTML",o.i5U(1,1,f.displayOptions.text,o.sMw(4,b,c.serviceName,c.serviceUrl,c.offerType)),o.npT)}}function T(d,e){if(1&d&&(o.j41(0,"div",1),o.nrm(1,"img",2),o.j41(2,"ds-truncatable",3)(3,"ds-truncatable-part",4)(4,"div",5),o.Z7z(5,_,2,8,"div",6,o.fX1),o.k0s()()()()),2&d){const c=o.XpG();o.ZvI("alert d-flex flex-row sections-gap ",c.displayOptions.alertType,""),o.Y8G("ngClass",o.eq3(7,F,1===c.data.length)),o.R7$(2),o.Y8G("id",c.status),o.R7$(),o.Y8G("id",c.status)("minLines",1),o.R7$(2),o.Dyx(c.data)}}let p=(()=>{class d{constructor(){this.data=[]}ngOnInit(){this.prepareDataToDisplay()}prepareDataToDisplay(){switch(this.status){case C.ACCEPTED:this.displayOptions={alertType:"alert-info",text:"request-status-alert-box.accepted"};break;case C.REJECTED:this.displayOptions={alertType:"alert-danger",text:"request-status-alert-box.rejected"};break;case C.TENTATIVE_REJECT:this.displayOptions={alertType:"alert-warning",text:"request-status-alert-box.tentative_rejected"};break;case C.REQUESTED:this.displayOptions={alertType:"alert-warning",text:"request-status-alert-box.requested"}}}static{this.\u0275fac=function(f){return new(f||d)}}static{this.\u0275cmp=o.VBU({type:d,selectors:[["ds-request-status-alert-box"]],inputs:{status:"status",data:"data"},standalone:!0,features:[o.aNF],decls:1,vars:1,consts:[[3,"ngClass","class"],[3,"ngClass"],["src","assets/images/qa-coar-notify-logo.png","alt","notify logo",1,"source-logo"],[3,"id"],[3,"id","minLines"],[1,"w-100","d-flex","flex-column"],[3,"innerHTML"]],template:function(f,G){1&f&&o.DNE(0,T,7,9,"div",0),2&f&&o.vxM((null==G.data?null:G.data.length)>0&&G.displayOptions?0:-1)},dependencies:[I.YU,a.h,a.D9,S.d,$.W],styles:[".source-logo[_ngcontent-%COMP%]{max-height:var(--ds-header-logo-height)}.sections-gap[_ngcontent-%COMP%]{gap:1rem}"],changeDetection:0})}}return d})();function V(d,e){if(1&d&&o.nrm(0,"ds-request-status-alert-box",0),2&d){const c=e.$implicit;o.Y8G("status",c.key)("data",c.value)}}function y(d,e){if(1&d&&(o.Z7z(0,V,1,2,"ds-request-status-alert-box",0,o.fX1),o.nI1(2,"async"),o.nI1(3,"keyvalue")),2&d){const c=o.XpG();o.Dyx(o.bMT(3,2,o.bMT(2,0,c.requestMap$)))}}let M=(()=>{class d{constructor(c){this.notifyInfoService=c}ngOnInit(){this.requestMap$=this.notifyInfoService.getNotifyRequestsStatus(this.itemUuid).pipe((0,O.qD)(),(0,i.p)(c=>(0,D.a4)(c)),(0,O.Bo)(),(0,i.p)(c=>(0,D.a4)(c)),(0,v.T)(c=>this.groupDataByStatus(c)))}groupDataByStatus(c){const f=new Map;return c.notifyStatus?.forEach(G=>{const X=G.status;f.has(X)||f.set(X,[]),f.get(X)?.push(G)}),f}static{this.\u0275fac=function(f){return new(f||d)(o.rXU(m.NotifyRequestsStatusDataService))}}static{this.\u0275cmp=o.VBU({type:d,selectors:[["ds-notify-requests-status"]],inputs:{itemUuid:"itemUuid"},standalone:!0,features:[o.aNF],decls:2,vars:3,consts:[[3,"status","data"]],template:function(f,G){if(1&f&&(o.DNE(0,y,4,4),o.nI1(1,"async")),2&f){let X;o.vxM((null==(X=o.bMT(1,1,G.requestMap$))?null:X.size)>0?0:-1)}},dependencies:[I.Jj,I.lG,p],changeDetection:0})}}return d})()},24251:(N,x,n)=>{"use strict";n.d(x,{f:()=>M});var I=n(60177),i=n(7901),v=n(68018),m=n(96354),O=n(99437),D=n(83),a=n(10186),S=n(20387),C=(n(15862),n(4093)),o=n(54438);let F=(()=>{class d{transform(c,f){return c.split(f)}static{this.\u0275fac=function(f){return new(f||d)}}static{this.\u0275pipe=o.EJ8({name:"dsSplit",type:d,pure:!0,standalone:!0})}}return d})();const b=d=>({num:d}),_=(d,e,c)=>[d,e,"target",c],T=()=>({forward:!0});function p(d,e){if(1&d&&(o.j41(0,"div",0)(1,"div",1),o.nrm(2,"img",2),o.nI1(3,"dsSplit"),o.k0s(),o.j41(4,"div",3)(5,"div",4),o.EFF(6),o.nI1(7,"translate"),o.k0s(),o.j41(8,"button",5),o.nI1(9,"dsSplit"),o.EFF(10),o.nI1(11,"translate"),o.k0s()()()),2&d){const c=o.XpG().$implicit,f=o.XpG(2);o.R7$(2),o.Mz_("src","assets/images/qa-",o.i5U(3,8,c.id,":")[0],"-logo.png",o.B4B),o.Mz_("alt","",c.id," logo"),o.R7$(4),o.SpI(" ",o.i5U(7,11,"item.qa-event-notification.check.notification-info",o.eq3(19,b,c.totalEvents))," "),o.R7$(2),o.Y8G("routerLink",o.sMw(21,_,f.getQualityAssuranceRoute(),o.i5U(9,14,c.id,":")[0],f.item.id))("queryParams",o.lJ4(25,T)),o.R7$(2),o.SpI(" ",o.bMT(11,17,"item.qa-event-notification-info.check.button")," ")}}function V(d,e){1&d&&o.DNE(0,p,12,26,"div",0),2&d&&o.vxM(e.$implicit.totalEvents>0?0:-1)}function y(d,e){1&d&&o.Z7z(0,V,1,1,null,null,o.fX1),2&d&&o.Dyx(e)}let M=(()=>{class d{constructor(c){this.qualityAssuranceSourceDataService=c}ngOnChanges(c){c.item&&c.item.currentValue.uuid!==c.item.previousValue?.uuid&&(this.sources$=this.getQualityAssuranceSources$())}getQualityAssuranceSources$(){const c={searchParams:[new a.x("target",this.item.uuid)]};return this.qualityAssuranceSourceDataService.getSourcesByTarget(c,!1).pipe((0,C.qD)(),(0,m.T)(f=>f.hasSucceeded?f.payload.page:[]),(0,O.W)(()=>[]))}getQualityAssuranceRoute(){return(0,D.b7)()}static{this.\u0275fac=function(f){return new(f||d)(o.rXU(S.QualityAssuranceSourceDataService))}}static{this.\u0275cmp=o.VBU({type:d,selectors:[["ds-qa-event-notification"]],inputs:{item:"item"},standalone:!0,features:[o.Jv_([S.QualityAssuranceSourceDataService]),o.OA$,o.aNF],decls:2,vars:3,consts:[[1,"alert","alert-info","d-flex","flex-row"],[1,"source-logo-container"],["onerror","this.src='assets/images/dspace-logo.svg'",1,"source-logo",3,"src","alt"],[1,"w-100","d-flex","justify-content-between"],[1,"ps-4","align-self-center"],[1,"btn","btn-primary","align-self-center",3,"routerLink","queryParams"]],template:function(f,G){if(1&f&&(o.DNE(0,y,2,0),o.nI1(1,"async")),2&f){let X;o.vxM((X=o.bMT(1,1,G.sources$))?0:-1,X)}},dependencies:[I.Jj,i.Wk,F,v.h,v.D9],styles:[".source-logo[_ngcontent-%COMP%]{max-height:var(--ds-header-logo-height)}.source-logo-container[_ngcontent-%COMP%]{width:var(--ds-qa-logo-width);display:flex;justify-content:center}.sections-gap[_ngcontent-%COMP%]{gap:1rem}"],changeDetection:0})}}return d})()},69838:(N,x,n)=>{"use strict";n.d(x,{I:()=>Bt});var I=n(60177),i=n(89417),v=n(68018),m=n(84572),O=n(25558),D=n(96354),a=n(99172),S=n(96697),$=n(94925),C=n(11873),o=n(6170),F=n(57439),b=n(7164),_=n(31),p=(n(15862),n(4093)),V=n(64972),y=n(74082),M=n(79104),d=n(89777),e=n(9847),c=n(2175),f=n(8417),G=n(30726),X=n(4600),t=n(54438),nt=n(7901),Q=n(7673),ot=n(70274),Z=n(73028),tt=n(88141),A=n(61206),E=(n(71147),n(80189)),j=n(25645),L=n(92767),H=n(58003);const P=r=>({version:r});let B=(()=>{class r{constructor(s){this.activeModal=s,this.response=new t.bkB}onModalClose(){this.response.emit(!1),this.activeModal.dismiss()}onModalSubmit(){this.response.emit(!0),this.activeModal.close()}static{this.\u0275fac=function(u){return new(u||r)(t.rXU(H.Lw))}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["ds-item-versions-delete-modal"]],outputs:{response:"response"},standalone:!0,features:[t.aNF],decls:20,vars:21,consts:[[1,"modal-header"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"pb-2"],[1,"modal-footer"],[1,"btn","btn-outline-secondary","btn-sm","cancel",3,"click","title"],[1,"fas","fa-times","fa-fw"],[1,"btn","btn-danger","btn-sm","confirm",3,"click","title"],[1,"fas","fa-check","fa-fw"]],template:function(u,l){1&u&&(t.j41(0,"div")(1,"div",0),t.EFF(2),t.nI1(3,"translate"),t.j41(4,"button",1),t.bIt("click",function(){return l.onModalClose()}),t.k0s()(),t.j41(5,"div",2)(6,"p",3),t.EFF(7),t.nI1(8,"translate"),t.k0s()(),t.j41(9,"div",4)(10,"button",5),t.nI1(11,"translate"),t.bIt("click",function(){return l.onModalClose()}),t.nrm(12,"i",6),t.EFF(13),t.nI1(14,"translate"),t.k0s(),t.j41(15,"button",7),t.nI1(16,"translate"),t.bIt("click",function(){return l.onModalSubmit()}),t.nrm(17,"i",8),t.EFF(18),t.nI1(19,"translate"),t.k0s()()()),2&u&&(t.R7$(2),t.SpI("",t.bMT(3,6,"item.version.delete.modal.header")," "),t.R7$(5),t.JRh(t.i5U(8,8,"item.version.delete.modal.text",t.eq3(19,P,l.versionNumber))),t.R7$(3),t.FS9("title",t.bMT(11,11,"item.version.delete.modal.button.cancel.tooltip")),t.R7$(3),t.SpI(" ",t.bMT(14,13,"item.version.delete.modal.button.cancel")," "),t.R7$(2),t.FS9("title",t.bMT(16,15,"item.version.delete.modal.button.confirm.tooltip")),t.R7$(3),t.SpI(" ",t.bMT(19,17,"item.version.delete.modal.button.confirm")," "))},dependencies:[v.h,v.D9]})}}return r})();var g=n(38884),h=n(82574);function U(r,W){if(1&r&&t.EFF(0),2&r){const s=t.XpG();t.SpI(" ",s.version.version," ")}}function z(r,W){if(1&r&&(t.j41(0,"a",1),t.EFF(1),t.k0s()),2&r){const s=t.XpG();t.Y8G("routerLink",s.getVersionRoute(s.version.id)),t.R7$(),t.JRh(s.version.version)}}function Y(r,W){1&r&&(t.j41(0,"span"),t.EFF(1,"*"),t.k0s())}function K(r,W){1&r&&(t.j41(0,"span",2),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&r&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"item.version.history.table.workspaceItem")," "))}function w(r,W){1&r&&(t.j41(0,"span",3),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&r&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"item.version.history.table.workflowItem")," "))}function at(r,W){if(1&r){const s=t.RV6();t.j41(0,"button",9),t.nI1(1,"translate"),t.bIt("click",function(){t.eBV(s);const l=t.XpG(2);return t.Njj(l.editWorkspaceItem(l.workspaceId$))}),t.nrm(2,"i",10),t.k0s()}2&r&&t.FS9("title",t.bMT(1,1,"item.version.history.table.action.editWorkspaceItem"))}function rt(r,W){if(1&r){const s=t.RV6();t.j41(0,"button",11),t.nI1(1,"translate"),t.bIt("click",function(){t.eBV(s);const l=t.XpG(2);return t.Njj(l.createNewVersion(l.version))}),t.nrm(2,"i",12),t.k0s()}if(2&r){const s=t.XpG(2);t.FS9("title",t.bMT(1,2,s.createVersionTitle)),t.Y8G("dsBtnDisabled",s.isAnyBeingEdited()||s.hasDraftVersion)}}function lt(r,W){if(1&r){const s=t.RV6();t.j41(0,"button",13),t.nI1(1,"translate"),t.bIt("click",function(){t.eBV(s);const l=t.XpG(2);return t.Njj(l.deleteVersion(l.version,l.version.id===l.itemVersion.id))}),t.nrm(2,"i",14),t.k0s()}if(2&r){const s=t.XpG(2);t.FS9("title",t.bMT(1,3,"item.version.history.table.action.deleteVersion")),t.Y8G("ngClass",s.isAnyBeingEdited()?"btn-outline-primary":"btn-outline-danger")("dsBtnDisabled",s.isAnyBeingEdited())}}function dt(r,W){if(1&r&&(t.j41(0,"div",5),t.DNE(1,at,3,3,"button",6),t.nI1(2,"async"),t.DNE(3,rt,3,4,"button",7),t.nI1(4,"async"),t.DNE(5,lt,3,5,"button",8),t.nI1(6,"async"),t.k0s()),2&r){const s=t.XpG();t.R7$(),t.vxM(t.bMT(2,3,s.workspaceId$)?1:-1),t.R7$(2),t.vxM(t.bMT(4,5,s.canCreateVersion$)?3:-1),t.R7$(2),t.vxM(t.bMT(6,7,s.canDeleteVersion$)?5:-1)}}let mt=(()=>{class r{constructor(s,u,l,R,J,q,st,_t,et,it,ct){this.workspaceItemDataService=s,this.workflowItemDataService=u,this.router=l,this.itemService=R,this.authorizationService=J,this.itemVersionShared=q,this.versionHistoryService=st,this.versionService=_t,this.notificationsService=et,this.translateService=it,this.modalService=ct,this.versionsHistoryChange=new t.bkB}ngOnInit(){this.workspaceId$=this.getWorkspaceId(this.version.item),this.workflowId$=this.getWorkflowId(this.version.item),this.canDeleteVersion$=this.canDeleteVersion(this.version),this.canCreateVersion$=this.authorizationService.isAuthorized(o._.CanCreateVersion,this.item.self),this.createVersionTitle=this.hasDraftVersion?"item.version.history.table.action.hasDraft":"item.version.history.table.action.newVersion"}getWorkspaceId(s){return this.hasDraftVersion?s.pipe((0,p.ak)(),(0,D.T)(u=>u.uuid),(0,O.n)(u=>this.workspaceItemDataService.findByItem(u,!0)),(0,p.qD)(),(0,D.T)(u=>u?.payload?.id)):(0,Q.of)(void 0)}getWorkflowId(s){return this.getWorkspaceId(s).pipe((0,ot.H)(u=>u?(0,Q.of)(void 0):s.pipe((0,p.ak)(),(0,D.T)(l=>l.uuid),(0,O.n)(l=>this.workflowItemDataService.findByItem(l,!0)),(0,p.qD)(),(0,D.T)(l=>l?.payload?.id))))}editWorkspaceItem(s){s.subscribe(u=>{this.router.navigateByUrl("workspaceitems/"+u+"/edit")})}canDeleteVersion(s){return this.authorizationService.isAuthorized(o._.CanDeleteVersion,s.self)}getVersionRoute(s){return(0,L.vf)(s)}createNewVersion(s){const u=s.version,l=this.modalService.open(h.L);l.componentInstance.versionNumber=u,l.componentInstance.createVersionEvent.pipe((0,Z.Z)(R=>(0,m.z)([(0,Q.of)(R),s.item.pipe((0,p.ak)())])),(0,Z.Z)(([R,J])=>this.versionHistoryService.createVersion(J._links.self.href,R)),(0,p.qD)(),(0,tt.M)(()=>l.close()),(0,tt.M)(R=>{if(this.itemVersionShared.notifyCreateNewVersion(R),R.hasSucceeded){const J=this.versionService.getHistoryFromVersion(s).pipe((0,tt.M)(q=>{this.itemService.invalidateItemCache(this.item.uuid),this.versionHistoryService.invalidateVersionHistoryCache(q.id)}));this.versionsHistoryChange.emit(J)}}),(0,p.ak)(),(0,O.n)(R=>this.itemService.findByHref(R._links.item.href)),(0,p.ak)(),(0,O.n)(R=>this.workspaceItemDataService.findByItem(R.uuid,!0,!1)),(0,p.ak)()).subscribe(R=>{this.router.navigateByUrl("workspaceitems/"+R.id+"/edit")})}deleteVersion(s,u){const J=s.version,q=s.item,st=this.modalService.open(B);st.componentInstance.versionNumber=s.version,st.componentInstance.firstVersion=!1,st.componentInstance.response.pipe((0,S.s)(1)).subscribe(_t=>{_t&&q.pipe((0,p.ak)(),(0,Z.Z)(et=>(0,m.z)([(0,Q.of)(et),this.versionHistoryService.getVersionHistoryFromVersion$(s)])),(0,Z.Z)(([et,it])=>(0,m.z)([this.deleteItemAndGetResult$(et),(0,Q.of)(it)])),(0,Z.Z)(([et,it])=>(0,m.z)([(0,Q.of)(et),this.versionHistoryService.getLatestVersionItemFromHistory$(it).pipe((0,tt.M)(()=>{this.versionsHistoryChange.emit((0,Q.of)(it))}))]))).subscribe(([et,it])=>{if(et?this.notificationsService.success(null,this.translateService.get("item.version.delete.notification.success",{version:J})):this.notificationsService.error(null,this.translateService.get("item.version.delete.notification.failure",{version:J})),u){const ct=(0,L.nF)(it);this.router.navigateByUrl(ct)}})})}deleteItemAndGetResult$(s){return this.itemService.delete(s.id).pipe((0,p.qD)(),(0,D.T)(u=>u.hasSucceeded),(0,S.s)(1))}isAnyBeingEdited(){return null!=this.versionBeingEditedNumber}static{this.\u0275fac=function(u){return new(u||r)(t.rXU(j.WorkspaceitemDataService),t.rXU(E.WorkflowItemDataService),t.rXU(nt.Ix),t.rXU(A.ItemDataService),t.rXU(C.AuthorizationDataService),t.rXU(g.h),t.rXU(b.VersionHistoryDataService),t.rXU(F.VersionDataService),t.rXU(e.I),t.rXU(v.c$),t.rXU(H.Bq))}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["ds-item-versions-row-element-version"]],inputs:{hasDraftVersion:"hasDraftVersion",version:"version",itemVersion:"itemVersion",item:"item",displayActions:"displayActions",versionBeingEditedNumber:"versionBeingEditedNumber"},outputs:{versionsHistoryChange:"versionsHistoryChange"},standalone:!0,features:[t.aNF],decls:12,vars:13,consts:[[1,"left-column"],[3,"routerLink"],[1,"text-light","badge","bg-primary","ms-3"],[1,"text-light","badge","bg-info","ms-3"],[1,"right-column"],[1,"btn-group","edit-field","space-children-mr"],[1,"btn","btn-outline-primary","btn-sm","version-row-element-edit",3,"title"],[1,"btn","btn-outline-primary","btn-sm","version-row-element-create",3,"dsBtnDisabled","title"],[1,"btn","btn-sm","version-row-element-delete",3,"ngClass","dsBtnDisabled","title"],[1,"btn","btn-outline-primary","btn-sm","version-row-element-edit",3,"click","title"],[1,"fas","fa-pencil-alt","fa-fw"],[1,"btn","btn-outline-primary","btn-sm","version-row-element-create",3,"click","dsBtnDisabled","title"],[1,"fas","fa-code-branch","fa-fw"],[1,"btn","btn-sm","version-row-element-delete",3,"click","ngClass","dsBtnDisabled","title"],[1,"fas","fa-trash","fa-fw"]],template:function(u,l){1&u&&(t.j41(0,"div",0),t.DNE(1,U,1,1),t.nI1(2,"async"),t.nI1(3,"async"),t.DNE(4,z,2,2,"a",1)(5,Y,2,0,"span")(6,K,3,3,"span",2),t.nI1(7,"async"),t.DNE(8,w,3,3,"span",3),t.nI1(9,"async"),t.k0s(),t.j41(10,"div",4),t.DNE(11,dt,7,9,"div",5),t.k0s()),2&u&&(t.R7$(),t.vxM(t.bMT(2,5,l.workspaceId$)||t.bMT(3,7,l.workflowId$)?1:4),t.R7$(4),t.vxM((null==l.version?null:l.version.id)===(null==l.itemVersion?null:l.itemVersion.id)?5:-1),t.R7$(),t.vxM(t.bMT(7,9,l.workspaceId$)?6:-1),t.R7$(2),t.vxM(t.bMT(9,11,l.workflowId$)?8:-1),t.R7$(3),t.vxM(l.displayActions?11:-1))},dependencies:[I.Jj,M.A,I.YU,nt.Wk,v.h,v.D9],styles:[".left-column[_ngcontent-%COMP%]{float:left;text-align:left}.right-column[_ngcontent-%COMP%]{float:right;text-align:right}"]})}}return r})();const pt=r=>({version:r});function ut(r,W){1&r&&(t.j41(0,"h2",2),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&r&&(t.R7$(),t.JRh(t.bMT(2,1,"item.version.history.head")))}function vt(r,W){1&r&&(t.j41(0,"th",7),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&r&&(t.R7$(),t.JRh(t.bMT(2,1,"item.version.history.table.editor")))}function ht(r,W){if(1&r&&(t.j41(0,"td",11),t.EFF(1),t.k0s()),2&r){const s=t.XpG().$implicit;t.R7$(),t.SpI(" ",s.version.submitterName," ")}}function Et(r,W){if(1&r){const s=t.RV6();t.j41(0,"input",17),t.nI1(1,"translate"),t.mxI("ngModelChange",function(l){t.eBV(s);const R=t.XpG(6);return t.DH7(R.versionBeingEditedSummary,l)||(R.versionBeingEditedSummary=l),t.Njj(l)}),t.bIt("keyup.enter",function(){t.eBV(s);const l=t.XpG(6);return t.Njj(l.onSummarySubmit())}),t.k0s()}if(2&r){const s=t.XpG(6);t.R50("ngModel",s.versionBeingEditedSummary),t.BMQ("aria-label",t.bMT(1,2,"item.version.history.table.action.editSummary"))}}function ft(r,W){if(1&r&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&r){const s=t.XpG().$implicit;t.R7$(),t.JRh(s.version.summary)}}function gt(r,W){if(1&r){const s=t.RV6();t.j41(0,"input",17),t.nI1(1,"translate"),t.mxI("ngModelChange",function(l){t.eBV(s);const R=t.XpG(6);return t.DH7(R.versionBeingEditedSummary,l)||(R.versionBeingEditedSummary=l),t.Njj(l)}),t.bIt("keyup.enter",function(){t.eBV(s);const l=t.XpG(6);return t.Njj(l.onSummarySubmit())}),t.k0s()}if(2&r){const s=t.XpG(6);t.R50("ngModel",s.versionBeingEditedSummary),t.BMQ("aria-label",t.bMT(1,2,"item.version.history.table.action.editSummary"))}}function Ct(r,W){if(1&r){const s=t.RV6();t.j41(0,"button",19),t.nI1(1,"translate"),t.bIt("click",function(){t.eBV(s);const l=t.XpG(7);return t.Njj(l.disableVersionEditing())}),t.nrm(2,"i",20),t.k0s(),t.j41(3,"button",21),t.nI1(4,"translate"),t.bIt("click",function(){t.eBV(s);const l=t.XpG(7);return t.Njj(l.onSummarySubmit())}),t.nrm(5,"i",22),t.k0s()}2&r&&(t.FS9("title",t.bMT(1,2,"item.version.history.table.action.discardSummary")),t.R7$(3),t.FS9("title",t.bMT(4,4,"item.version.history.table.action.saveSummary")))}function Mt(r,W){if(1&r){const s=t.RV6();t.j41(0,"button",23),t.nI1(1,"translate"),t.bIt("click",function(){t.eBV(s);const l=t.XpG(2).$implicit,R=t.XpG(5);return t.Njj(R.enableVersionEditing(l.version))}),t.nrm(2,"i",24),t.k0s()}if(2&r){const s=t.XpG(7);t.FS9("title",t.bMT(1,2,"item.version.history.table.action.editSummary")),t.Y8G("dsBtnDisabled",s.isAnyBeingEdited())}}function Dt(r,W){if(1&r&&(t.j41(0,"div",16),t.DNE(1,Ct,6,6)(2,Mt,3,4,"button",18),t.k0s()),2&r){const s=t.XpG().$implicit,u=t.XpG(5);t.R7$(),t.vxM(u.isThisBeingEdited(s.version)?1:2)}}function It(r,W){if(1&r){const s=t.RV6();t.j41(0,"tr",8)(1,"td",9)(2,"ds-item-versions-row-element-version",10),t.nI1(3,"async"),t.bIt("versionsHistoryChange",function(l){t.eBV(s);const R=t.XpG(5);return t.Njj(R.getAllVersions(l))}),t.k0s()(),t.DNE(4,ht,2,1,"td",11),t.nI1(5,"async"),t.j41(6,"td",12),t.EFF(7),t.nI1(8,"date"),t.k0s(),t.j41(9,"td",13)(10,"div",14),t.DNE(11,Et,2,4,"input",15)(12,ft,2,1,"span")(13,gt,2,4,"ng-template",null,0,t.C5r),t.k0s(),t.DNE(15,Dt,3,1,"div",16),t.nI1(16,"async"),t.k0s()()}if(2&r){const s=W.$implicit,u=t.XpG(3),l=t.XpG(2);t.Y8G("id","version-row-"+s.version.id),t.R7$(2),t.Y8G("hasDraftVersion",t.bMT(3,11,l.hasDraftVersion$))("version",s.version)("item",l.item)("displayActions",l.displayActions)("itemVersion",u)("versionBeingEditedNumber",l.versionBeingEditedNumber),t.R7$(2),t.vxM(t.bMT(5,13,l.showSubmitter$)?4:-1),t.R7$(3),t.SpI(" ",t.i5U(8,15,s.version.created,"yyyy-MM-dd HH:mm:ss")," "),t.R7$(4),t.vxM(l.isThisBeingEdited(s.version)?11:12),t.R7$(4),t.vxM(t.bMT(16,18,l.displayActions&&s.canEditVersion)?15:-1)}}function Tt(r,W){if(1&r){const s=t.RV6();t.j41(0,"ds-pagination",5),t.bIt("paginationChange",function(){t.eBV(s);const l=t.XpG(4);return t.Njj(l.onPageChange())}),t.j41(1,"table",6)(2,"thead")(3,"tr")(4,"th",7),t.EFF(5),t.nI1(6,"translate"),t.k0s(),t.DNE(7,vt,3,3,"th",7),t.nI1(8,"async"),t.j41(9,"th",7),t.EFF(10),t.nI1(11,"translate"),t.k0s(),t.j41(12,"th",7),t.EFF(13),t.nI1(14,"translate"),t.k0s()()(),t.j41(15,"tbody"),t.Z7z(16,It,17,20,"tr",8,t.fX1),t.k0s()(),t.j41(18,"div"),t.EFF(19),t.nI1(20,"translate"),t.k0s()()}if(2&r){const s=t.XpG(3),u=t.XpG();t.Y8G("hideGear",!0)("hidePagerWhenSinglePage",!0)("paginationOptions",u.options)("collectionSize",s.totalElements)("retainScrollPosition",!0),t.R7$(5),t.JRh(t.bMT(6,10,"item.version.history.table.version")),t.R7$(2),t.vxM(t.bMT(8,12,u.showSubmitter$)?7:-1),t.R7$(3),t.JRh(t.bMT(11,14,"item.version.history.table.date")),t.R7$(3),t.JRh(t.bMT(14,16,"item.version.history.table.summary")),t.R7$(3),t.Dyx(s.versionDTOs),t.R7$(3),t.SpI("*\xa0",t.bMT(20,18,"item.version.history.selected"),"")}}function yt(r,W){if(1&r&&(t.j41(0,"div",1),t.DNE(1,ut,3,3,"h2",2),t.j41(2,"ds-alert",3),t.EFF(3),t.nI1(4,"translate"),t.k0s(),t.DNE(5,Tt,21,20,"ds-pagination",4),t.k0s()),2&r){const s=t.XpG(),u=t.XpG(),l=t.XpG();t.R7$(),t.vxM(l.displayTitle?1:-1),t.R7$(),t.Y8G("type",l.AlertTypeEnum.Info),t.R7$(),t.SpI(" ",t.i5U(4,4,"item.version.history.selected.alert",t.eq3(7,pt,s.version))," "),t.R7$(2),t.vxM(u.versionDTOs.length>0?5:-1)}}function Ot(r,W){if(1&r&&(t.j41(0,"div"),t.DNE(1,yt,6,9,"div",1),t.k0s()),2&r){const s=t.XpG(),u=t.XpG();t.R7$(),t.vxM(s.versionDTOs.length>0||u.displayWhenEmpty?1:-1)}}function Pt(r,W){if(1&r&&(t.j41(0,"div"),t.DNE(1,Ot,2,1,"div"),t.nI1(2,"async"),t.k0s()),2&r){let s;const u=t.XpG();t.R7$(),t.vxM((s=null==(s=t.bMT(2,1,u.versionRD$))?null:s.payload)?1:-1,s)}}function Rt(r,W){if(1&r&&t.nrm(0,"ds-alert",25),2&r){const s=t.XpG(2);t.Y8G("content","item.version.history.empty")("type",s.AlertTypeEnum.Info)}}function St(r,W){if(1&r&&t.DNE(0,Rt,1,2,"ds-alert",25),2&r){const s=t.XpG();t.vxM(s.displayWhenEmpty?0:-1)}}let Bt=(()=>{class r{constructor(s,u,l,R,J,q,st){this.versionHistoryService=s,this.versionService=u,this.paginationService=l,this.notificationsService=R,this.translateService=J,this.authorizationService=q,this.configurationService=st,this.displayWhenEmpty=!1,this.displayTitle=!0,this.subs=[],this.AlertTypeEnum=y.v,this.showSubmitter$=this.showSubmitter(),this.pageSize=10,this.options=Object.assign(new f.W,{id:"ivo",currentPage:1,pageSize:this.pageSize})}isAnyBeingEdited(){return null!=this.versionBeingEditedNumber}isThisBeingEdited(s){return s?.version===this.versionBeingEditedNumber}enableVersionEditing(s){this.versionBeingEditedSummary=s?.summary,this.versionBeingEditedNumber=s?.version,this.versionBeingEditedId=s?.id}disableVersionEditing(){this.versionBeingEditedSummary=void 0,this.versionBeingEditedNumber=void 0,this.versionBeingEditedId=void 0}onSummarySubmit(){this.versionService.findById(this.versionBeingEditedId).pipe((0,p.yd)(),(0,O.n)(l=>{const q=Object.assign({},l.payload,{summary:this.versionBeingEditedSummary});return this.versionService.update(q).pipe((0,p.qD)())})).subscribe(l=>{l.hasSucceeded?(this.notificationsService.success(null,this.translateService.get("item.version.edit.notification.success",{version:this.versionBeingEditedNumber})),this.getAllVersions(this.versionHistory$)):this.notificationsService.warning(null,this.translateService.get("item.version.edit.notification.failure",{version:this.versionBeingEditedNumber})),this.disableVersionEditing()})}canEditVersion$(s){return this.authorizationService.isAuthorized(o._.CanEditVersion,s.self)}showSubmitter(){const s=this.configurationService.findByPropertyName("versioning.item.history.include.submitter").pipe((0,p.ak)(),(0,D.T)(l=>l.values[0]),(0,a.Z)(!1)),u=(0,m.z)([this.authorizationService.isAuthorized(o._.IsCollectionAdmin),this.authorizationService.isAuthorized(o._.IsCommunityAdmin),this.authorizationService.isAuthorized(o._.AdministratorOf)]).pipe((0,D.T)(([l,R,J])=>l||R||J),(0,S.s)(1));return(0,m.z)([s,u]).pipe((0,D.T)(([l,R])=>l&&R))}getAllVersions(s){const u=this.paginationService.getCurrentPagination(this.options.id,this.options);this.versionsDTO$=(0,m.z)([s,u]).pipe((0,O.n)(([l,R])=>this.versionHistoryService.getVersions(l.id,new G.C({pagination:Object.assign({},R,{currentPage:R.currentPage})}),!1,!0,(0,X.s)("item"),(0,X.s)("eperson"))),(0,p.qD)(),(0,p.Bo)(),(0,D.T)(l=>({totalElements:l.totalElements,versionDTOs:(l?.page??[]).map(R=>({version:R,canEditVersion:this.canEditVersion$(R)}))})))}onPageChange(){this.getAllVersions(this.versionHistory$)}ngOnInit(){(0,d.a4)(this.item.version)&&(this.versionRD$=this.item.version,this.versionHistoryRD$=this.versionRD$.pipe((0,p.v7)(),(0,p.Bo)(),(0,d.Az)(),(0,O.n)(s=>s.versionhistory)),this.versionHistory$=this.versionHistoryRD$.pipe((0,p.ak)(),(0,d.Az)()),this.hasDraftVersion$=this.versionHistoryRD$.pipe((0,p.ak)(),(0,D.T)(s=>!!s?.draftVersion)),this.getAllVersions(this.versionHistory$))}ngOnDestroy(){this.cleanupSubscribes(),this.paginationService.clearPagination(this.options.id)}cleanupSubscribes(){this.subs.filter(s=>(0,d.a4)(s)).forEach(s=>s.unsubscribe())}static{this.\u0275fac=function(u){return new(u||r)(t.rXU(b.VersionHistoryDataService),t.rXU(F.VersionDataService),t.rXU(_.m),t.rXU(e.I),t.rXU(v.c$),t.rXU(C.AuthorizationDataService),t.rXU($.ConfigurationDataService))}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["ds-item-versions"]],inputs:{item:"item",displayWhenEmpty:"displayWhenEmpty",displayTitle:"displayTitle",displayActions:"displayActions"},standalone:!0,features:[t.aNF],decls:3,vars:3,consts:[["editSummary",""],[1,"mb-2"],[1,"h4"],[3,"type"],[3,"hideGear","hidePagerWhenSinglePage","paginationOptions","collectionSize","retainScrollPosition"],[3,"paginationChange","hideGear","hidePagerWhenSinglePage","paginationOptions","collectionSize","retainScrollPosition"],[1,"table","table-striped","table-bordered","align-middle","my-2"],["scope","col"],[3,"id"],[1,"version-row-element-version"],[3,"versionsHistoryChange","hasDraftVersion","version","item","displayActions","itemVersion","versionBeingEditedNumber"],[1,"version-row-element-editor"],[1,"version-row-element-date"],[1,"version-row-element-summary"],[1,"float-start"],["type","text",1,"form-control",3,"ngModel"],[1,"float-end","btn-group","edit-field","space-children-mr"],["type","text",1,"form-control",3,"ngModelChange","keyup.enter","ngModel"],[1,"btn","btn-outline-primary","btn-sm","version-row-element-edit",3,"dsBtnDisabled","title"],[1,"btn","btn-sm","btn-outline-warning",3,"click","title"],[1,"fas","fa-undo-alt","fa-fw"],[1,"btn","btn-outline-success","btn-sm",3,"click","title"],[1,"fas","fa-check","fa-fw"],[1,"btn","btn-outline-primary","btn-sm","version-row-element-edit",3,"click","dsBtnDisabled","title"],[1,"fas","fa-edit","fa-fw"],[3,"content","type"]],template:function(u,l){if(1&u&&(t.DNE(0,Pt,3,3,"div"),t.nI1(1,"async"),t.DNE(2,St,1,1)),2&u){let R;t.vxM((R=t.bMT(1,1,l.versionsDTO$))?0:2,R)}},dependencies:[V.C,I.Jj,M.A,I.vh,i.YN,i.me,i.BC,i.vS,mt,c.e,v.h,v.D9]})}}return r})()},90670:(N,x,n)=>{"use strict";n.d(x,{s:()=>y});var I=n(60177),i=n(68018),v=n(983),m=n(7673),O=n(25558),D=n(96354),a=n(99172),S=n(7164),C=(n(15862),n(4093)),o=n(64972),F=n(74082),b=n(89777),_=n(92767),T=n(54438);const p=M=>({destination:M});function V(M,d){if(1&M&&(T.nrm(0,"ds-alert",0),T.nI1(1,"async"),T.nI1(2,"async"),T.nI1(3,"translate")),2&M){let e;const c=T.XpG();T.Y8G("content",T.i5U(3,7,"item.version.notice",T.eq3(10,p,c.getItemPage(null==(e=T.bMT(2,5,null==(e=T.bMT(1,3,c.latestVersion$))?null:e.item))?null:e.payload))))("dismissible",!1)("type",c.AlertTypeEnum.Warning)}}let y=(()=>{class M{constructor(e){this.versionHistoryService=e,this.AlertTypeEnum=F.v}ngOnInit(){(0,b.a4)(this.item.version)&&(this.versionRD$=this.item.version,this.versionHistoryRD$=this.versionRD$.pipe((0,C.v7)(),(0,C.Bo)(),(0,b.Az)(),(0,O.n)(e=>e.versionhistory)),this.latestVersion$=this.versionHistoryRD$.pipe((0,C.qD)(),(0,O.n)(e=>e.hasSucceeded?this.versionHistoryService.getLatestVersionFromHistory$(e.payload):v.w)),this.showLatestVersionNotice$=this.versionRD$.pipe((0,C.qD)(),(0,O.n)(e=>e.hasSucceeded?this.versionHistoryService.isLatest$(e.payload).pipe((0,D.T)(c=>null!=c&&!c)):(0,m.of)(!1)),(0,a.Z)(!1)))}getItemPage(e){if((0,b.a4)(e))return(0,_._o)(e)}static{this.\u0275fac=function(c){return new(c||M)(T.rXU(S.VersionHistoryDataService))}}static{this.\u0275cmp=T.VBU({type:M,selectors:[["ds-item-versions-notice"]],inputs:{item:"item"},standalone:!0,features:[T.aNF],decls:2,vars:3,consts:[[3,"content","dismissible","type"]],template:function(c,f){1&c&&(T.DNE(0,V,4,12,"ds-alert",0),T.nI1(1,"async")),2&c&&T.vxM(!0===T.bMT(1,1,f.showLatestVersionNotice$)?0:-1)},dependencies:[o.C,I.Jj,i.h,i.D9],encapsulation:2})}}return M})()},42176:(N,x,n)=>{var I={"./custom/app/item-page/alerts/item-alerts.component":[66327,6327]};function i(v){if(!n.o(I,v))return Promise.resolve().then(()=>{var D=new Error("Cannot find module '"+v+"'");throw D.code="MODULE_NOT_FOUND",D});var m=I[v],O=m[0];return n.e(m[1]).then(()=>n(O))}i.keys=()=>Object.keys(I),i.id=42176,N.exports=i},63614:(N,x,n)=>{var I={"./custom/app/item-page/full/field-components/file-section/full-file-section.component":[72583,2583]};function i(v){if(!n.o(I,v))return Promise.resolve().then(()=>{var D=new Error("Cannot find module '"+v+"'");throw D.code="MODULE_NOT_FOUND",D});var m=I[v],O=m[0];return n.e(m[1]).then(()=>n(O))}i.keys=()=>Object.keys(I),i.id=63614,N.exports=i},4872:(N,x,n)=>{var I={"./custom/app/item-page/full/full-item-page.component":[51797,1797]};function i(v){if(!n.o(I,v))return Promise.resolve().then(()=>{var D=new Error("Cannot find module '"+v+"'");throw D.code="MODULE_NOT_FOUND",D});var m=I[v],O=m[0];return n.e(m[1]).then(()=>n(O))}i.keys=()=>Object.keys(I),i.id=4872,N.exports=i}}]);