"use strict";(self.webpackChunkdspace_angular=self.webpackChunkdspace_angular||[]).push([[8173],{8173:(O,R,s)=>{s.r(R),s.d(R,{ROUTES:()=>tt});var l=s(59072),C=s(7673),b=s(6170);const M=(0,s(61457).L)(()=>(0,C.of)(b._.IsCommunityAdmin));var D=s(12808),U=s(60892),f=s(38285),F=s(8667),h=s(60177),e=s(96354),g=s(4093),$=s(21200),t=s(54438),d=s(7901);function S(o,y){1&o&&t.nrm(0,"ds-access-control-form-container",0),2&o&&t.Y8G("itemRD",y)("showLimitToSpecificBitstreams",!1)}let p=(()=>{class o{constructor(n){this.route=n}ngOnInit(){this.itemRD$=this.route.parent.parent.data.pipe((0,e.T)(n=>n.dso)).pipe((0,g.yd)())}static{this.\u0275fac=function(a){return new(a||o)(t.rXU(d.nX))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["ds-community-access-control"]],standalone:!0,features:[t.aNF],decls:2,vars:3,consts:[["titleMessage","community-access-control-title",3,"itemRD","showLimitToSpecificBitstreams"]],template:function(a,i){if(1&a&&(t.DNE(0,S,1,2,"ds-access-control-form-container",0),t.nI1(1,"async")),2&a){let c;t.vxM((c=t.bMT(1,1,i.itemRD$))?0:-1,c)}},dependencies:[$.o,h.Jj]})}}return o})();var T=s(61594),u=s(80781);let m=(()=>{class o{constructor(n){this.route=n}ngOnInit(){this.dsoRD$=this.route.parent.parent.data.pipe((0,T.$)(),(0,e.T)(n=>n.dso))}static{this.\u0275fac=function(a){return new(a||o)(t.rXU(d.nX))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["ds-community-authorizations"]],standalone:!0,features:[t.aNF],decls:3,vars:4,consts:[[1,"container"],[3,"resourceType","resourceUUID"]],template:function(a,i){if(1&a&&(t.j41(0,"div",0),t.nrm(1,"ds-resource-policies",1),t.nI1(2,"async"),t.k0s()),2&a){let c;t.R7$(),t.Y8G("resourceType","community")("resourceUUID",null==(c=t.bMT(2,2,i.dsoRD$))||null==c.payload?null:c.payload.id)}},dependencies:[h.Jj,u.e],encapsulation:2})}}return o})();var r=s(68018),v=s(96697),P=s(5964),B=s(43446),X=s(1144),_=s(89777);const j=o=>({community:o});let L=(()=>{class o{constructor(n,a){this.route=n,this.dsoNameService=a}ngOnInit(){this.dsoRD$=this.route.parent.data.pipe((0,v.s)(1),(0,e.T)(n=>n.dso)),this.communityName$=this.dsoRD$.pipe((0,P.p)(n=>(0,_.a4)(n)),(0,e.T)(n=>this.dsoNameService.getName(n.payload)))}static{this.\u0275fac=function(a){return new(a||o)(t.rXU(d.nX),t.rXU(B.f))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["ds-community-curate"]],standalone:!0,features:[t.aNF],decls:7,vars:11,consts:[[1,"container"],[3,"dsoHandle"]],template:function(a,i){if(1&a&&(t.j41(0,"div",0)(1,"h2"),t.EFF(2),t.nI1(3,"async"),t.nI1(4,"translate"),t.k0s(),t.nrm(5,"ds-curation-form",1),t.nI1(6,"async"),t.k0s()),2&a){let c;t.R7$(2),t.JRh(t.i5U(4,4,"community.curate.header",t.eq3(9,j,t.bMT(3,2,i.communityName$)))),t.R7$(3),t.Y8G("dsoHandle",null==(c=t.bMT(6,7,i.dsoRD$))?null:c.payload.handle)}},dependencies:[h.Jj,X.X,r.h,r.D9],encapsulation:2})}}return o})();var A=s(30684),N=s(10406),G=s(99125),J=s(9847),H=s(67044);let W=(()=>{class o extends G.W{constructor(n,a,i,c,E){super(n,a,i,c,E),this.communityDataService=n,this.router=a,this.route=i,this.notificationsService=c,this.translate=E,this.frontendURL="/communities/",this.type=N.E.type}static{this.\u0275fac=function(a){return new(a||o)(t.rXU(A.CommunityDataService),t.rXU(d.Ix),t.rXU(d.nX),t.rXU(J.I),t.rXU(r.c$))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["ds-community-metadata"]],standalone:!0,features:[t.Vt3,t.aNF],decls:2,vars:4,consts:[[3,"submitForm","back","finish","dso","isCreation"]],template:function(a,i){if(1&a&&(t.j41(0,"ds-community-form",0),t.nI1(1,"async"),t.bIt("submitForm",function(E){return i.onSubmit(E)})("back",function(){return i.navigateToHomePage()})("finish",function(){return i.navigateToHomePage()}),t.k0s()),2&a){let c;t.Y8G("dso",null==(c=t.bMT(1,2,i.dsoRD$))?null:c.payload)("isCreation",!1)}},dependencies:[h.Jj,H.p],encapsulation:2})}}return o})();var K=s(60185);function V(o,y){if(1&o&&(t.nrm(0,"ds-comcol-role",1),t.nI1(1,"async")),2&o){const n=y.$implicit,a=t.XpG();t.Y8G("dso",t.bMT(1,2,a.community$))("comcolRole",n)}}let z=(()=>{class o{constructor(n){this.route=n}ngOnInit(){this.dsoRD$=this.route.parent.data.pipe((0,T.$)(),(0,e.T)(n=>n.dso)),this.community$=this.dsoRD$.pipe((0,g.yd)(),(0,g.Bo)()),this.comcolRoles$=this.community$.pipe((0,e.T)(n=>[{name:"community-admin",href:n._links.adminGroup.href}]))}static{this.\u0275fac=function(a){return new(a||o)(t.rXU(d.nX))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["ds-community-roles"]],standalone:!0,features:[t.aNF],decls:4,vars:2,consts:[[1,"custom-alignment"],[3,"dso","comcolRole"]],template:function(a,i){1&a&&(t.j41(0,"div",0),t.Z7z(1,V,2,4,"ds-comcol-role",1,t.fX1),t.nI1(3,"async"),t.k0s()),2&a&&(t.R7$(),t.Dyx(t.bMT(3,0,i.comcolRoles$)))},dependencies:[h.Jj,K.J],encapsulation:2})}}return o})();var Y=s(41744),k=s(39015);const x=o=>({active:o}),Z=o=>[o];function Q(o,y){if(1&o&&(t.j41(0,"li",9)(1,"a",14),t.EFF(2),t.nI1(3,"translate"),t.k0s()()),2&o){const n=y.$implicit,a=t.XpG();t.R7$(),t.Y8G("ngClass",t.eq3(7,x,n===a.currentPage))("routerLink",t.eq3(9,Z,"./"+n)),t.BMQ("aria-selected",n===a.currentPage)("data-test",n),t.R7$(),t.SpI(" ",t.bMT(3,5,a.type+".edit.tabs."+n+".head")," ")}}function w(o,y){if(1&o&&(t.j41(0,"a",13),t.nI1(1,"async"),t.nrm(2,"i",15),t.EFF(3),t.nI1(4,"translate"),t.k0s()),2&o){let n;const a=t.XpG();t.Y8G("routerLink",a.getPageUrl(null==(n=t.bMT(1,2,a.dsoRD$))?null:n.payload)),t.R7$(3),t.SpI(" ",t.bMT(4,4,a.type+".edit.return")," ")}}const tt=[{path:"",resolve:{breadcrumb:l.S},data:{breadcrumbKey:"community.edit"},component:(()=>{class o extends Y.M{constructor(n,a){super(n,a),this.router=n,this.route=a,this.type="community"}getPageUrl(n){return(0,k.c5)(n.id)}static{this.\u0275fac=function(a){return new(a||o)(t.rXU(d.Ix),t.rXU(d.nX))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["ds-edit-community"]],standalone:!0,features:[t.Vt3,t.aNF],decls:22,vars:10,consts:[[1,"container"],[1,"row"],[1,"col-12"],[1,"d-flex","justify-content-between","border-bottom"],[1,"my-auto"],["data-test","delete-button",1,"btn","btn-danger",3,"routerLink"],["aria-hidden","true",1,"fas","fa-trash"],[1,"pt-2"],["role","tablist",1,"nav","nav-tabs","justify-content-start","mb-2"],["role","presentation",1,"nav-item"],[1,"tab-pane","active"],[1,"mb-4"],[1,"col-12","text-end","custom-alignment"],[1,"btn","btn-outline-secondary",3,"routerLink"],["role","tab",1,"nav-link",3,"ngClass","routerLink"],["aria-hidden","true",1,"fas","fa-arrow-left"]],template:function(a,i){if(1&a&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1"),t.EFF(5),t.nI1(6,"translate"),t.k0s(),t.j41(7,"div",4)(8,"a",5),t.nI1(9,"async"),t.nrm(10,"i",6),t.EFF(11),t.nI1(12,"translate"),t.k0s()()(),t.j41(13,"div",7)(14,"ul",8),t.Z7z(15,Q,4,11,"li",9,t.fX1),t.k0s(),t.j41(17,"div",10)(18,"div",11),t.nrm(19,"router-outlet"),t.k0s(),t.j41(20,"div",12),t.DNE(21,w,5,6,"a",13),t.k0s()()()()()()),2&a){let c;t.R7$(5),t.JRh(t.bMT(6,4,i.type+".edit.head")),t.R7$(3),t.Y8G("routerLink",("community"===i.type?"/communities/":"/collections/")+(null==(c=t.bMT(9,6,i.dsoRD$))?null:c.payload.uuid)+"/delete"),t.R7$(3),t.SpI(" ",t.bMT(12,8,i.type+".edit.delete"),""),t.R7$(4),t.Dyx(i.pages),t.R7$(6),t.vxM(i.hideReturnButton?-1:21)}},dependencies:[h.Jj,h.YU,d.Wk,d.n3,r.h,r.D9],encapsulation:2})}}return o})(),canActivate:[M],children:[{path:"",redirectTo:"metadata",pathMatch:"full"},{path:"metadata",component:W,data:{title:"community.edit.tabs.metadata.title",hideReturnButton:!0,showBreadcrumbs:!0}},{path:"roles",component:z,data:{title:"community.edit.tabs.roles.title",showBreadcrumbs:!0}},{path:"curate",component:L,data:{title:"community.edit.tabs.curate.title",showBreadcrumbs:!0}},{path:"access-control",component:p,data:{title:"collection.edit.tabs.access-control.title",showBreadcrumbs:!0}},{path:"authorizations",data:{showBreadcrumbs:!0},children:[{path:"create",resolve:{resourcePolicyTarget:F.Q},component:D.m,data:{title:"resource-policies.create.page.title"}},{path:"edit",resolve:{resourcePolicy:f.n},component:U._,data:{title:"resource-policies.edit.page.title"}},{path:"",component:m,data:{title:"community.edit.tabs.authorizations.title",showBreadcrumbs:!0,hideReturnButton:!0}}]}]}]},1144:(O,R,s)=>{s.d(R,{X:()=>S});var l=s(89417),C=s(68018),b=s(96354),I=s(94925),M=s(60696),D=s(4093),U=s(44280),f=s(89777),F=s(74511),h=s(9847),e=s(54438),g=s(7901);function $(p,T){if(1&p&&(e.j41(0,"option",6),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&p){const u=T.$implicit;e.Y8G("value",u),e.R7$(),e.SpI(" ",e.bMT(2,2,"curation-task.task."+u+".label")," ")}}function t(p,T){1&p&&(e.j41(0,"div",3)(1,"label",8),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.nrm(4,"input",9),e.j41(5,"small",10),e.EFF(6),e.nI1(7,"translate"),e.k0s()()),2&p&&(e.R7$(2),e.JRh(e.bMT(3,2,"curation.form.handle.label")),e.R7$(4),e.JRh(e.bMT(7,4,"curation.form.handle.hint")))}let S=(()=>{class p{constructor(u,m,r,v,P,B,X){this.scriptDataService=u,this.configurationDataService=m,this.notificationsService=r,this.translateService=v,this.handleService=P,this.router=B,this.cdr=X,this.subs=[]}ngOnDestroy(){this.subs.forEach(u=>u.unsubscribe())}ngOnInit(){this.form=new l.J3({task:new l.hs(""),handle:new l.hs("")}),this.config=this.configurationDataService.findByPropertyName("plugin.named.org.dspace.curate.CurationTask"),this.subs.push(this.config.pipe((0,D.ak)()).subscribe(u=>{this.tasks=u.values.filter(m=>(0,f.hj)(m)&&m.includes("=")).map(m=>m.split("=")[1].trim()),this.form.get("task").patchValue(this.tasks[0]),this.cdr.detectChanges()}))}hasHandleValue(){return(0,f.a4)(this.dsoHandle)}submit(){const u=this.form.get("task").value;let m;m=this.hasHandleValue()?this.handleService.normalizeHandle(this.dsoHandle).pipe((0,b.T)(r=>((0,f.Im)(r)&&this.notificationsService.error(this.translateService.get("curation.form.submit.error.head"),this.translateService.get("curation.form.submit.error.invalid-handle")),r))):this.handleService.normalizeHandle(this.form.get("handle").value).pipe((0,b.T)(r=>(0,f.Im)(r)?"all":r)),this.subs.push(m.subscribe(r=>{(0,f.a4)(r)&&this.subs.push(this.scriptDataService.invoke("curate",[{name:"-t",value:u},{name:"-i",value:r}],[]).pipe((0,D.qD)()).subscribe(v=>{v.hasSucceeded?(this.notificationsService.success(this.translateService.get("curation.form.submit.success.head"),this.translateService.get("curation.form.submit.success.content")),this.router.navigateByUrl((0,U.yJ)(v.payload.processId))):this.notificationsService.error(this.translateService.get("curation.form.submit.error.head"),this.translateService.get("curation.form.submit.error.content"))}))}))}static{this.\u0275fac=function(m){return new(m||p)(e.rXU(M.ScriptDataService),e.rXU(I.ConfigurationDataService),e.rXU(h.I),e.rXU(C.c$),e.rXU(F.e),e.rXU(g.Ix),e.rXU(e.gRc))}}static{this.\u0275cmp=e.VBU({type:p,selectors:[["ds-curation-form"]],inputs:{dsoHandle:"dsoHandle"},standalone:!0,features:[e.aNF],decls:14,vars:8,consts:[[3,"ngSubmit","formGroup"],[1,"mb-3"],[1,"row","mb-2"],[1,"col-12","col-sm-6"],["for","task",1,"fw-bold","form-label"],["id","task","formControlName","task",1,"form-select"],[3,"value"],["type","submit",1,"btn","btn-default","btn-primary"],["for","handle",1,"fw-bold","form-label"],["id","handle","formControlName","handle",1,"form-control"],[1,"text-muted"]],template:function(m,r){1&m&&(e.j41(0,"form",0),e.bIt("ngSubmit",function(){return r.submit()}),e.j41(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),e.EFF(5),e.nI1(6,"translate"),e.k0s(),e.j41(7,"select",5),e.Z7z(8,$,3,4,"option",6,e.fX1),e.k0s()(),e.DNE(10,t,8,6,"div",3),e.k0s(),e.j41(11,"button",7),e.EFF(12),e.nI1(13,"translate"),e.k0s()()()),2&m&&(e.Y8G("formGroup",r.form),e.R7$(5),e.JRh(e.bMT(6,4,"curation.form.task-select.label")),e.R7$(3),e.Dyx(r.tasks),e.R7$(2),e.vxM(r.hasHandleValue()?-1:10),e.R7$(2),e.JRh(e.bMT(13,6,"curation.form.submit")))},dependencies:[l.YN,l.qT,l.xH,l.y7,l.me,l.wz,l.BC,l.cb,l.X1,l.j4,l.JD,C.h,C.D9],encapsulation:2})}}return p})()}}]);