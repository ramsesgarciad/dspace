(self.webpackChunkdspace_angular=self.webpackChunkdspace_angular||[]).push([[7490],{24496:(f,E,n)=>{"use strict";n.r(E),n.d(E,{DenyRequestCopyComponent:()=>L});var c=n(60177),d=n(68018),e=n(84572),l=n(96354),y=n(25558),p=n(94196),$=n(43446),D=n(61206),P=n(12970),C=n(19548),O=n(4093),q=n(89777),S=n(15202),B=n(9847),j=n(50186),M=n(12732),s=n(54438),t=n(7901);function x(_,A){if(1&_){const u=s.RV6();s.j41(0,"div")(1,"p"),s.EFF(2),s.nI1(3,"translate"),s.k0s(),s.j41(4,"ds-email-request-copy",3),s.nI1(5,"async"),s.nI1(6,"async"),s.bIt("send",function(h){s.eBV(u);const r=s.XpG(2);return s.Njj(r.deny(h))}),s.k0s()()}if(2&_){const u=s.XpG(2);s.R7$(2),s.JRh(s.bMT(3,3,"deny-request-copy.intro")),s.R7$(2),s.Y8G("subject",s.bMT(5,5,u.subject$))("message",s.bMT(6,7,u.message$))}}function F(_,A){1&_&&s.nrm(0,"ds-loading")}function U(_,A){if(1&_&&(s.j41(0,"div",1)(1,"h3",2),s.EFF(2),s.nI1(3,"translate"),s.k0s(),s.DNE(4,x,7,9,"div")(5,F,1,0,"ds-loading"),s.k0s()),2&_){const u=A.ngVar;s.R7$(2),s.JRh(s.bMT(3,3,"deny-request-copy.header")),s.R7$(2),s.vxM(u&&u.hasSucceeded?4:-1),s.R7$(),s.vxM(!u||null!=u&&u.isLoading?5:-1)}}let L=(()=>{class _{constructor(u,i,h,r,m,v,T,G){this.router=u,this.route=i,this.authService=h,this.translateService=r,this.itemDataService=m,this.nameService=v,this.itemRequestService=T,this.notificationsService=G}ngOnInit(){this.itemRequestRD$=this.route.data.pipe((0,l.T)(i=>i.request),(0,O.qD)(),(0,C.QD)(this.router,this.authService));const u=(0,e.z)([this.itemRequestRD$.pipe((0,O.ak)()),this.authService.getAuthenticatedUserFromStore()]).pipe((0,y.n)(([i,h])=>this.itemDataService.findById(i.itemId).pipe((0,O.ak)(),(0,l.T)(r=>{const m=r.firstMetadataValue("dc.identifier.uri");return Object.assign({recipientName:i.requestName,itemUrl:(0,q.hj)(m)?m:r.handle,itemName:this.nameService.getName(r),authorName:this.nameService.getName(h),authorEmail:h.email})}))));this.subject$=this.translateService.get("deny-request-copy.email.subject"),this.message$=u.pipe((0,y.n)(i=>this.translateService.get("deny-request-copy.email.message",i)))}deny(u){this.itemRequestRD$.pipe((0,O.ak)(),(0,y.n)(i=>this.itemRequestService.deny(i.token,u)),(0,O.qD)()).subscribe(i=>{i.hasSucceeded?(this.notificationsService.success(this.translateService.get("deny-request-copy.success")),this.router.navigateByUrl("/")):this.notificationsService.error(this.translateService.get("deny-request-copy.error"),i.errorMessage)})}static{this.\u0275fac=function(i){return new(i||_)(s.rXU(t.Ix),s.rXU(t.nX),s.rXU(p.uR),s.rXU(d.c$),s.rXU(D.ItemDataService),s.rXU($.f),s.rXU(P.W),s.rXU(B.I))}}static{this.\u0275cmp=s.VBU({type:_,selectors:[["ds-base-deny-request-copy"]],standalone:!0,features:[s.aNF],decls:2,vars:3,consts:[["class","container",4,"ngVar"],[1,"container"],[1,"mb-4"],[3,"send","subject","message"]],template:function(i,h){1&i&&(s.DNE(0,U,6,5,"div",0),s.nI1(1,"async")),2&i&&s.Y8G("ngVar",s.bMT(1,1,h.itemRequestRD$))},dependencies:[c.Jj,M.r,S.v,d.h,d.D9,j.r]})}}return _})()},12732:(f,E,n)=>{"use strict";n.d(E,{r:()=>y});var c=n(54438),d=n(29710);const e=["*"];function l(p,$){}let y=(()=>{class p extends d.J{constructor(){super(...arguments),this.send=new c.bkB,this.selectedAccessPeriod=new c.bkB,this.inAndOutputNames=["send","subject","message","selectedAccessPeriod","validAccessPeriods$"]}getComponentName(){return"EmailRequestCopyComponent"}importThemedComponent(D){return n(16292)(`./${D}/app/request-copy/email-request-copy/email-request-copy.component`)}importUnthemedComponent(){return n.e(2076).then(n.bind(n,98678))}static{this.\u0275fac=(()=>{let D;return function(C){return(D||(D=c.xGo(p)))(C||p)}})()}static{this.\u0275cmp=c.VBU({type:p,selectors:[["ds-email-request-copy"]],inputs:{subject:"subject",message:"message",validAccessPeriods$:"validAccessPeriods$"},outputs:{send:"send",selectedAccessPeriod:"selectedAccessPeriod"},standalone:!0,features:[c.Vt3,c.aNF],ngContentSelectors:e,decls:5,vars:0,consts:[["vcr",""],["content",""]],template:function(P,C){1&P&&(c.NAR(),c.DNE(0,l,0,0,"ng-template",null,0,c.C5r),c.j41(2,"div",null,1),c.SdG(4),c.k0s())},encapsulation:2})}}return p})()},11130:(f,E,n)=>{"use strict";n.r(E),n.d(E,{GrantRequestCopyComponent:()=>u});var c=n(60177),d=n(89417),e=n(68018),l=n(96354),y=n(88141),p=n(25558),$=n(94196),D=n(12970),P=n(19548),C=n(4093),O=n(5127),q=n(92767),S=n(89777),B=n(15202),j=n(9847),M=n(50186),s=n(12732),t=n(54438),x=n(7901),F=n(95488);function U(i,h){if(1&i&&(t.j41(0,"div")(1,"p"),t.EFF(2),t.nI1(3,"translate"),t.j41(4,"a",8),t.EFF(5),t.k0s()()()),2&i){const r=t.XpG(3);t.R7$(2),t.SpI("",t.bMT(3,5,"grant-request-copy.intro.link.preview")," "),t.R7$(2),t.Y8G("target","_blank"),t.BMQ("routerLink",r.previewLinkOptions.routerLink)("queryParams",r.previewLinkOptions.queryParams),t.R7$(),t.SpI(" ",r.previewLink," ")}}function L(i,h){if(1&i){const r=t.RV6();t.j41(0,"div")(1,"p"),t.EFF(2),t.nI1(3,"translate"),t.k0s(),t.DNE(4,U,6,7,"div"),t.j41(5,"ds-email-request-copy",3),t.nI1(6,"async"),t.nI1(7,"async"),t.bIt("send",function(v){t.eBV(r);const T=t.XpG(2);return t.Njj(T.grant(v))})("selectedAccessPeriod",function(v){t.eBV(r);const T=t.XpG(2);return t.Njj(T.selectAccessPeriod(v))}),t.j41(8,"p"),t.EFF(9),t.nI1(10,"translate"),t.k0s(),t.j41(11,"form",4)(12,"div",5)(13,"input",6),t.mxI("ngModelChange",function(v){t.eBV(r);const T=t.XpG(2);return t.DH7(T.suggestOpenAccess,v)||(T.suggestOpenAccess=v),t.Njj(v)}),t.k0s(),t.j41(14,"label",7),t.EFF(15),t.nI1(16,"translate"),t.k0s()()()()()}if(2&i){const r=t.XpG(2);t.R7$(2),t.JRh(t.bMT(3,8,"grant-request-copy.intro."+(r.sendAsAttachment?"attachment":"link"))),t.R7$(2),t.vxM(!r.sendAsAttachment&&r.hasValue(r.previewLink)?4:-1),t.R7$(),t.Y8G("subject",t.bMT(6,10,r.subject$))("message",t.bMT(7,12,r.message$))("validAccessPeriods$",r.validAccessPeriods$),t.R7$(4),t.JRh(t.bMT(10,14,"grant-deny-request-copy.email.permissions.info")),t.R7$(4),t.R50("ngModel",r.suggestOpenAccess),t.R7$(2),t.JRh(t.bMT(16,16,"grant-deny-request-copy.email.permissions.label"))}}function _(i,h){1&i&&t.nrm(0,"ds-loading")}function A(i,h){if(1&i&&(t.j41(0,"div",1)(1,"h3",2),t.EFF(2),t.nI1(3,"translate"),t.k0s(),t.DNE(4,L,17,18,"div")(5,_,1,0,"ds-loading"),t.k0s()),2&i){const r=h.ngVar;t.R7$(2),t.JRh(t.bMT(3,3,"grant-request-copy.header")),t.R7$(2),t.vxM(r&&r.hasSucceeded?4:-1),t.R7$(),t.vxM(!r||null!=r&&r.isLoading?5:-1)}}let u=(()=>{class i{constructor(r,m,v,T,G,N,W){this.router=r,this.route=m,this.authService=v,this.translateService=T,this.itemRequestService=G,this.notificationsService=N,this.hardRedirectService=W,this.suggestOpenAccess=!1,this.accessPeriod=null,this.sendAsAttachment=!0,this.hasValue=S.a4}ngOnInit(){this.itemRequestRD$=this.route.data.pipe((0,l.T)(r=>r.request),(0,C.qD)(),(0,y.M)(r=>{r.hasSucceeded&&(0,S.a4)(r.payload.accessToken)&&(this.sendAsAttachment=!1,this.previewLinkOptions={routerLink:new O.t((0,q.Fy)(),r.payload.itemId).toString(),queryParams:{accessToken:r.payload.accessToken}},this.previewLink=this.hardRedirectService.getCurrentOrigin()+this.previewLinkOptions.routerLink+"?accessToken="+r.payload.accessToken)}),(0,P.QD)(this.router,this.authService)),this.validAccessPeriods$=this.itemRequestService.getConfiguredAccessPeriods(),this.subject$=this.translateService.get("grant-request-copy.email.subject")}grant(r){this.itemRequestRD$.pipe((0,C.ak)(),(0,p.n)(m=>this.itemRequestService.grant(m.token,r,this.suggestOpenAccess,this.accessPeriod)),(0,C.qD)()).subscribe(m=>{m.hasSucceeded?(this.notificationsService.success(this.translateService.get("grant-request-copy.success")),this.router.navigateByUrl("/")):this.notificationsService.error(this.translateService.get("grant-request-copy.error"),m.errorMessage)})}selectAccessPeriod(r){this.accessPeriod=r}static{this.\u0275fac=function(m){return new(m||i)(t.rXU(x.Ix),t.rXU(x.nX),t.rXU($.uR),t.rXU(e.c$),t.rXU(D.W),t.rXU(j.I),t.rXU(F.$))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["ds-base-grant-request-copy"]],standalone:!0,features:[t.aNF],decls:2,vars:3,consts:[["class","container",4,"ngVar"],[1,"container"],[1,"mb-4"],[3,"send","selectedAccessPeriod","subject","message","validAccessPeriods$"],[1,"mb-3"],[1,"form-check"],["type","checkbox","value","","id","permissions","name","permissions",1,"form-check-input",3,"ngModelChange","ngModel"],["for","permissions",1,"form-check-label"],[1,"dont-break-out","d-block",3,"target"]],template:function(m,v){1&m&&(t.DNE(0,A,6,5,"div",0),t.nI1(1,"async")),2&m&&t.Y8G("ngVar",t.bMT(1,1,v.itemRequestRD$))},dependencies:[c.Jj,d.YN,d.qT,d.Zm,d.BC,d.cb,d.vS,d.cV,s.r,B.v,e.D9,M.r]})}}return i})()},77490:(f,E,n)=>{"use strict";n.r(E),n.d(E,{ROUTES:()=>Y});var c=n(29710),e=(n(24496),n(54438));const l=["*"];function y(a,g){}let p=(()=>{class a extends c.J{getComponentName(){return"DenyRequestCopyComponent"}importThemedComponent(o){return n(67026)(`./${o}/app/request-copy/deny-request-copy/deny-request-copy.component`)}importUnthemedComponent(){return Promise.resolve().then(n.bind(n,24496))}static{this.\u0275fac=(()=>{let o;return function(I){return(o||(o=e.xGo(a)))(I||a)}})()}static{this.\u0275cmp=e.VBU({type:a,selectors:[["ds-deny-request-copy"]],standalone:!0,features:[e.Vt3,e.aNF],ngContentSelectors:l,decls:5,vars:0,consts:[["vcr",""],["content",""]],template:function(R,I){1&R&&(e.NAR(),e.DNE(0,y,0,0,"ng-template",null,0,e.C5r),e.j41(2,"div",null,1),e.SdG(4),e.k0s())},encapsulation:2})}}return a})();var $=n(60177),D=n(7901),P=n(68018),C=n(96354),O=n(25558),q=n(94196),S=n(43446),B=n(61206),j=n(19548),M=n(4093),s=n(92767),t=n(15202),x=n(50186),F=n(15343),U=n(5127);function L(a){return new U.t((0,F.EI)(),a).toString()}const _="deny",u="grant",h=(a,g)=>({url:a,name:g});function r(a,g){1&a&&(e.j41(0,"p"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&a&&(e.R7$(),e.JRh(e.bMT(2,1,"grant-deny-request-copy.previous-decision")))}function m(a,g){if(1&a&&(e.j41(0,"a",7),e.nI1(1,"translate"),e.nI1(2,"async"),e.EFF(3),e.nI1(4,"translate"),e.k0s(),e.j41(5,"a",6),e.nI1(6,"translate"),e.nI1(7,"async"),e.EFF(8),e.nI1(9,"translate"),e.k0s()),2&a){const o=e.XpG(4);e.FS9("title",e.bMT(1,6,"grant-deny-request-copy.grant")),e.Y8G("routerLink",e.bMT(2,8,o.grantRoute$)),e.R7$(3),e.SpI(" ",e.bMT(4,10,"grant-deny-request-copy.grant")," "),e.R7$(2),e.FS9("title",e.bMT(6,12,"grant-deny-request-copy.deny")),e.Y8G("routerLink",e.bMT(7,14,o.denyRoute$)),e.R7$(3),e.SpI(" ",e.bMT(9,16,"grant-deny-request-copy.deny")," ")}}function v(a,g){if(1&a&&(e.j41(0,"a",6),e.nI1(1,"translate"),e.nI1(2,"async"),e.EFF(3),e.nI1(4,"translate"),e.k0s()),2&a){const o=e.XpG(4);e.FS9("title",e.bMT(1,3,"grant-deny-request-copy.revoke")),e.Y8G("routerLink",e.bMT(2,5,o.denyRoute$)),e.R7$(3),e.SpI(" ",e.bMT(4,7,"grant-deny-request-copy.revoke")," ")}}function T(a,g){if(1&a&&(e.j41(0,"div"),e.nrm(1,"p",4),e.nI1(2,"async"),e.nI1(3,"async"),e.nI1(4,"translate"),e.j41(5,"p"),e.EFF(6),e.nI1(7,"translate"),e.k0s(),e.DNE(8,r,3,3,"p"),e.j41(9,"div",5),e.DNE(10,m,10,18)(11,v,5,9,"a",6),e.k0s()()),2&a){const o=e.XpG(2).ngVar,R=e.XpG();e.R7$(),e.Y8G("innerHTML",e.i5U(4,9,"grant-deny-request-copy.intro1",e.l_i(14,h,e.bMT(2,5,R.itemUrl$),e.bMT(3,7,R.itemName$))),e.npT),e.R7$(5),e.JRh(e.bMT(7,12,"grant-deny-request-copy.intro2")),e.R7$(2),e.vxM(o.payload.decisionDate?8:-1),e.R7$(2),e.vxM(o.payload.decisionDate?-1:10),e.R7$(),e.vxM(o.payload.decisionDate&&!0===o.payload.acceptRequest&&o.payload.accessToken?11:-1)}}function G(a,g){1&a&&(e.j41(0,"div",3)(1,"p"),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"p",8)(5,"a",9),e.EFF(6),e.nI1(7,"translate"),e.k0s()()()),2&a&&(e.R7$(2),e.JRh(e.bMT(3,2,"grant-deny-request-copy.processed")),e.R7$(4),e.JRh(e.bMT(7,4,"grant-deny-request-copy.home-page")))}function N(a,g){if(1&a&&(e.j41(0,"div"),e.DNE(1,T,12,17,"div")(2,G,8,6,"div",3),e.k0s()),2&a){const o=e.XpG().ngVar;e.R7$(),e.vxM(!o.payload.decisionDate||!0===o.payload.acceptRequest&&o.payload.accessToken?1:-1),e.R7$(),e.vxM(!o.payload.decisionDate||o.payload.acceptRequest&&o.payload.accessToken?-1:2)}}function W(a,g){1&a&&e.nrm(0,"ds-loading")}function K(a,g){if(1&a&&(e.j41(0,"div",1)(1,"h3",2),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.DNE(4,N,3,2,"div")(5,W,1,0,"ds-loading"),e.k0s()),2&a){const o=g.ngVar;e.R7$(2),e.JRh(e.bMT(3,3,"grant-deny-request-copy.header")),e.R7$(2),e.vxM(o&&o.hasSucceeded?4:-1),e.R7$(),e.vxM(!o||null!=o&&o.isLoading?5:-1)}}let X=(()=>{class a{constructor(o,R,I,Q,H){this.router=o,this.route=R,this.authService=I,this.itemDataService=Q,this.nameService=H}ngOnInit(){this.itemRequestRD$=this.route.data.pipe((0,C.T)(o=>o.request),(0,M.qD)(),(0,j.QD)(this.router,this.authService)),this.itemRD$=this.itemRequestRD$.pipe((0,M.ak)(),(0,O.n)(o=>this.itemDataService.findById(o.itemId))),this.itemName$=this.itemRD$.pipe((0,M.ak)(),(0,C.T)(o=>this.nameService.getName(o))),this.itemUrl$=this.itemRD$.pipe((0,M.ak)(),(0,C.T)(o=>(0,s._o)(o))),this.denyRoute$=this.itemRequestRD$.pipe((0,M.ak)(),(0,C.T)(o=>function A(a){return new U.t(L(a),_).toString()}(o.token))),this.grantRoute$=this.itemRequestRD$.pipe((0,M.ak)(),(0,C.T)(o=>function i(a){return new U.t(L(a),u).toString()}(o.token)))}static{this.\u0275fac=function(R){return new(R||a)(e.rXU(D.Ix),e.rXU(D.nX),e.rXU(q.uR),e.rXU(B.ItemDataService),e.rXU(S.f))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["ds-grant-deny-request-copy"]],standalone:!0,features:[e.aNF],decls:2,vars:3,consts:[["class","container",4,"ngVar"],[1,"container"],[1,"mb-4"],[1,"processed-message"],[3,"innerHTML"],[1,"btn-group"],[1,"btn","btn-outline-danger",3,"routerLink","title"],[1,"btn","btn-outline-primary",3,"routerLink","title"],[1,"text-center"],["routerLink","/home","role","button","tabindex","0",1,"btn","btn-primary"]],template:function(R,I){1&R&&(e.DNE(0,K,6,5,"div",0),e.nI1(1,"async")),2&R&&e.Y8G("ngVar",e.bMT(1,1,I.itemRequestRD$))},dependencies:[$.Jj,D.Wk,t.v,P.h,P.D9,x.r]})}}return a})();n(11130);const V=["*"];function k(a,g){}let J=(()=>{class a extends c.J{getComponentName(){return"GrantRequestCopyComponent"}importThemedComponent(o){return n(63572)(`./${o}/app/request-copy/grant-request-copy/grant-request-copy.component`)}importUnthemedComponent(){return Promise.resolve().then(n.bind(n,11130))}static{this.\u0275fac=(()=>{let o;return function(I){return(o||(o=e.xGo(a)))(I||a)}})()}static{this.\u0275cmp=e.VBU({type:a,selectors:[["ds-grant-request-copy"]],standalone:!0,features:[e.Vt3,e.aNF],ngContentSelectors:V,decls:5,vars:0,consts:[["vcr",""],["content",""]],template:function(R,I){1&R&&(e.NAR(),e.DNE(0,k,0,0,"ng-template",null,0,e.C5r),e.j41(2,"div",null,1),e.SdG(4),e.k0s())},encapsulation:2})}}return a})();var b=n(12970);const Y=[{path:":token",resolve:{request:(a,g,o=(0,e.WQX)(b.W))=>o.findById(a.params.token).pipe((0,M.qD)())},children:[{path:"",component:X},{path:_,component:p},{path:u,component:J}]}]},67026:(f,E,n)=>{var c={"./custom/app/request-copy/deny-request-copy/deny-request-copy.component":[21789,1789]};function d(e){if(!n.o(c,e))return Promise.resolve().then(()=>{var p=new Error("Cannot find module '"+e+"'");throw p.code="MODULE_NOT_FOUND",p});var l=c[e],y=l[0];return n.e(l[1]).then(()=>n(y))}d.keys=()=>Object.keys(c),d.id=67026,f.exports=d},16292:(f,E,n)=>{var c={"./custom/app/request-copy/email-request-copy/email-request-copy.component":[88447,2076,8447]};function d(e){if(!n.o(c,e))return Promise.resolve().then(()=>{var p=new Error("Cannot find module '"+e+"'");throw p.code="MODULE_NOT_FOUND",p});var l=c[e],y=l[0];return Promise.all(l.slice(1).map(n.e)).then(()=>n(y))}d.keys=()=>Object.keys(c),d.id=16292,f.exports=d},63572:(f,E,n)=>{var c={"./custom/app/request-copy/grant-request-copy/grant-request-copy.component":[67403,7403]};function d(e){if(!n.o(c,e))return Promise.resolve().then(()=>{var p=new Error("Cannot find module '"+e+"'");throw p.code="MODULE_NOT_FOUND",p});var l=c[e],y=l[0];return n.e(l[1]).then(()=>n(y))}d.keys=()=>Object.keys(c),d.id=63572,f.exports=d}}]);