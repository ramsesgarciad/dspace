"use strict";(self.webpackChunkdspace_angular=self.webpackChunkdspace_angular||[]).push([[8519],{78519:(J,F,o)=>{o.r(F),o.d(F,{ROUTES:()=>Dn,ValidateEmailErrorStateMatcher:()=>ve});var _=o(1473),C=o(59072),$=o(54761),y=o(42657),b=o(42589),d=o(68018),P=o(84412),Y=o(23294),g=o(96354),te=o(85092),N=o(79104),G=o(76089),T=o(60177),f=o(58003),e=o(54438);class ne{constructor(){this.change=new e.bkB,this.instances={},this.DEFAULT_ID="DEFAULT_PAGINATION_ID"}defaultId(){return this.DEFAULT_ID}register(r){return null==r.id&&(r.id=this.DEFAULT_ID),this.instances[r.id]?this.updateInstance(r):(this.instances[r.id]=r,!0)}updateInstance(r){let t=!1;for(let n in this.instances[r.id])r[n]!==this.instances[r.id][n]&&(this.instances[r.id][n]=r[n],t=!0);return t}getCurrentPage(r){return this.instances[r]?this.instances[r].currentPage:1}setCurrentPage(r,t){if(this.instances[r]){let n=this.instances[r];t<=Math.ceil(n.totalItems/n.itemsPerPage)&&1<=t&&(this.instances[r].currentPage=t,this.change.emit(r))}}setTotalItems(r,t){this.instances[r]&&0<=t&&(this.instances[r].totalItems=t,this.change.emit(r))}setItemsPerPage(r,t){this.instances[r]&&(this.instances[r].itemsPerPage=t,this.change.emit(r))}getInstance(r=this.DEFAULT_ID){return this.instances[r]?this.clone(this.instances[r]):{}}clone(r){var t={};for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n]);return t}}const ke=Number.MAX_SAFE_INTEGER;let Ge=(()=>{class a{constructor(t){this.service=t,this.state={}}transform(t,n){if(!(t instanceof Array)){let v=n.id||this.service.defaultId();return this.state[v]?this.state[v].slice:t}let p,h,i=n.totalItems&&n.totalItems!==t.length,s=this.createInstance(t,n),l=s.id,S=s.itemsPerPage,x=this.service.register(s);if(!i&&t instanceof Array){if(S=+S||ke,p=(s.currentPage-1)*S,h=p+S,this.stateIsIdentical(l,t,p,h))return this.state[l].slice;{let j=t.slice(p,h);return this.saveState(l,t,j,p,h),this.service.change.emit(l),j}}return x&&this.service.change.emit(l),this.saveState(l,t,t,p,h),t}createInstance(t,n){return this.checkConfig(n),{id:null!=n.id?n.id:this.service.defaultId(),itemsPerPage:+n.itemsPerPage||0,currentPage:+n.currentPage||1,totalItems:+n.totalItems||t.length}}checkConfig(t){const i=["itemsPerPage","currentPage"].filter(s=>!(s in t));if(0<i.length)throw new Error(`PaginatePipe: Argument is missing the following required properties: ${i.join(", ")}`)}saveState(t,n,i,s,l){this.state[t]={collection:n,size:n.length,slice:i,start:s,end:l}}stateIsIdentical(t,n,i,s){let l=this.state[t];return!(!l||l.size!==n.length||l.start!==i||l.end!==s)&&l.slice.every((h,S)=>h===n[i+S])}}return a.\u0275fac=function(t){return new(t||a)(e.rXU(ne,16))},a.\u0275pipe=e.EJ8({name:"paginate",type:a,pure:!1}),a})(),Me=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.$C({type:a}),a.\u0275inj=e.G2t({providers:[ne],imports:[[T.MD]]}),a})();var A=o(58956),ie=o(73409),De=o(82584),je=o(50553),c=o(89777),Ne=o(8447),Le=o(62643),O=o(2175),M=o(8417),Be=o(34180),we=o(89336),Xe=o(33745);const Ae=a=>({number:a}),ae=a=>({repeatable:!0,listId:a}),Oe=(a,r,t)=>({itemsPerPage:a,currentPage:r,totalItems:t});function Ve(a,r){if(1&a){const t=e.RV6();e.j41(0,"div",6),e.bIt("click",function(){e.eBV(t),e.XpG();const i=e.sdS(1);return e.Njj(i.toggle("browse"))}),e.j41(1,"button",7),e.bIt("click",function(i){return e.eBV(t),e.Njj(i.preventDefault())}),e.EFF(2),e.nI1(3,"translate"),e.k0s()()}if(2&a){e.XpG();const t=e.sdS(1);e.R7$(),e.BMQ("aria-expanded",t.isExpanded("browse")),e.R7$(),e.SpI(" ",e.bMT(3,2,"admin.access-control.bulk-access-browse.header")," ")}}function Ue(a,r){if(1&a&&(e.j41(0,"div",14),e.nrm(1,"ds-search",15),e.k0s()),2&a){const t=e.XpG(2);e.R7$(),e.Y8G("configuration","administrativeBulkAccess")("selectable",!0)("selectionConfig",e.eq3(4,ae,t.listId))("showThumbnails",!1)}}function ze(a,r){if(1&a&&(e.j41(0,"li",18),e.nI1(1,"dsBrowserOnly"),e.nrm(2,"ds-selectable-list-item-control",19)(3,"ds-listable-object-component-loader",20),e.k0s()),2&a){const t=r.$implicit,n=r.$index,i=e.XpG(4);e.BMQ("data-test",e.bMT(1,9,"list-object")),e.R7$(2),e.Y8G("index",n)("object",t)("selectionConfig",e.eq3(11,ae,i.listId)),e.R7$(),e.Y8G("listID",i.listId)("index",n)("object",t)("showThumbnails",!1)("viewMode","list")}}function Je(a,r){if(1&a&&(e.j41(0,"ul",17),e.Z7z(1,ze,4,13,"li",18,e.fX1),e.nI1(3,"async"),e.nI1(4,"async"),e.nI1(5,"async"),e.nI1(6,"async"),e.nI1(7,"paginate"),e.k0s()),2&a){let t;const n=e.XpG(3);e.R7$(),e.Dyx(e.i5U(7,8,null==(t=e.bMT(3,0,n.objectsSelected$))||null==t.payload?null:t.payload.page,e.sMw(11,Oe,e.bMT(4,2,n.paginationOptions$).pageSize,e.bMT(5,4,n.paginationOptions$).currentPage,null==(t=e.bMT(6,6,n.objectsSelected$))||null==t.payload?null:t.payload.page.length)))}}function Ye(a,r){if(1&a){const t=e.RV6();e.j41(0,"ds-pagination",16),e.nI1(1,"async"),e.nI1(2,"async"),e.nI1(3,"async"),e.bIt("prev",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.pagePrev())})("next",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.pageNext())}),e.DNE(4,Je,8,15,"ul",17),e.nI1(5,"async"),e.k0s()}if(2&a){let t,n;const i=e.XpG(2);e.Y8G("paginationOptions",e.bMT(1,5,i.paginationOptions$))("collectionSize",null==(t=e.bMT(2,7,i.objectsSelected$))||null==t.payload?null:t.payload.totalElements)("objects",e.bMT(3,9,i.objectsSelected$))("showPaginator",!1),e.R7$(4),e.vxM(null!=(n=e.bMT(5,11,i.objectsSelected$))&&n.hasSucceeded?4:-1)}}function We(a,r){if(1&a){const t=e.RV6();e.j41(0,"div",8)(1,"ul",9,1),e.mxI("activeIdChange",function(i){e.eBV(t);const s=e.XpG();return e.DH7(s.activateId,i)||(s.activateId=i),e.Njj(i)}),e.j41(3,"li",10)(4,"a",11),e.EFF(5),e.nI1(6,"translate"),e.k0s(),e.DNE(7,Ue,2,6,"ng-template",12),e.k0s(),e.j41(8,"li",10)(9,"a",11),e.EFF(10),e.nI1(11,"async"),e.nI1(12,"async"),e.nI1(13,"translate"),e.k0s(),e.DNE(14,Ye,6,13,"ng-template",12),e.k0s()(),e.nrm(15,"div",13),e.k0s()}if(2&a){let t;const n=e.sdS(2),i=e.XpG();e.R7$(),e.R50("activeId",i.activateId),e.R7$(2),e.Y8G("ngbNavItem","search"),e.R7$(2),e.JRh(e.bMT(6,6,"admin.access-control.bulk-access-browse.search.header")),e.R7$(3),e.Y8G("ngbNavItem","selected"),e.R7$(2),e.SpI(" ",e.i5U(13,12,"admin.access-control.bulk-access-browse.selected.header",e.eq3(15,Ae,null!=(t=e.bMT(11,8,i.objectsSelected$))&&null!=t.payload&&t.payload.totalElements?null==(t=e.bMT(12,10,i.objectsSelected$))||null==t.payload?null:t.payload.totalElements:"0"))," "),e.R7$(5),e.Y8G("ngbNavOutlet",n)}}let Qe=(()=>{class a{constructor(t){this.selectableListService=t,this.activateId="search",this.objectsSelected$=new P.t(null),this.paginationOptions$=new P.t(Object.assign(new M.W,{id:"bas",pageSize:5,currentPage:1})),this.subs=[]}ngOnInit(){this.subs.push(this.selectableListService.getSelectableList(this.listId).pipe((0,Y.F)(),(0,g.T)(t=>this.generatePaginatedListBySelectedElements(t))).subscribe(this.objectsSelected$))}pageNext(){this.paginationOptions$.next(Object.assign(new M.W,this.paginationOptions$.value,{currentPage:this.paginationOptions$.value.currentPage+1}))}pagePrev(){this.paginationOptions$.next(Object.assign(new M.W,this.paginationOptions$.value,{currentPage:this.paginationOptions$.value.currentPage-1}))}calculatePageCount(t,n=0){return n<t?1:Math.ceil(n/t)}generatePaginatedListBySelectedElements(t){const n=new ie.Q({elementsPerPage:this.paginationOptions$.value.pageSize,totalElements:t?.selection.length,totalPages:this.calculatePageCount(this.paginationOptions$.value.pageSize,t?.selection.length),currentPage:this.paginationOptions$.value.currentPage});return n.currentPage>n.totalPages&&(n.currentPage=n.totalPages,this.paginationOptions$.next(Object.assign(new M.W,this.paginationOptions$.value,{currentPage:n.currentPage}))),(0,Be.SP)((0,A.g)(n,t?.selection||[]))}ngOnDestroy(){this.subs.filter(t=>(0,c.a4)(t)).forEach(t=>t.unsubscribe()),this.selectableListService.deselectAll(this.listId)}static{this.\u0275fac=function(n){return new(n||a)(e.rXU(G.K))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["ds-bulk-access-browse"]],inputs:{listId:"listId"},standalone:!0,features:[e.Jv_([{provide:je.EN,useClass:De.g}]),e.aNF],decls:5,vars:2,consts:[["acc","ngbAccordion"],["nav","ngbNav"],[3,"activeIds"],[3,"id"],["ngbPanelTitle",""],["ngbPanelContent",""],["data-test","browse",1,"w-100","d-flex","gap-3","justify-content-between","collapse-toggle",3,"click"],["type","button","aria-controls","bulk-access-browse-panel-content",1,"btn","btn-link","p-0",3,"click"],["id","bulk-access-browse-panel-content"],["ngbNav","",1,"nav-pills",3,"activeIdChange","activeId"],["role","presentation",3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[1,"mt-5",3,"ngbNavOutlet"],[1,"bulk-access-search"],[3,"configuration","selectable","selectionConfig","showThumbnails"],[3,"prev","next","paginationOptions","collectionSize","objects","showPaginator"],[1,"list-unstyled","ms-4"],[1,"mt-4","mb-4","d-flex"],[3,"index","object","selectionConfig"],[3,"listID","index","object","showThumbnails","viewMode"]],template:function(n,i){1&n&&(e.j41(0,"ngb-accordion",2,0)(2,"ngb-panel",3),e.DNE(3,Ve,4,4,"ng-template",4)(4,We,16,17,"ng-template",5),e.k0s()()),2&n&&(e.Y8G("activeIds","browse"),e.R7$(2),e.Y8G("id","browse"))},dependencies:[T.Jj,Xe.L,Ne.v,f._f,f.W1,f.CT,f.sb,f.t3,f.Pv,f.Um,f.X9,f.sy,f.Ri,f.m_,Me,Ge,O.e,Le.Y,we.N,d.h,d.D9],styles:[".bulk-access-search[_ngcontent-%COMP%]{margin-right:calc(var(--bs-gutter-x, 1.5rem) / -2);margin-left:calc(var(--bs-gutter-x, 1.5rem) / -2)}"]})}}return a})();var He=o(21200);const qe=["dsAccessControlForm"];function Ke(a,r){if(1&a){const t=e.RV6();e.j41(0,"div",6),e.bIt("click",function(){e.eBV(t),e.XpG();const i=e.sdS(1);return e.Njj(i.toggle("settings"))}),e.j41(1,"button",7),e.bIt("click",function(i){return e.eBV(t),e.Njj(i.preventDefault())}),e.EFF(2),e.nI1(3,"translate"),e.k0s()()}if(2&a){e.XpG();const t=e.sdS(1);e.R7$(),e.BMQ("aria-expanded",t.isExpanded("settings")),e.R7$(),e.SpI(" ",e.bMT(3,2,"admin.access-control.bulk-access-settings.header")," ")}}function Ze(a,r){1&a&&e.nrm(0,"ds-access-control-form-container",8,1),2&a&&e.Y8G("showSubmit",!1)}let et=(()=>{class a{getValue(){return this.controlForm.getFormValue()}reset(){this.controlForm.reset()}isFormValid(){return this.controlForm.isValid()}static{this.\u0275fac=function(n){return new(n||a)}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["ds-bulk-access-settings"]],viewQuery:function(n,i){if(1&n&&e.GBs(qe,5),2&n){let s;e.mGM(s=e.lsd())&&(i.controlForm=s.first)}},exportAs:["dsBulkSettings"],standalone:!0,features:[e.aNF],decls:5,vars:2,consts:[["acc","ngbAccordion"],["dsAccessControlForm",""],[3,"activeIds"],[3,"id"],["ngbPanelTitle",""],["ngbPanelContent",""],["ngbPanelToggle","","data-test","settings",1,"w-100","d-flex","gap-3","justify-content-between","collapse-toggle",3,"click"],["type","button","aria-controls","bulk-access-settings-panel-content",1,"btn","btn-link","p-0",3,"click"],["id","bulk-access-settings-panel-content",3,"showSubmit"]],template:function(n,i){1&n&&(e.j41(0,"ngb-accordion",2,0)(2,"ngb-panel",3),e.DNE(3,Ke,4,4,"ng-template",4)(4,Ze,2,1,"ng-template",5),e.k0s()()),2&n&&(e.Y8G("activeIds","settings"),e.R7$(2),e.Y8G("id","settings"))},dependencies:[He.o,f._f,f.W1,f.CT,f.sb,f.t3,d.h,d.D9]})}}return a})();const tt=["dsBulkSettings"];let nt=(()=>{class a{constructor(t,n){this.bulkAccessControlService=t,this.selectableListService=n,this.listId="bulk-access-list",this.objectsSelected$=new P.t([]),this.subs=[]}ngOnInit(){this.subs.push(this.selectableListService.getSelectableList(this.listId).pipe((0,Y.F)(),(0,g.T)(t=>this.generateIdListBySelectedElements(t))).subscribe(this.objectsSelected$))}canExport(){return this.objectsSelected$.value?.length>0&&this.settings?.isFormValid()}reset(){this.settings.reset()}submit(){const t=this.settings.getValue(),n=t.bitstream,i=t.item,{file:s}=this.bulkAccessControlService.createPayloadFile({bitstreamAccess:n,itemAccess:i,state:t.state});this.bulkAccessControlService.executeScript(this.objectsSelected$.value||[],s).subscribe()}generateIdListBySelectedElements(t){return t?.selection?.map(n=>n.indexableObject.uuid)}static{this.\u0275fac=function(n){return new(n||a)(e.rXU(te.r),e.rXU(G.K))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["ds-bulk-access"]],viewQuery:function(n,i){if(1&n&&e.GBs(tt,5),2&n){let s;e.mGM(s=e.lsd())&&(i.settings=s.first)}},standalone:!0,features:[e.aNF],decls:16,vars:11,consts:[["dsBulkSettings",""],[1,"container"],[3,"listId"],[1,"clearfix","mb-3"],[1,"d-flex","justify-content-end"],[1,"btn","btn-outline-primary","me-3",3,"click"],[1,"btn","btn-primary",3,"click","dsBtnDisabled"]],template:function(n,i){if(1&n){const s=e.RV6();e.j41(0,"div",1)(1,"h1"),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.nrm(4,"ds-bulk-access-browse",2)(5,"div",3)(6,"ds-bulk-access-settings",null,0)(8,"hr"),e.j41(9,"div",4)(10,"button",5),e.bIt("click",function(){return e.eBV(s),e.Njj(i.reset())}),e.EFF(11),e.nI1(12,"translate"),e.k0s(),e.j41(13,"button",6),e.bIt("click",function(){return e.eBV(s),e.Njj(i.submit())}),e.EFF(14),e.nI1(15,"translate"),e.k0s()()()}2&n&&(e.R7$(2),e.JRh(e.bMT(3,5,"admin.access-control.bulk-access.title")),e.R7$(2),e.Y8G("listId",i.listId),e.R7$(7),e.SpI(" ",e.bMT(12,7,"access-control-cancel")," "),e.R7$(2),e.Y8G("dsBtnDisabled",!i.canExport()),e.R7$(),e.SpI(" ",e.bMT(15,9,"access-control-execute")," "))},dependencies:[N.A,Qe,et,d.h,d.D9],changeDetection:0})}}return a})();var m=o(89417),R=o(7901),V=o(84572),I=o(25558),k=o(96697),U=o(43446),W=o(11873),L=o(6170),Q=o(3601),H=o(13817),it=o(23681),q=o(31),u=o(4093),K=o(3116),ee=o(15202),z=o(9847);const at=a=>({"table-primary":a}),se=a=>({name:a});function st(a,r){1&a&&e.nrm(0,"ds-loading")}function rt(a,r){if(1&a){const t=e.RV6();e.j41(0,"button",30),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,s=e.XpG(2);return e.Njj(s.deleteEPerson(i.eperson))}),e.nrm(2,"i",31),e.k0s()}if(2&a){const t=e.XpG().$implicit,n=e.XpG(2);e.FS9("title",e.i5U(1,1,n.labelPrefix+"table.edit.buttons.remove",e.eq3(4,se,n.dsoNameService.getName(t.eperson))))}}function ot(a,r){if(1&a&&(e.j41(0,"tr",25),e.nI1(1,"async"),e.j41(2,"td"),e.EFF(3),e.k0s(),e.j41(4,"td"),e.EFF(5),e.k0s(),e.j41(6,"td"),e.EFF(7),e.k0s(),e.j41(8,"td")(9,"div",26)(10,"button",27),e.nI1(11,"translate"),e.nrm(12,"i",28),e.k0s(),e.DNE(13,rt,3,6,"button",29),e.k0s()()()),2&a){const t=r.$implicit,n=e.XpG(2);e.Y8G("ngClass",e.eq3(12,at,e.bMT(1,7,n.activeEPerson$)===t.eperson)),e.R7$(3),e.JRh(t.eperson.id),e.R7$(2),e.JRh(n.dsoNameService.getName(t.eperson)),e.R7$(2),e.JRh(t.eperson.email),e.R7$(3),e.FS9("title",e.i5U(11,9,n.labelPrefix+"table.edit.buttons.edit",e.eq3(14,se,n.dsoNameService.getName(t.eperson)))),e.Y8G("routerLink",n.getEditEPeoplePage(t.eperson.id)),e.R7$(3),e.vxM(t.ableToDelete?13:-1)}}function lt(a,r){if(1&a&&(e.j41(0,"ds-pagination",20),e.nI1(1,"async"),e.j41(2,"div",22)(3,"table",23)(4,"thead")(5,"tr")(6,"th",24),e.EFF(7),e.nI1(8,"translate"),e.k0s(),e.j41(9,"th",24),e.EFF(10),e.nI1(11,"translate"),e.k0s(),e.j41(12,"th",24),e.EFF(13),e.nI1(14,"translate"),e.k0s(),e.j41(15,"th"),e.EFF(16),e.nI1(17,"translate"),e.k0s()()(),e.j41(18,"tbody"),e.Z7z(19,ot,14,16,"tr",25,e.fX1),e.nI1(21,"async"),e.k0s()()()()),2&a){let t,n;const i=e.XpG();e.Y8G("paginationOptions",i.config)("collectionSize",null==(t=e.bMT(1,8,i.pageInfoState$))?null:t.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),e.R7$(7),e.JRh(e.bMT(8,10,i.labelPrefix+"table.id")),e.R7$(3),e.JRh(e.bMT(11,12,i.labelPrefix+"table.name")),e.R7$(3),e.JRh(e.bMT(14,14,i.labelPrefix+"table.email")),e.R7$(3),e.JRh(e.bMT(17,16,i.labelPrefix+"table.edit")),e.R7$(3),e.Dyx(null==(n=e.bMT(21,18,i.ePeopleDto$))?null:n.page)}}function ct(a,r){if(1&a&&(e.j41(0,"div",21),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&a){const t=e.XpG();e.R7$(),e.SpI(" ",e.bMT(2,1,t.labelPrefix+"no-items")," ")}}let ut=(()=>{class a{constructor(t,n,i,s,l,p,h,S,x,v){this.epersonService=t,this.translateService=n,this.notificationsService=i,this.authorizationService=s,this.formBuilder=l,this.router=p,this.modalService=h,this.paginationService=S,this.requestService=x,this.dsoNameService=v,this.labelPrefix="admin.access-control.epeople.",this.ePeople$=new P.t((0,A.g)(new ie.Q,[])),this.ePeopleDto$=new P.t({}),this.pageInfoState$=new P.t(void 0),this.searching$=new P.t(!1),this.config=Object.assign(new M.W,{id:"elp",pageSize:5,currentPage:1}),this.subs=[],this.currentSearchQuery="",this.currentSearchScope="metadata",this.searchForm=this.formBuilder.group({scope:"metadata",query:""})}ngOnInit(){this.initialisePage()}initialisePage(){this.searching$.next(!0),this.search({scope:this.currentSearchScope,query:this.currentSearchQuery}),this.activeEPerson$=this.epersonService.getActiveEPerson(),this.subs.push(this.ePeople$.pipe((0,I.n)(t=>t.pageInfo.totalElements>0?(0,V.z)(t.page.map(n=>this.authorizationService.isAuthorized(L._.CanDelete,(0,c.a4)(n)?n.self:void 0).pipe((0,g.T)(i=>{const s=new it.h;return s.ableToDelete=i,s.eperson=n,s})))).pipe((0,g.T)(n=>(0,A.g)(t.pageInfo,n))):[t])).subscribe(t=>{this.searching$.next(!1),this.ePeopleDto$.next(t),this.pageInfoState$.next(t.pageInfo)}))}search(t){this.searching$.next(!0),(0,c.a4)(this.findListOptionsSub)&&this.findListOptionsSub.unsubscribe(),this.findListOptionsSub=this.paginationService.getCurrentPagination(this.config.id,this.config).pipe((0,I.n)(n=>{const i=t.query,s=t.scope;return null!=i&&this.currentSearchQuery!==i&&(this.router.navigate([(0,b.bL)()],{queryParamsHandling:"merge"}),this.currentSearchQuery=i,this.paginationService.resetPage(this.config.id)),null!=s&&this.currentSearchScope!==s&&(this.router.navigate([(0,b.bL)()],{queryParamsHandling:"merge"}),this.currentSearchScope=s,this.paginationService.resetPage(this.config.id)),this.epersonService.searchByScope(this.currentSearchScope,this.currentSearchQuery,{currentPage:n.currentPage,elementsPerPage:n.pageSize})}),(0,u.v7)()).subscribe(n=>{this.ePeople$.next(n.payload),this.pageInfoState$.next(n.payload.pageInfo)})}deleteEPerson(t){if((0,c.a4)(t.id)){const n=this.modalService.open(K.M);n.componentInstance.name=this.dsoNameService.getName(t),n.componentInstance.headerLabel="confirmation-modal.delete-eperson.header",n.componentInstance.infoLabel="confirmation-modal.delete-eperson.info",n.componentInstance.cancelLabel="confirmation-modal.delete-eperson.cancel",n.componentInstance.confirmLabel="confirmation-modal.delete-eperson.confirm",n.componentInstance.brandColor="danger",n.componentInstance.confirmIcon="fas fa-trash",n.componentInstance.response.pipe((0,k.s)(1)).subscribe(i=>{i&&(0,c.a4)(t.id)&&this.epersonService.deleteEPerson(t).pipe((0,u.qD)()).subscribe(s=>{s.hasSucceeded?this.notificationsService.success(this.translateService.get(this.labelPrefix+"notification.deleted.success",{name:this.dsoNameService.getName(t)})):this.notificationsService.error(this.translateService.get(this.labelPrefix+"notification.deleted.success",{id:t.id,statusCode:s.statusCode,errorMessage:s.errorMessage}))})})}}ngOnDestroy(){this.cleanupSubscribes(),this.paginationService.clearPagination(this.config.id)}cleanupSubscribes(){this.subs.filter(t=>(0,c.a4)(t)).forEach(t=>t.unsubscribe())}clearFormAndResetResult(){this.searchForm.patchValue({query:""}),this.search({query:""})}getEditEPeoplePage(t){return(0,b.Ax)(t)}static{this.\u0275fac=function(n){return new(n||a)(e.rXU(H.EPersonDataService),e.rXU(d.c$),e.rXU(z.I),e.rXU(W.AuthorizationDataService),e.rXU(m.ze),e.rXU(R.Ix),e.rXU(f.Bq),e.rXU(q.m),e.rXU(Q.B),e.rXU(U.f))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["ds-epeople-registry"]],standalone:!0,features:[e.aNF],decls:46,vars:40,consts:[[1,"container"],[1,"epeople-registry","row"],[1,"col-12"],[1,"d-flex","justify-content-between","border-bottom","mb-3"],["id","header",1,"pb-2"],[1,"me-auto","btn","btn-success","addEPerson-button",3,"routerLink"],[1,"fas","fa-plus"],[1,"d-none","d-sm-inline","ms-1"],["id","search",1,"border-bottom","pb-2"],[1,"d-flex","justify-content-between",3,"ngSubmit","formGroup"],["name","scope","id","scope","formControlName","scope","aria-label","Search scope",1,"form-select"],["value","metadata"],["value","email"],[1,"flex-grow-1","me-3","ms-3"],[1,"mb-3","input-group"],["type","text","name","query","id","query","formControlName","query",1,"form-control",3,"placeholder"],[1,"input-group-append"],["type","submit",1,"search-button","btn","btn-primary"],[1,"fas","fa-search"],[1,"search-button","btn","btn-secondary",3,"click"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage"],["role","alert",1,"alert","alert-info","w-100","mb-2"],[1,"table-responsive"],["id","epeople",1,"table","table-striped","table-hover","table-bordered"],["scope","col"],[3,"ngClass"],[1,"btn-group","edit-field"],[1,"btn","btn-outline-primary","btn-sm","access-control-editEPersonButton",3,"routerLink","title"],[1,"fas","fa-edit","fa-fw"],[1,"delete-button","btn","btn-outline-danger","btn-sm","access-control-deleteEPersonButton",3,"title"],[1,"delete-button","btn","btn-outline-danger","btn-sm","access-control-deleteEPersonButton",3,"click","title"],[1,"fas","fa-trash-alt","fa-fw"]],template:function(n,i){if(1&n&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1",4),e.EFF(5),e.nI1(6,"translate"),e.k0s(),e.j41(7,"div")(8,"button",5),e.nrm(9,"i",6),e.j41(10,"span",7),e.EFF(11),e.nI1(12,"translate"),e.k0s()()()(),e.j41(13,"h2",8),e.EFF(14),e.nI1(15,"translate"),e.k0s(),e.j41(16,"form",9),e.bIt("ngSubmit",function(){return i.search(i.searchForm.value)}),e.j41(17,"div")(18,"select",10)(19,"option",11),e.EFF(20),e.nI1(21,"translate"),e.k0s(),e.j41(22,"option",12),e.EFF(23),e.nI1(24,"translate"),e.k0s()()(),e.j41(25,"div",13)(26,"div",14),e.nrm(27,"input",15),e.nI1(28,"translate"),e.nI1(29,"translate"),e.j41(30,"span",16)(31,"button",17),e.nrm(32,"i",18),e.EFF(33),e.nI1(34,"translate"),e.k0s()()()(),e.j41(35,"div")(36,"button",19),e.bIt("click",function(){return i.clearFormAndResetResult()}),e.EFF(37),e.nI1(38,"translate"),e.k0s()()(),e.DNE(39,st,1,0,"ds-loading"),e.nI1(40,"async"),e.DNE(41,lt,22,20,"ds-pagination",20),e.nI1(42,"async"),e.nI1(43,"async"),e.DNE(44,ct,3,3,"div",21),e.nI1(45,"async"),e.k0s()()()),2&n){let s,l;e.R7$(5),e.JRh(e.bMT(6,14,i.labelPrefix+"head")),e.R7$(3),e.Y8G("routerLink","create"),e.R7$(3),e.JRh(e.bMT(12,16,i.labelPrefix+"button.add")),e.R7$(3),e.SpI(" ",e.bMT(15,18,i.labelPrefix+"search.head")," "),e.R7$(2),e.Y8G("formGroup",i.searchForm),e.R7$(4),e.JRh(e.bMT(21,20,i.labelPrefix+"search.scope.metadata")),e.R7$(3),e.JRh(e.bMT(24,22,i.labelPrefix+"search.scope.email")),e.R7$(4),e.Y8G("placeholder",e.bMT(28,24,i.labelPrefix+"search.placeholder")),e.BMQ("aria-label",e.bMT(29,26,i.labelPrefix+"search.placeholder")),e.R7$(6),e.SpI(" ",e.bMT(34,28,i.labelPrefix+"search.button")," "),e.R7$(4),e.JRh(e.bMT(38,30,i.labelPrefix+"button.see-all")),e.R7$(2),e.vxM(e.bMT(40,32,i.searching$)?39:-1),e.R7$(2),e.vxM((null==(s=e.bMT(42,34,i.pageInfoState$))?null:s.totalElements)>0&&!0!==e.bMT(43,36,i.searching$)?41:-1),e.R7$(3),e.vxM(0===(null==(l=e.bMT(45,38,i.pageInfoState$))?null:l.totalElements)?44:-1)}},dependencies:[T.Jj,T.YU,O.e,m.X1,m.qT,m.xH,m.y7,m.me,m.wz,m.BC,m.cb,m.j4,m.JD,R.iI,R.Wk,ee.v,d.h,d.D9],encapsulation:2})}}return a})();var E=o(7673),re=o(70152),pt=o(70980),dt=o(94196),mt=o(13260),Z=o(2086),oe=o(89253),gt=o(19532),le=o(49838),ce=o(86332),D=o(4600),ht=o(95038);class ft{static createValidator(r){return t=>r.getEPersonByEmail(t.value).pipe((0,u.yd)(),(0,g.T)(n=>n.payload?{emailTaken:!0}:null))}}const ue=a=>[a];function bt(a,r){if(1&a&&(e.j41(0,"h1",3),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&a){const t=e.XpG();e.R7$(),e.JRh(e.bMT(2,1,t.messagePrefix+".edit"))}}function vt(a,r){if(1&a&&(e.j41(0,"h1",3),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&a){const t=e.XpG();e.R7$(),e.JRh(e.bMT(2,1,t.messagePrefix+".create"))}}function _t(a,r){if(1&a){const t=e.RV6();e.j41(0,"div",8)(1,"button",11),e.nI1(2,"async"),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.resetPassword())}),e.nrm(3,"i",12),e.EFF(4),e.nI1(5,"translate"),e.k0s()()}if(2&a){const t=e.XpG();e.R7$(),e.Y8G("dsBtnDisabled",!0!==e.bMT(2,2,t.canReset$)),e.R7$(3),e.SpI(" ",e.bMT(5,4,"admin.access-control.epeople.actions.reset")," ")}}function St(a,r){if(1&a){const t=e.RV6();e.j41(0,"button",14),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.impersonate())}),e.nrm(1,"i",15),e.EFF(2),e.nI1(3,"translate"),e.k0s()}2&a&&(e.R7$(2),e.SpI(" ",e.bMT(3,1,"admin.access-control.epeople.actions.impersonate")," "))}function Pt(a,r){if(1&a){const t=e.RV6();e.j41(0,"button",14),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.stopImpersonating())}),e.nrm(1,"i",15),e.EFF(2),e.nI1(3,"translate"),e.k0s()}2&a&&(e.R7$(2),e.SpI(" ",e.bMT(3,1,"admin.access-control.epeople.actions.stop-impersonating")," "))}function It(a,r){if(1&a&&(e.j41(0,"div",8),e.DNE(1,St,4,3,"button",13)(2,Pt,4,3,"button",13),e.k0s()),2&a){const t=e.XpG();e.R7$(),e.vxM(t.isImpersonated?-1:1),e.R7$(),e.vxM(t.isImpersonated?2:-1)}}function Ct(a,r){if(1&a){const t=e.RV6();e.j41(0,"button",16),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.delete())}),e.nrm(1,"i",17),e.EFF(2),e.nI1(3,"translate"),e.k0s()}2&a&&(e.R7$(2),e.SpI(" ",e.bMT(3,1,"admin.access-control.epeople.actions.delete")," "))}function yt(a,r){1&a&&e.nrm(0,"ds-loading",10),2&a&&e.Y8G("showMessage",!1)}function xt(a,r){1&a&&e.nrm(0,"ds-loading",10),2&a&&e.Y8G("showMessage",!1)}function Rt(a,r){if(1&a){const t=e.RV6();e.j41(0,"tr")(1,"td",24),e.EFF(2),e.k0s(),e.j41(3,"td",24)(4,"a",25),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG(3);return e.Njj(s.groupsDataService.startEditingNewGroup(i))}),e.EFF(5),e.k0s()(),e.j41(6,"td",24),e.EFF(7),e.nI1(8,"async"),e.k0s()()}if(2&a){let t;const n=r.$implicit,i=e.XpG(3);e.R7$(2),e.JRh(n.id),e.R7$(2),e.Y8G("routerLink",e.eq3(6,ue,i.groupsDataService.getGroupEditPageRouterLink(n))),e.R7$(),e.SpI(" ",i.dsoNameService.getName(n)," "),e.R7$(2),e.SpI(" ",i.dsoNameService.getName(null==(t=e.bMT(8,4,n.object))?null:t.payload)," ")}}function Et(a,r){if(1&a){const t=e.RV6();e.j41(0,"ds-pagination",20),e.nI1(1,"async"),e.bIt("pageChange",function(i){e.eBV(t);const s=e.XpG(2);return e.Njj(s.onPageChange(i))}),e.j41(2,"div",21)(3,"table",22)(4,"thead")(5,"tr")(6,"th",23),e.EFF(7),e.nI1(8,"translate"),e.k0s(),e.j41(9,"th",23),e.EFF(10),e.nI1(11,"translate"),e.k0s(),e.j41(12,"th",23),e.EFF(13),e.nI1(14,"translate"),e.k0s()()(),e.j41(15,"tbody"),e.Z7z(16,Rt,9,8,"tr",null,e.fX1),e.nI1(18,"async"),e.k0s()()()()}if(2&a){let t,n;const i=e.XpG(2);e.Y8G("paginationOptions",i.config)("collectionSize",null==(t=e.bMT(1,7,i.groups$))||null==t.payload?null:t.payload.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),e.R7$(7),e.JRh(e.bMT(8,9,i.messagePrefix+".table.id")),e.R7$(3),e.JRh(e.bMT(11,11,i.messagePrefix+".table.name")),e.R7$(3),e.JRh(e.bMT(14,13,i.messagePrefix+".table.collectionOrCommunity")),e.R7$(3),e.Dyx(null==(n=e.bMT(18,15,i.groups$))||null==n.payload?null:n.payload.page)}}function Ft(a,r){if(1&a&&(e.j41(0,"div",19)(1,"div"),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"div")(5,"button",26),e.EFF(6),e.nI1(7,"translate"),e.k0s()()()),2&a){const t=e.XpG(2);e.R7$(2),e.JRh(e.bMT(3,3,t.messagePrefix+".memberOfNoGroups")),e.R7$(3),e.Y8G("routerLink",e.eq3(7,ue,t.groupsDataService.getGroupRegistryRouterLink())),e.R7$(),e.JRh(e.bMT(7,5,t.messagePrefix+".goToGroups"))}}function $t(a,r){if(1&a&&(e.j41(0,"div")(1,"h2"),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.DNE(4,xt,1,1,"ds-loading",10),e.nI1(5,"async"),e.nI1(6,"dsHasNoValue"),e.DNE(7,Et,19,17,"ds-pagination",18),e.nI1(8,"async"),e.DNE(9,Ft,8,9,"div",19),e.nI1(10,"async"),e.k0s()),2&a){let t,n;const i=e.XpG();e.R7$(2),e.JRh(e.bMT(3,4,i.messagePrefix+".groupsEPersonIsMemberOf")),e.R7$(2),e.vxM(e.bMT(6,8,e.bMT(5,6,i.groups$))?4:-1),e.R7$(3),e.vxM((null==(t=e.bMT(8,10,i.groups$))||null==t.payload?null:t.payload.totalElements)>0?7:-1),e.R7$(2),e.vxM(0===(null==(n=e.bMT(10,12,i.groups$))||null==n.payload?null:n.payload.totalElements)?9:-1)}}let pe=(()=>{class a{constructor(t,n,i,s,l,p,h,S,x,v,j,X,_e,Se,Pe){this.changeDetectorRef=t,this.epersonService=n,this.groupsDataService=i,this.formBuilderService=s,this.translateService=l,this.notificationsService=p,this.authService=h,this.authorizationService=S,this.modalService=x,this.paginationService=v,this.requestService=j,this.epersonRegistrationService=X,this.dsoNameService=_e,this.route=Se,this.router=Pe,this.labelPrefix="admin.access-control.epeople.form.",this.formId="eperson-form",this.messagePrefix="admin.access-control.epeople.form",this.formLayout={firstName:{grid:{host:"row"}},lastName:{grid:{host:"row"}},email:{grid:{host:"row"}},canLogIn:{grid:{host:"col col-sm-6 d-inline-block"}},requireCertificate:{grid:{host:"col col-sm-6 d-inline-block"}}},this.submitForm=new e.bkB,this.cancelForm=new e.bkB,this.subs=[],this.config=Object.assign(new M.W,{id:"gem",pageSize:5,currentPage:1}),this.isImpersonated=!1,this.displayResetPassword=!1,this.submitLabel="form.create"}ngOnInit(){this.activeEPerson$=this.epersonService.getActiveEPerson(),this.subs.push(this.activeEPerson$.subscribe(t=>{this.epersonInitial=t,(0,c.a4)(t)&&(this.isImpersonated=this.authService.isImpersonatingUser(t.id),this.displayResetPassword=!0,this.submitLabel="form.submit")})),this.initialisePage()}initialisePage(){this.route.snapshot.params.id&&this.subs.push(this.epersonService.findById(this.route.snapshot.params.id).subscribe(t=>{this.epersonService.editEPerson(t.payload)})),this.firstName=new _.rA_({id:"firstName",label:this.translateService.instant(`${this.messagePrefix}.firstName`),name:"firstName",validators:{required:null},required:!0}),this.lastName=new _.rA_({id:"lastName",label:this.translateService.instant(`${this.messagePrefix}.lastName`),name:"lastName",validators:{required:null},required:!0}),this.email=new _.rA_({id:"email",label:this.translateService.instant(`${this.messagePrefix}.email`),name:"email",validators:{required:null,pattern:"^[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}$"},required:!0,errorMessages:{emailTaken:"error.validation.emailTaken",pattern:"error.validation.NotValidEmail"},hint:this.translateService.instant(`${this.messagePrefix}.emailHint`)}),this.canLogIn=new _.M7d({id:"canLogIn",label:this.translateService.instant(`${this.messagePrefix}.canLogIn`),name:"canLogIn",value:null==this.epersonInitial||this.epersonInitial.canLogIn}),this.requireCertificate=new _.M7d({id:"requireCertificate",label:this.translateService.instant(`${this.messagePrefix}.requireCertificate`),name:"requireCertificate",value:null!=this.epersonInitial&&this.epersonInitial.requireCertificate}),this.formModel=[this.firstName,this.lastName,this.email,this.canLogIn,this.requireCertificate],this.formGroup=this.formBuilderService.createFormGroup(this.formModel),this.subs.push(this.activeEPerson$.subscribe(t=>{null!=t&&(this.groups$=this.groupsDataService.findListByHref(t._links.groups.href,{currentPage:1,elementsPerPage:this.config.pageSize},void 0,void 0,(0,D.s)("object"))),this.formGroup.patchValue({firstName:null!=t?t.firstMetadataValue("eperson.firstname"):"",lastName:null!=t?t.firstMetadataValue("eperson.lastname"):"",email:null!=t?t.email:"",canLogIn:null==t||t.canLogIn,requireCertificate:null!=t&&t.requireCertificate}),null===t&&this.formGroup.controls.email&&(this.formGroup.controls.email.setAsyncValidators(ft.createValidator(this.epersonService)),this.emailValueChangeSubscribe=this.email.valueChanges.pipe((0,re.B)(300)).subscribe(()=>{this.changeDetectorRef.detectChanges()}))})),this.groups$=this.activeEPerson$.pipe((0,I.n)(t=>(0,V.z)([(0,E.of)(t),this.paginationService.getFindListOptions(this.config.id,{currentPage:1,elementsPerPage:this.config.pageSize})])),(0,I.n)(([t,n])=>null!=t?this.groupsDataService.findListByHref(t._links.groups.href,n,!0,!0,(0,D.s)("object")):(0,E.of)(void 0))),this.groupsPageInfoState$=this.groups$.pipe((0,g.T)(t=>t.payload.pageInfo)),this.canImpersonate$=this.activeEPerson$.pipe((0,I.n)(t=>(0,c.a4)(t)?this.authorizationService.isAuthorized(L._.LoginOnBehalfOf,t.self):(0,E.of)(!1))),this.canDelete$=this.activeEPerson$.pipe((0,I.n)(t=>this.authorizationService.isAuthorized(L._.CanDelete,(0,c.a4)(t)?t.self:void 0))),this.canReset$=(0,E.of)(!0)}onCancel(){this.epersonService.cancelEditEPerson(),this.cancelForm.emit(),this.router.navigate([(0,b.bL)()])}onSubmit(){this.activeEPerson$.pipe((0,k.s)(1)).subscribe(t=>{const n={metadata:{"eperson.firstname":[{value:this.firstName.value}],"eperson.lastname":[{value:this.lastName.value}]},email:this.email.value,canLogIn:this.canLogIn.value,requireCertificate:this.requireCertificate.value};null==t?this.createNewEPerson(n):this.editEPerson(t,n)})}createNewEPerson(t){const n=Object.assign(new oe.f,t);this.epersonService.create(n).pipe((0,u.qD)()).subscribe(s=>{s.hasSucceeded?(this.notificationsService.success(this.translateService.get(this.labelPrefix+"notification.created.success",{name:this.dsoNameService.getName(n)})),this.submitForm.emit(n),this.epersonService.clearEPersonRequests(),this.router.navigateByUrl((0,b.bL)())):(this.notificationsService.error(this.translateService.get(this.labelPrefix+"notification.created.failure",{name:this.dsoNameService.getName(n)})),this.cancelForm.emit())}),this.showNotificationIfEmailInUse(n,"created")}editEPerson(t,n){const i=Object.assign(new oe.f,{id:t.id,metadata:{"eperson.firstname":[{value:this.firstName.value?this.firstName.value:t.firstMetadataValue("eperson.firstname")}],"eperson.lastname":[{value:this.lastName.value?this.lastName.value:t.firstMetadataValue("eperson.lastname")}]},email:(0,c.a4)(n.email)?n.email:t.email,canLogIn:(0,c.a4)(n.canLogIn)?n.canLogIn:t.canLogIn,requireCertificate:(0,c.a4)(n.requireCertificate)?n.requireCertificate:t.requireCertificate,_links:t._links});this.epersonService.updateEPerson(i).pipe((0,u.qD)()).subscribe(l=>{l.hasSucceeded?(this.notificationsService.success(this.translateService.get(this.labelPrefix+"notification.edited.success",{name:this.dsoNameService.getName(i)})),this.submitForm.emit(i),this.router.navigateByUrl((0,b.bL)())):(this.notificationsService.error(this.translateService.get(this.labelPrefix+"notification.edited.failure",{name:this.dsoNameService.getName(i)})),this.cancelForm.emit())}),null!=n.email&&n.email!==t.email&&this.showNotificationIfEmailInUse(i,"edited")}onPageChange(t){this.updateGroups({currentPage:t,elementsPerPage:this.config.pageSize})}impersonate(){this.authService.impersonate(this.epersonInitial.id),this.isImpersonated=!0}delete(){this.activeEPerson$.pipe((0,k.s)(1),(0,I.n)(t=>{const n=this.modalService.open(K.M);return n.componentInstance.name=this.dsoNameService.getName(t),n.componentInstance.headerLabel="confirmation-modal.delete-eperson.header",n.componentInstance.infoLabel="confirmation-modal.delete-eperson.info",n.componentInstance.cancelLabel="confirmation-modal.delete-eperson.cancel",n.componentInstance.confirmLabel="confirmation-modal.delete-eperson.confirm",n.componentInstance.brandColor="danger",n.componentInstance.confirmIcon="fas fa-trash",n.componentInstance.response.pipe((0,k.s)(1),(0,I.n)(i=>i&&(0,c.a4)(t.id)?(this.canDelete$=(0,E.of)(!1),this.epersonService.deleteEPerson(t).pipe((0,u.qD)(),(0,g.T)(s=>({restResponse:s,eperson:t})))):(0,E.of)(null)),(0,pt.j)(()=>this.canDelete$=(0,E.of)(!0)))})).subscribe(({restResponse:t,eperson:n})=>{t?.hasSucceeded?(this.notificationsService.success(this.translateService.get(this.labelPrefix+"notification.deleted.success",{name:this.dsoNameService.getName(n)})),this.router.navigate([(0,b.bL)()])):this.notificationsService.error(`Error occurred when trying to delete EPerson with id: ${n?.id} with code: ${t?.statusCode} and message: ${t?.errorMessage}`),this.cancelForm.emit()})}stopImpersonating(){this.authService.stopImpersonatingAndRefresh(),this.isImpersonated=!1}resetPassword(){(0,c.a4)(this.epersonInitial.email)&&this.epersonRegistrationService.registerEmail(this.epersonInitial.email,null,gt.TYPE_REQUEST_FORGOT).pipe((0,u.qD)()).subscribe(t=>{t.hasSucceeded?this.notificationsService.success(this.translateService.get("admin.access-control.epeople.actions.reset"),this.translateService.get("forgot-email.form.success.content",{email:this.epersonInitial.email})):this.notificationsService.error(this.translateService.get("forgot-email.form.error.head"),this.translateService.get("forgot-email.form.error.content",{email:this.epersonInitial.email}))})}ngOnDestroy(){this.subs.filter(t=>(0,c.a4)(t)).forEach(t=>t.unsubscribe()),this.paginationService.clearPagination(this.config.id),(0,c.a4)(this.emailValueChangeSubscribe)&&this.emailValueChangeSubscribe.unsubscribe()}showNotificationIfEmailInUse(t,n){this.subs.push(this.epersonService.searchByScope("email",t.email,{currentPage:1,elementsPerPage:0}).pipe((0,u.yd)(),(0,u.Bo)()).subscribe(i=>{i.totalElements>0&&this.notificationsService.error(this.translateService.get(this.labelPrefix+"notification."+n+".failure.emailInUse",{name:this.dsoNameService.getName(t),email:t.email}))}))}updateGroups(t){this.subs.push(this.activeEPerson$.subscribe(n=>{this.groups$=this.groupsDataService.findListByHref(n._links.groups.href,t)}))}static{this.\u0275fac=function(n){return new(n||a)(e.rXU(e.gRc),e.rXU(H.EPersonDataService),e.rXU(Z.GroupDataService),e.rXU(le.j),e.rXU(d.c$),e.rXU(z.I),e.rXU(dt.uR),e.rXU(W.AuthorizationDataService),e.rXU(f.Bq),e.rXU(q.m),e.rXU(Q.B),e.rXU(mt.f),e.rXU(U.f),e.rXU(R.nX),e.rXU(R.Ix))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["ds-eperson-form"]],outputs:{submitForm:"submitForm",cancelForm:"cancelForm"},standalone:!0,features:[e.aNF],decls:20,vars:23,consts:[[1,"container"],[1,"group-form","row"],[1,"col-12"],[1,"border-bottom","pb-2"],[3,"submitForm","formId","formModel","formGroup","formLayout","displayCancel","submitLabel"],["before","",1,"btn-group"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"fas","fa-arrow-left"],["between","",1,"btn-group"],["after","","type","button",1,"btn","btn-danger","delete-button"],[3,"showMessage"],["type","button",1,"btn","btn-primary",3,"click","dsBtnDisabled"],[1,"fa","fa-key"],["type","button",1,"btn","btn-primary"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fa","fa-user-secret"],["after","","type","button",1,"btn","btn-danger","delete-button",3,"click"],[1,"fas","fa-trash"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage"],["role","alert",1,"alert","alert-info","w-100","mb-2"],[3,"pageChange","paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage"],[1,"table-responsive"],["id","groups",1,"table","table-striped","table-hover","table-bordered"],["scope","col",1,"align-middle"],[1,"align-middle"],[3,"click","routerLink"],[1,"btn","btn-primary",3,"routerLink"]],template:function(n,i){1&n&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2),e.DNE(3,bt,3,3,"h1",3),e.nI1(4,"async"),e.DNE(5,vt,3,3,"h1",3),e.j41(6,"ds-form",4),e.bIt("submitForm",function(){return i.onSubmit()}),e.j41(7,"div",5)(8,"button",6),e.bIt("click",function(){return i.onCancel()}),e.nrm(9,"i",7),e.EFF(10),e.nI1(11,"translate"),e.k0s()(),e.DNE(12,_t,6,6,"div",8)(13,It,3,2,"div",8),e.nI1(14,"async"),e.DNE(15,Ct,4,3,"button",9),e.nI1(16,"async"),e.k0s(),e.DNE(17,yt,1,1,"ds-loading",10)(18,$t,11,14,"div"),e.nI1(19,"async"),e.k0s()()()),2&n&&(e.R7$(3),e.vxM(e.bMT(4,13,i.activeEPerson$)?3:5),e.R7$(3),e.Y8G("formId",i.formId)("formModel",i.formModel)("formGroup",i.formGroup)("formLayout",i.formLayout)("displayCancel",!1)("submitLabel",i.submitLabel),e.R7$(4),e.SpI(" ",e.bMT(11,15,i.messagePrefix+".return")," "),e.R7$(2),e.vxM(i.displayResetPassword?12:-1),e.R7$(),e.vxM(e.bMT(14,17,i.canImpersonate$)?13:-1),e.R7$(2),e.vxM(e.bMT(16,19,i.canDelete$)?15:-1),e.R7$(2),e.vxM(i.formGroup?-1:17),e.R7$(),e.vxM(e.bMT(19,21,i.activeEPerson$)?18:-1))},dependencies:[T.Jj,N.A,ce.s,ht.n,O.e,R.Wk,ee.v,d.h,d.D9],encapsulation:2})}}return a})();var Tt=o(10817),kt=o(59640);const Gt=[(0,D.s)("groups")];let Mt=(()=>{class a{constructor(t,n){this.ePersonService=t,this.store=n}resolve(t,n){const i=this.ePersonService.findById(t.params.id,!0,!1,...Gt).pipe((0,u.qD)());return i.subscribe(s=>{this.store.dispatch(new Tt.j(n.url,s.payload))}),i}static{this.\u0275fac=function(n){return new(n||a)(e.KVO(H.EPersonDataService),e.KVO(kt.il))}}static{this.\u0275prov=e.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();var Dt=o(78544),jt=o(47067),Nt=o(39015),de=o(98733),Lt=o(49340),Bt=o(48145),wt=o(10406),Xt=o(64972),At=o(74082),me=o(32413),Ot=o(68164);const Vt=()=>["top","right","bottom"],Ut=a=>({content:"admin.access-control.groups.form.tooltip.editGroup.addSubgroups",id:"edit-group-add-subgroups",iconPlacement:"right",tooltipPlacement:a}),ge=a=>[a],he=a=>({name:a});function zt(a,r){if(1&a){const t=e.RV6();e.j41(0,"tr")(1,"td",16),e.EFF(2),e.k0s(),e.j41(3,"td",16)(4,"a",17),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.groupDataService.startEditingNewGroup(i))}),e.EFF(5),e.k0s()(),e.j41(6,"td",16),e.EFF(7),e.nI1(8,"async"),e.k0s(),e.j41(9,"td",16)(10,"div",18)(11,"button",19),e.nI1(12,"translate"),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.deleteSubgroupFromGroup(i))}),e.nrm(13,"i",20),e.k0s()()()()}if(2&a){let t;const n=r.$implicit,i=e.XpG(2);e.R7$(2),e.JRh(n.id),e.R7$(2),e.Y8G("routerLink",e.eq3(10,ge,i.groupDataService.getGroupEditPageRouterLink(n))),e.R7$(),e.SpI(" ",i.dsoNameService.getName(n)," "),e.R7$(2),e.JRh(i.dsoNameService.getName(null==(t=e.bMT(8,5,n.object))?null:t.payload)),e.R7$(4),e.FS9("title",e.i5U(12,7,i.messagePrefix+".table.edit.buttons.remove",e.eq3(12,he,i.dsoNameService.getName(n))))}}function Jt(a,r){if(1&a&&(e.j41(0,"ds-pagination",1),e.nI1(1,"async"),e.j41(2,"div",13)(3,"table",14)(4,"thead")(5,"tr")(6,"th",15),e.EFF(7),e.nI1(8,"translate"),e.k0s(),e.j41(9,"th",15),e.EFF(10),e.nI1(11,"translate"),e.k0s(),e.j41(12,"th",15),e.EFF(13),e.nI1(14,"translate"),e.k0s(),e.j41(15,"th"),e.EFF(16),e.nI1(17,"translate"),e.k0s()()(),e.j41(18,"tbody"),e.Z7z(19,zt,14,14,"tr",null,e.fX1),e.nI1(21,"async"),e.k0s()()()()),2&a){let t,n;const i=e.XpG();e.Y8G("paginationOptions",i.config)("collectionSize",null==(t=e.bMT(1,8,i.subGroups$))||null==t.payload?null:t.payload.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),e.R7$(7),e.JRh(e.bMT(8,10,i.messagePrefix+".table.id")),e.R7$(3),e.JRh(e.bMT(11,12,i.messagePrefix+".table.name")),e.R7$(3),e.JRh(e.bMT(14,14,i.messagePrefix+".table.collectionOrCommunity")),e.R7$(3),e.JRh(e.bMT(17,16,i.messagePrefix+".table.edit")),e.R7$(3),e.Dyx(null==(n=e.bMT(21,18,i.subGroups$))||null==n.payload?null:n.payload.page)}}function Yt(a,r){if(1&a&&(e.j41(0,"div",2),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&a){const t=e.XpG();e.R7$(),e.SpI(" ",e.bMT(2,1,t.messagePrefix+".no-subgroups-yet")," ")}}function Wt(a,r){if(1&a&&(e.j41(0,"span"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&a){const t=e.XpG();e.R7$(),e.SpI(" ",e.bMT(2,1,t.messagePrefix+".search.head")," ")}}function Qt(a,r){if(1&a){const t=e.RV6();e.j41(0,"tr")(1,"td",16),e.EFF(2),e.k0s(),e.j41(3,"td",16)(4,"a",17),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.groupDataService.startEditingNewGroup(i))}),e.EFF(5),e.k0s()(),e.j41(6,"td",16),e.EFF(7),e.nI1(8,"async"),e.k0s(),e.j41(9,"td",16)(10,"div",18)(11,"button",22),e.nI1(12,"translate"),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.addSubgroupToGroup(i))}),e.nrm(13,"i",23),e.k0s()()()()}if(2&a){let t;const n=r.$implicit,i=e.XpG(2);e.R7$(2),e.JRh(n.id),e.R7$(2),e.Y8G("routerLink",e.eq3(10,ge,i.groupDataService.getGroupEditPageRouterLink(n))),e.R7$(),e.SpI(" ",i.dsoNameService.getName(n)," "),e.R7$(2),e.JRh(i.dsoNameService.getName(null==(t=e.bMT(8,5,n.object))?null:t.payload)),e.R7$(4),e.FS9("title",e.i5U(12,7,i.messagePrefix+".table.edit.buttons.add",e.eq3(12,he,i.dsoNameService.getName(n))))}}function Ht(a,r){if(1&a&&(e.j41(0,"ds-pagination",1),e.nI1(1,"async"),e.j41(2,"div",13)(3,"table",21)(4,"thead")(5,"tr")(6,"th",15),e.EFF(7),e.nI1(8,"translate"),e.k0s(),e.j41(9,"th",15),e.EFF(10),e.nI1(11,"translate"),e.k0s(),e.j41(12,"th",15),e.EFF(13),e.nI1(14,"translate"),e.k0s(),e.j41(15,"th",16),e.EFF(16),e.nI1(17,"translate"),e.k0s()()(),e.j41(18,"tbody"),e.Z7z(19,Qt,14,14,"tr",null,e.fX1),e.nI1(21,"async"),e.k0s()()()()),2&a){let t,n;const i=e.XpG();e.Y8G("paginationOptions",i.configSearch)("collectionSize",null==(t=e.bMT(1,8,i.searchResults$))||null==t.payload?null:t.payload.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),e.R7$(7),e.JRh(e.bMT(8,10,i.messagePrefix+".table.id")),e.R7$(3),e.JRh(e.bMT(11,12,i.messagePrefix+".table.name")),e.R7$(3),e.JRh(e.bMT(14,14,i.messagePrefix+".table.collectionOrCommunity")),e.R7$(3),e.JRh(e.bMT(17,16,i.messagePrefix+".table.edit")),e.R7$(3),e.Dyx(null==(n=e.bMT(21,18,i.searchResults$))||null==n.payload?null:n.payload.page)}}function qt(a,r){if(1&a&&(e.j41(0,"div",2),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&a){const t=e.XpG();e.R7$(),e.SpI(" ",e.bMT(2,1,t.messagePrefix+".no-items")," ")}}var B=function(a){return a[a.Members=0]="Members",a[a.ActiveGroup=1]="ActiveGroup",a[a.SearchResults=2]="SearchResults",a}(B||{});let Kt=(()=>{class a{constructor(t,n,i,s,l,p,h){this.groupDataService=t,this.translateService=n,this.notificationsService=i,this.formBuilder=s,this.paginationService=l,this.router=p,this.dsoNameService=h,this.searchResults$=new P.t(void 0),this.subGroups$=new P.t(void 0),this.subs=new Map,this.configSearch=Object.assign(new M.W,{id:"ssgl",pageSize:5,currentPage:1}),this.config=Object.assign(new M.W,{id:"sgl",pageSize:5,currentPage:1}),this.currentSearchQuery=""}ngOnInit(){this.searchForm=this.formBuilder.group({query:""}),this.subs.set(B.ActiveGroup,this.groupDataService.getActiveGroup().subscribe(t=>{null!=t&&(this.groupBeingEdited=t,this.retrieveSubGroups(),this.search({query:""}))})),this.subGroupsPageInfoState$=this.subGroups$.pipe((0,g.T)(t=>t?.payload?.pageInfo))}retrieveSubGroups(){this.unsubFrom(B.Members),this.subs.set(B.Members,this.paginationService.getCurrentPagination(this.config.id,this.config).pipe((0,I.n)(t=>this.groupDataService.findListByHref(this.groupBeingEdited._links.subgroups.href,{currentPage:t.currentPage,elementsPerPage:t.pageSize},!0,!0,(0,D.s)("object")))).subscribe(t=>{this.subGroups$.next(t)}))}deleteSubgroupFromGroup(t){this.groupDataService.getActiveGroup().pipe((0,k.s)(1)).subscribe(n=>{if(null!=n){const i=this.groupDataService.deleteSubGroupFromGroup(n,t);this.showNotifications("deleteSubgroup",i,this.dsoNameService.getName(t),n),null!=this.currentSearchQuery&&this.search({query:this.currentSearchQuery})}else this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.failure.noActiveGroup"))})}addSubgroupToGroup(t){this.groupDataService.getActiveGroup().pipe((0,k.s)(1)).subscribe(n=>{if(null!=n)if(n.uuid!==t.uuid){const i=this.groupDataService.addSubGroupToGroup(n,t);this.showNotifications("addSubgroup",i,this.dsoNameService.getName(t),n),null!=this.currentSearchQuery&&this.search({query:this.currentSearchQuery})}else this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.failure.subgroupToAddIsActiveGroup"));else this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.failure.noActiveGroup"))})}search(t){this.unsubFrom(B.SearchResults),this.subs.set(B.SearchResults,this.paginationService.getCurrentPagination(this.configSearch.id,this.configSearch).pipe((0,I.n)(n=>{const i=t.query;return null!=i&&this.currentSearchQuery!==i&&this.groupBeingEdited&&(this.currentSearchQuery=i,this.paginationService.resetPage(this.configSearch.id)),this.searchDone=!0,this.groupDataService.searchNonMemberGroups(this.currentSearchQuery,this.groupBeingEdited.id,{currentPage:n.currentPage,elementsPerPage:n.pageSize},!1,!0,(0,D.s)("object"))}),(0,u.bD)(),(0,g.T)(n=>{if(!n.hasFailed)return n;this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.failure",{cause:n.errorMessage}))})).subscribe(n=>{this.searchResults$.next(n)}))}unsubFrom(t){this.subs.has(t)&&(this.subs.get(t).unsubscribe(),this.subs.delete(t))}ngOnDestroy(){for(const t of this.subs.keys())this.unsubFrom(t);this.paginationService.clearPagination(this.config.id),this.paginationService.clearPagination(this.configSearch.id)}showNotifications(t,n,i,s){n.pipe((0,u.qD)()).subscribe(l=>{l.hasSucceeded?(this.notificationsService.success(this.translateService.get(this.messagePrefix+".notification.success."+t,{name:i})),this.groupDataService.clearGroupLinkRequests(s._links.subgroups.href)):this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.failure."+t,{name:i}))})}clearFormAndResetResult(){this.searchForm.patchValue({query:""}),this.search({query:""})}static{this.\u0275fac=function(n){return new(n||a)(e.rXU(Z.GroupDataService),e.rXU(d.c$),e.rXU(z.I),e.rXU(m.ze),e.rXU(q.m),e.rXU(R.Ix),e.rXU(U.f))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["ds-subgroups-list"]],inputs:{messagePrefix:"messagePrefix"},standalone:!0,features:[e.aNF],decls:30,vars:29,consts:[[1,"border-bottom","pb-2"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage"],["role","alert",1,"alert","alert-info","w-100","mb-2"],["id","search",1,"border-bottom","pb-2"],[4,"dsContextHelp"],[1,"d-flex","justify-content-between",3,"ngSubmit","formGroup"],[1,"flex-grow-1","me-3"],[1,"mb-3","input-group","me-3"],["type","text","name","query","id","query","formControlName","query","aria-label","Search input",1,"form-control"],[1,"input-group-append"],["type","submit",1,"search-button","btn","btn-primary"],[1,"fas","fa-search"],[1,"btn","btn-secondary","float-end",3,"click"],[1,"table-responsive"],["id","subgroupsOfGroup",1,"table","table-striped","table-hover","table-bordered"],["scope","col",1,"align-middle"],[1,"align-middle"],[3,"click","routerLink"],[1,"btn-group","edit-field"],[1,"btn","btn-outline-danger","btn-sm","deleteButton",3,"click","title"],[1,"fas","fa-trash-alt","fa-fw"],["id","groupsSearch",1,"table","table-striped","table-hover","table-bordered"],[1,"btn","btn-outline-primary","btn-sm","addButton",3,"click","title"],[1,"fas","fa-plus","fa-fw"]],template:function(n,i){if(1&n&&(e.qex(0),e.j41(1,"h3",0),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"h4"),e.EFF(5),e.nI1(6,"translate"),e.k0s(),e.DNE(7,Jt,22,20,"ds-pagination",1),e.nI1(8,"async"),e.DNE(9,Yt,3,3,"div",2),e.nI1(10,"async"),e.j41(11,"h4",3),e.DNE(12,Wt,3,3,"span",4),e.k0s(),e.j41(13,"form",5),e.bIt("ngSubmit",function(){return i.search(i.searchForm.value)}),e.j41(14,"div",6)(15,"div",7),e.nrm(16,"input",8),e.j41(17,"span",9)(18,"button",10),e.nrm(19,"i",11),e.EFF(20),e.nI1(21,"translate"),e.k0s()()()(),e.j41(22,"div")(23,"button",12),e.bIt("click",function(){return i.clearFormAndResetResult()}),e.EFF(24),e.nI1(25,"translate"),e.k0s()()(),e.DNE(26,Ht,22,20,"ds-pagination",1),e.nI1(27,"async"),e.DNE(28,qt,3,3,"div",2),e.nI1(29,"async"),e.bVm()),2&n){let s,l,p,h;e.R7$(2),e.JRh(e.bMT(3,10,i.messagePrefix+".head")),e.R7$(3),e.JRh(e.bMT(6,12,i.messagePrefix+".headSubgroups")),e.R7$(2),e.vxM((null==(s=e.bMT(8,14,i.subGroups$))||null==s.payload?null:s.payload.totalElements)>0?7:-1),e.R7$(2),e.vxM(0===(null==(l=e.bMT(10,16,i.subGroups$))||null==l.payload?null:l.payload.totalElements)?9:-1),e.R7$(3),e.Y8G("dsContextHelp",e.eq3(27,Ut,e.lJ4(26,Vt))),e.R7$(),e.Y8G("formGroup",i.searchForm),e.R7$(7),e.SpI(" ",e.bMT(21,18,i.messagePrefix+".search.button")," "),e.R7$(4),e.SpI(" ",e.bMT(25,20,i.messagePrefix+".button.see-all")," "),e.R7$(2),e.vxM((null==(p=e.bMT(27,22,i.searchResults$))||null==p.payload?null:p.payload.totalElements)>0?26:-1),e.R7$(2),e.vxM(0===(null==(h=e.bMT(29,24,i.searchResults$))||null==h.payload?null:h.payload.totalElements)&&i.searchDone?28:-1)}},dependencies:[T.Jj,me.G,O.e,m.X1,m.qT,m.me,m.BC,m.cb,m.j4,m.JD,R.Wk,d.h,d.D9],encapsulation:2})}}return a})();class Zt{static createValidator(r){return t=>r.searchGroups(t.value,{currentPage:1,elementsPerPage:100}).pipe((0,u.Ar)(),(0,g.T)(n=>n.filter(i=>i.name===t.value)),(0,g.T)(n=>n.length>0?{groupExists:!0}:null))}}const en=()=>["right","bottom"],tn=a=>({content:"admin.access-control.groups.form.tooltip.editGroupPage",id:"edit-group-page",iconPlacement:"right",tooltipPlacement:a}),nn=(a,r,t)=>({name:a,comcol:r,comcolEditRolesRoute:t});function an(a,r){if(1&a&&(e.j41(0,"span"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&a){const t=e.XpG(2);e.R7$(),e.SpI(" ",e.bMT(2,1,t.messagePrefix+".head.edit")," ")}}function sn(a,r){1&a&&(e.j41(0,"h1",3),e.DNE(1,an,3,3,"span",9),e.k0s()),2&a&&(e.R7$(),e.Y8G("dsContextHelp",e.eq3(2,tn,e.lJ4(1,en))))}function rn(a,r){if(1&a&&(e.j41(0,"h1",3),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&a){const t=e.XpG();e.R7$(),e.JRh(e.bMT(2,1,t.messagePrefix+".head.create"))}}function on(a,r){if(1&a&&e.nrm(0,"ds-alert",10),2&a){const t=e.XpG(2);e.Y8G("type",t.AlertType.Warning)("content",t.messagePrefix+".alert.permanent")}}function ln(a,r){if(1&a&&(e.nrm(0,"ds-alert",10),e.nI1(1,"async"),e.nI1(2,"translate")),2&a){const t=e.XpG(),n=e.XpG(2);e.Y8G("type",n.AlertType.Warning)("content",e.i5U(2,4,n.messagePrefix+".alert.workflowGroup",e.sMw(7,nn,n.dsoNameService.getName(t),t.type,e.bMT(1,2,n.linkedEditRolesRoute$))))}}function cn(a,r){if(1&a&&(e.DNE(0,ln,3,11,"ds-alert",10),e.nI1(1,"async")),2&a){const t=e.XpG(2);e.vxM(!0!==e.bMT(1,1,t.canEdit$)?0:-1)}}function un(a,r){if(1&a&&(e.DNE(0,on,1,2,"ds-alert",10)(1,cn,2,3),e.nI1(2,"async")),2&a){let t;const n=r,i=e.XpG();e.vxM(null!=n&&n.permanent?0:-1),e.R7$(),e.vxM((t=e.bMT(2,2,i.activeGroupLinkedDSO$))?1:-1,t)}}function pn(a,r){if(1&a){const t=e.RV6();e.j41(0,"div",8)(1,"button",11),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.delete())}),e.nrm(2,"i",12),e.EFF(3),e.nI1(4,"translate"),e.k0s()()}if(2&a){const t=e.XpG();e.R7$(3),e.SpI(" ",e.bMT(4,1,t.messagePrefix+".actions.delete")," ")}}function dn(a,r){if(1&a&&e.nrm(0,"ds-members-list",14),2&a){const t=e.XpG(2);e.Y8G("messagePrefix",t.messagePrefix+".members-list")}}function mn(a,r){if(1&a&&e.nrm(0,"ds-subgroups-list",14),2&a){const t=e.XpG(2);e.Y8G("messagePrefix",t.messagePrefix+".subgroups-list")}}function gn(a,r){if(1&a&&(e.j41(0,"div",13),e.DNE(1,dn,1,1,"ds-members-list",14),e.k0s(),e.DNE(2,mn,1,1,"ds-subgroups-list",14)),2&a){const t=r;e.R7$(),e.vxM(void 0!==t?1:-1),e.R7$(),e.vxM(void 0!==t?2:-1)}}let fe=(()=>{class a{constructor(t,n,i,s,l,p,h,S,x,v,j,X){this.groupDataService=t,this.dSpaceObjectDataService=n,this.formBuilderService=i,this.translateService=s,this.notificationsService=l,this.route=p,this.router=h,this.authorizationService=S,this.modalService=x,this.requestService=v,this.changeDetectorRef=j,this.dsoNameService=X,this.messagePrefix="admin.access-control.groups.form",this.formId="group-form",this.formLayout={groupName:{grid:{host:"row"}},groupDescription:{grid:{host:"row"}}},this.submitForm=new e.bkB,this.cancelForm=new e.bkB,this.subs=[],this.AlertType=At.v}ngOnInit(){"newGroup"!==this.route.snapshot.params.groupId&&this.setActiveGroup(this.route.snapshot.params.groupId),this.activeGroup$=this.groupDataService.getActiveGroup(),this.activeGroupLinkedDSO$=this.getActiveGroupLinkedDSO(),this.linkedEditRolesRoute$=this.getLinkedEditRolesRoute(),this.canEdit$=this.activeGroupLinkedDSO$.pipe((0,I.n)(t=>(0,c.a4)(t)?[!1]:this.activeGroup$.pipe((0,c.Az)(),(0,I.n)(n=>this.authorizationService.isAuthorized(L._.CanDelete,n.self))))),this.initialisePage()}initialisePage(){const t=new _.rA_({id:"groupName",label:this.translateService.instant(`${this.messagePrefix}.groupName`),name:"groupName",validators:{required:null},required:!0}),n=new _.rA_({id:"groupCommunity",label:this.translateService.instant(`${this.messagePrefix}.groupCommunity`),name:"groupCommunity",required:!1,readOnly:!0}),i=new _.Zex({id:"groupDescription",label:this.translateService.instant(`${this.messagePrefix}.groupDescription`),name:"groupDescription",required:!1,spellCheck:Dt.c.form.spellCheck});this.formModel=[t,i],this.formGroup=this.formBuilderService.createFormGroup(this.formModel),this.groupName=this.formGroup.get("groupName"),this.groupDescription=this.formGroup.get("groupDescription"),(0,c.a4)(this.groupName)&&(this.groupName.setAsyncValidators(Zt.createValidator(this.groupDataService)),this.groupNameValueChangeSubscribe=this.groupName.valueChanges.pipe((0,re.B)(300)).subscribe(()=>{this.changeDetectorRef.detectChanges()})),this.subs.push((0,V.z)([this.activeGroup$,this.canEdit$,this.activeGroupLinkedDSO$]).subscribe(([s,l,p])=>{null!=s&&(this.formGroup.controls.groupName.clearAsyncValidators(),(0,c.hj)(p?.name)?(this.formGroup.controls.groupCommunity||(this.formBuilderService.insertFormGroupControl(1,this.formGroup,this.formModel,n),this.groupDescription=this.formGroup.get("groupCommunity")),this.formGroup.patchValue({groupName:s.name,groupCommunity:p?.name??"",groupDescription:s.firstMetadataValue("dc.description")})):(this.formModel=[t,i],this.formGroup.patchValue({groupName:s.name,groupDescription:s.firstMetadataValue("dc.description")})),!l||s.permanent?this.formGroup.disable():this.formGroup.enable())}))}onCancel(){this.groupDataService.cancelEditGroup(),this.cancelForm.emit(),this.router.navigate([(0,b.mK)()])}onSubmit(){this.activeGroup$.pipe((0,k.s)(1)).subscribe(t=>{null===t?this.createNewGroup({name:this.groupName.value,metadata:{"dc.description":[{value:this.groupDescription.value}]}}):this.editGroup(t)})}createNewGroup(t){const n=Object.assign(new Lt.Y,t);this.groupDataService.create(n).pipe((0,u.qD)()).subscribe(i=>{i.hasSucceeded?(this.notificationsService.success(this.translateService.get(this.messagePrefix+".notification.created.success",{name:n.name})),this.submitForm.emit(n),(0,c.hj)(i.payload)&&(this.setActiveGroupWithLink(i.payload._links.self.href),this.groupDataService.clearGroupsRequests(),this.router.navigateByUrl((0,b.xl)(i.payload.uuid)))):(this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.created.failure",{name:n.name})),this.showNotificationIfNameInUse(n,"created"),this.cancelForm.emit())})}showNotificationIfNameInUse(t,n){this.subs.push(this.groupDataService.searchGroups(t.name,{currentPage:1,elementsPerPage:0}).pipe((0,u.yd)(),(0,u.Bo)()).subscribe(i=>{i.totalElements>0&&this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification."+n+".failure.groupNameInUse",{name:this.dsoNameService.getName(t)}))}))}editGroup(t){let n=[];(0,c.a4)(this.groupDescription.value)&&(n=[...n,{op:"add",path:"/metadata/dc.description",value:this.groupDescription.value}]),(0,c.a4)(this.groupName.value)&&(n=[...n,{op:"replace",path:"/name",value:this.groupName.value}]),this.groupDataService.patch(t,n).pipe((0,u.qD)()).subscribe(i=>{i.hasSucceeded?(this.notificationsService.success(this.translateService.get(this.messagePrefix+".notification.edited.success",{name:this.dsoNameService.getName(i.payload)})),this.submitForm.emit(i.payload)):(this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.edited.failure",{name:this.dsoNameService.getName(t)})),this.cancelForm.emit())})}setActiveGroup(t){this.groupDataService.cancelEditGroup(),this.groupDataService.findById(t).pipe((0,u.yd)(),(0,u.Bo)()).subscribe(n=>{this.groupDataService.editGroup(n)})}setActiveGroupWithLink(t){this.activeGroup$.pipe((0,k.s)(1)).subscribe(n=>{null===n&&(this.groupDataService.cancelEditGroup(),this.groupDataService.findByHref(t,!1,!1,(0,D.s)("subgroups"),(0,D.s)("epersons"),(0,D.s)("object")).pipe((0,u.yd)(),(0,u.Bo)()).subscribe(i=>{this.groupDataService.editGroup(i)}))})}delete(){this.activeGroup$.pipe((0,k.s)(1)).subscribe(t=>{const n=this.modalService.open(K.M);n.componentInstance.name=this.dsoNameService.getName(t),n.componentInstance.headerLabel=this.messagePrefix+".delete-group.modal.header",n.componentInstance.infoLabel=this.messagePrefix+".delete-group.modal.info",n.componentInstance.cancelLabel=this.messagePrefix+".delete-group.modal.cancel",n.componentInstance.confirmLabel=this.messagePrefix+".delete-group.modal.confirm",n.componentInstance.brandColor="danger",n.componentInstance.confirmIcon="fas fa-trash",n.componentInstance.response.pipe((0,k.s)(1)).subscribe(i=>{i&&(0,c.a4)(t.id)&&this.groupDataService.delete(t.id).pipe((0,u.qD)()).subscribe(s=>{s.hasSucceeded?(this.notificationsService.success(this.translateService.get(this.messagePrefix+".notification.deleted.success",{name:this.dsoNameService.getName(t)})),this.onCancel()):this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.deleted.failure.title",{name:this.dsoNameService.getName(t)}),this.translateService.get(this.messagePrefix+".notification.deleted.failure.content",{cause:s.errorMessage}))})})})}ngOnDestroy(){this.groupDataService.cancelEditGroup(),this.subs.filter(t=>(0,c.a4)(t)).forEach(t=>t.unsubscribe()),(0,c.a4)(this.groupNameValueChangeSubscribe)&&this.groupNameValueChangeSubscribe.unsubscribe()}getActiveGroupLinkedDSO(){return this.activeGroup$.pipe((0,c.Az)(),(0,I.n)(t=>void 0===t.object?this.dSpaceObjectDataService.findByHref(t._links.object.href):t.object),(0,u.bD)(),(0,u.Bo)())}getLinkedEditRolesRoute(){return this.activeGroupLinkedDSO$.pipe((0,c.Az)(),(0,g.T)(t=>{switch(t.type){case wt.E.type.value:return(0,Nt.EU)(t.id);case Bt.p.type.value:return(0,jt.BW)(t.id)}}))}static{this.\u0275fac=function(n){return new(n||a)(e.rXU(Z.GroupDataService),e.rXU(de.DSpaceObjectDataService),e.rXU(le.j),e.rXU(d.c$),e.rXU(z.I),e.rXU(R.nX),e.rXU(R.Ix),e.rXU(W.AuthorizationDataService),e.rXU(f.Bq),e.rXU(Q.B),e.rXU(e.gRc),e.rXU(U.f))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["ds-group-form"]],hostBindings:function(n,i){1&n&&e.bIt("beforeunload",function(){return i.ngOnDestroy()},!1,e.tSv)},outputs:{submitForm:"submitForm",cancelForm:"cancelForm"},standalone:!0,features:[e.aNF],decls:19,vars:22,consts:[[1,"container"],[1,"group-form","row"],[1,"col-12"],[1,"border-bottom","pb-2"],[3,"submitForm","formId","formModel","formGroup","formLayout","displayCancel"],["before","",1,"btn-group"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"fas","fa-arrow-left"],["after","",1,"btn-group"],[4,"dsContextHelp"],[3,"type","content"],["type","button",1,"btn","btn-danger","delete-button",3,"click"],[1,"fa","fa-trash"],[1,"mb-5"],[3,"messagePrefix"]],template:function(n,i){if(1&n&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2),e.DNE(3,sn,2,4,"h1",3),e.nI1(4,"async"),e.DNE(5,rn,3,3,"h1",3)(6,un,3,4),e.nI1(7,"async"),e.j41(8,"ds-form",4),e.bIt("submitForm",function(){return i.onSubmit()}),e.j41(9,"div",5)(10,"button",6),e.bIt("click",function(){return i.onCancel()}),e.nrm(11,"i",7),e.EFF(12),e.nI1(13,"translate"),e.k0s()(),e.DNE(14,pn,5,3,"div",8),e.nI1(15,"async"),e.nI1(16,"async"),e.k0s(),e.DNE(17,gn,3,2),e.nI1(18,"async"),e.k0s()()()),2&n){let s,l,p;e.R7$(3),e.vxM(e.bMT(4,10,i.activeGroup$)?3:5),e.R7$(3),e.vxM((s=e.bMT(7,12,i.activeGroup$))?6:-1,s),e.R7$(2),e.Y8G("formId",i.formId)("formModel",i.formModel)("formGroup",i.formGroup)("formLayout",i.formLayout)("displayCancel",!1),e.R7$(4),e.SpI(" ",e.bMT(13,14,i.messagePrefix+".return"),""),e.R7$(2),e.vxM(!e.bMT(15,16,i.canEdit$)||null!=(l=e.bMT(16,18,i.activeGroup$))&&l.permanent?-1:14),e.R7$(3),e.vxM((p=e.bMT(18,20,i.activeGroup$))?17:-1,p)}},dependencies:[Xt.C,T.Jj,me.G,ce.s,Ot.v,Kt,d.h,d.D9],encapsulation:2})}}return a})();var hn=o(8245),fn=o(7094);const bn=(a,r)=>(0,e.WQX)(fn.Y).getEndpoint("groups").pipe((0,g.T)(i=>`${i}/${a?.params?.groupId}`));var _n=o(983),Sn=o(88141),Pn=o(39901),In=o(99437),Cn=o(56977);class yn{}var xn=o(87507);const be=a=>({name:a});function Rn(a,r){1&a&&e.nrm(0,"ds-loading")}function En(a,r){if(1&a&&(e.j41(0,"button",23),e.nI1(1,"translate"),e.nrm(2,"i",26),e.k0s()),2&a){const t=e.XpG().$implicit,n=e.XpG(2);e.FS9("title",e.i5U(1,2,n.messagePrefix+"table.edit.buttons.edit",e.eq3(5,be,n.dsoNameService.getName(t.group)))),e.Y8G("routerLink",n.groupService.getGroupEditPageRouterLink(t.group))}}function Fn(a,r){1&a&&(e.j41(0,"button",24),e.nI1(1,"translate"),e.nrm(2,"i",26),e.k0s()),2&a&&e.Y8G("dsBtnDisabled",!0)("ngbTooltip",e.bMT(1,2,"admin.access-control.epeople.table.edit.buttons.edit-disabled"))}function $n(a,r){if(1&a){const t=e.RV6();e.j41(0,"button",27),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,s=e.XpG(2);return e.Njj(s.confirmDelete(i))}),e.nrm(2,"i",28),e.k0s()}if(2&a){const t=e.XpG().$implicit,n=e.XpG(2);e.FS9("title",e.i5U(1,1,n.messagePrefix+"table.edit.buttons.remove",e.eq3(4,be,n.dsoNameService.getName(t.group))))}}function Tn(a,r){if(1&a&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.nI1(7,"async"),e.k0s(),e.j41(8,"td"),e.EFF(9),e.k0s(),e.j41(10,"td")(11,"div",22),e.DNE(12,En,3,7,"button",23)(13,Fn,3,4,"button",24)(14,$n,3,6,"button",25),e.k0s()()()),2&a){let t,n;const i=r.$implicit,s=e.XpG(2);e.R7$(2),e.JRh(i.group.id),e.R7$(2),e.JRh(s.dsoNameService.getName(i.group)),e.R7$(2),e.JRh(s.dsoNameService.getName(null==(t=e.bMT(7,6,i.group.object))?null:t.payload)),e.R7$(3),e.JRh((null==i.epersons?null:i.epersons.totalElements)+(null==i.subgroups?null:i.subgroups.totalElements)),e.R7$(3),e.vxM(!0===(n=i.ableToEdit)?12:!1===n?13:-1),e.R7$(2),e.vxM(null!=i.group&&i.group.permanent||!i.ableToDelete?-1:14)}}function kn(a,r){if(1&a&&(e.j41(0,"ds-pagination",17),e.nI1(1,"async"),e.j41(2,"div",19)(3,"table",20)(4,"thead")(5,"tr")(6,"th",21),e.EFF(7),e.nI1(8,"translate"),e.k0s(),e.j41(9,"th",21),e.EFF(10),e.nI1(11,"translate"),e.k0s(),e.j41(12,"th",21),e.EFF(13),e.nI1(14,"translate"),e.k0s(),e.j41(15,"th",21),e.EFF(16),e.nI1(17,"translate"),e.k0s(),e.j41(18,"th"),e.EFF(19),e.nI1(20,"translate"),e.k0s()()(),e.j41(21,"tbody"),e.Z7z(22,Tn,15,8,"tr",null,e.fX1),e.nI1(24,"async"),e.k0s()()()()),2&a){let t,n;const i=e.XpG();e.Y8G("paginationOptions",i.config)("collectionSize",null==(t=e.bMT(1,9,i.pageInfoState$))?null:t.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),e.R7$(7),e.JRh(e.bMT(8,11,i.messagePrefix+"table.id")),e.R7$(3),e.JRh(e.bMT(11,13,i.messagePrefix+"table.name")),e.R7$(3),e.JRh(e.bMT(14,15,i.messagePrefix+"table.collectionOrCommunity")),e.R7$(3),e.JRh(e.bMT(17,17,i.messagePrefix+"table.members")),e.R7$(3),e.JRh(e.bMT(20,19,i.messagePrefix+"table.edit")),e.R7$(3),e.Dyx(null==(n=e.bMT(24,21,i.groupsDto$))?null:n.page)}}function Gn(a,r){if(1&a&&(e.j41(0,"div",18),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&a){const t=e.XpG();e.R7$(),e.SpI(" ",e.bMT(2,1,t.messagePrefix+"no-items")," ")}}const ve=(a,r,t)=>a.touched&&!t||a.errors?.emailTaken&&t,w=[{provide:_.P3,useValue:ve}],Dn=[{path:b.P5,component:ut,resolve:{breadcrumb:C.S},providers:w,data:{title:"admin.access-control.epeople.title",breadcrumbKey:"admin.access-control.epeople"},canActivate:[y.Y]},{path:`${b.P5}/create`,component:pe,resolve:{breadcrumb:C.S},providers:w,data:{title:"admin.access-control.epeople.add.title",breadcrumbKey:"admin.access-control.epeople.add"},canActivate:[y.Y]},{path:`${b.P5}/:id/edit`,component:pe,resolve:{breadcrumb:C.S,ePerson:Mt},providers:w,data:{title:"admin.access-control.epeople.edit.title",breadcrumbKey:"admin.access-control.epeople.edit"},canActivate:[y.Y]},{path:b.w4,component:(()=>{class a{constructor(t,n,i,s,l,p,h,S,x,v,j,X){this.groupService=t,this.ePersonDataService=n,this.dSpaceObjectDataService=i,this.translateService=s,this.notificationsService=l,this.formBuilder=p,this.routeService=h,this.authorizationService=S,this.paginationService=x,this.requestService=v,this.dsoNameService=j,this.modalService=X,this.messagePrefix="admin.access-control.groups.",this.config=Object.assign(new M.W,{id:"gl",pageSize:5,currentPage:1}),this.groupsDto$=new P.t({}),this.deletedGroupsIds=[],this.pageInfoState$=new P.t(void 0),this.loading$=new P.t(!1),this.subs=[],this.currentSearchQuery="",this.searchForm=this.formBuilder.group({query:this.currentSearchQuery})}ngOnInit(){this.search({query:this.currentSearchQuery})}search(t){(0,c.a4)(this.searchSub)&&(this.searchSub.unsubscribe(),this.subs=this.subs.filter(n=>n!==this.searchSub)),this.searchSub=this.paginationService.getCurrentPagination(this.config.id,this.config).pipe((0,Sn.M)(()=>this.loading$.next(!0)),(0,I.n)(n=>{const i=t.query;return null!=i&&this.currentSearchQuery!==i&&(this.currentSearchQuery=i,this.paginationService.updateRouteWithUrl(this.config.id,[],{page:1})),this.groupService.searchGroups(this.currentSearchQuery.trim(),{currentPage:n.currentPage,elementsPerPage:n.pageSize},!0,!0,(0,D.s)("object"))}),(0,u.v7)(),(0,u.Bo)(),(0,I.n)(n=>0===n.page.length?(0,E.of)((0,A.g)(n.pageInfo,[])):this.authorizationService.isAuthorized(L._.AdministratorOf).pipe((0,I.n)(i=>(0,V.z)([...n.page.map(s=>(0,c.a4)(s)&&!this.deletedGroupsIds.includes(s.id)?(0,V.z)([this.authorizationService.isAuthorized(L._.CanDelete,s.self),this.canManageGroup$(i,s),this.hasLinkedDSO(s),this.getSubgroups(s),this.getMembers(s)]).pipe((0,g.T)(([l,p,h,S,x])=>{const v=new yn;return v.ableToDelete=l&&!h,v.ableToEdit=p,v.group=s,v.subgroups=S.payload,v.epersons=x.payload,v})):_n.w)]).pipe((0,Pn.U)([]),(0,g.T)(s=>(0,A.g)(n.pageInfo,s))))))).subscribe(n=>{this.groupsDto$.next(n),this.pageInfoState$.next(n.pageInfo),this.loading$.next(!1)}),this.subs.push(this.searchSub)}canManageGroup$(t,n){return t?(0,E.of)(!0):this.authorizationService.isAuthorized(L._.CanManageGroup,n.self)}deleteGroup(t){(0,c.a4)(t.group.id)&&this.groupService.delete(t.group.id).pipe((0,u.qD)()).subscribe(n=>{n.hasSucceeded?(this.deletedGroupsIds=[...this.deletedGroupsIds,t.group.id],this.notificationsService.success(this.translateService.get(this.messagePrefix+"notification.deleted.success",{name:this.dsoNameService.getName(t.group)}))):this.notificationsService.error(this.translateService.get(this.messagePrefix+"notification.deleted.failure.title",{name:this.dsoNameService.getName(t.group)}),this.translateService.get(this.messagePrefix+"notification.deleted.failure.content",{cause:n.errorMessage}))})}getMembers(t){return this.ePersonDataService.findListByHref(t._links.epersons.href,{currentPage:1,elementsPerPage:1}).pipe((0,u.yd)())}getSubgroups(t){return this.groupService.findListByHref(t._links.subgroups.href,{currentPage:1,elementsPerPage:1}).pipe((0,u.yd)())}hasLinkedDSO(t){return this.dSpaceObjectDataService.findByHref(t._links.object.href).pipe((0,u.yd)(),(0,g.T)(n=>(0,c.a4)(n)&&(0,c.a4)(n.payload)),(0,In.W)(()=>(0,E.of)(!1)))}clearFormAndResetResult(){this.searchForm.patchValue({query:""}),this.search({query:""})}ngOnDestroy(){this.cleanupSubscribes(),this.paginationService.clearPagination(this.config.id)}cleanupSubscribes(){(0,c.a4)(this.paginationSub)&&this.paginationSub.unsubscribe(),this.subs.filter(t=>(0,c.a4)(t)).forEach(t=>t.unsubscribe()),this.paginationService.clearPagination(this.config.id)}confirmDelete(t){const n=this.modalService.open(K.M);n.componentInstance.name=this.dsoNameService.getName(t.group),n.componentInstance.headerLabel="admin.access-control.epeople.table.edit.buttons.remove.modal.header",n.componentInstance.infoLabel="admin.access-control.epeople.table.edit.buttons.remove.modal.info",n.componentInstance.cancelLabel="admin.access-control.epeople.table.edit.buttons.remove.modal.cancel",n.componentInstance.confirmLabel="admin.access-control.epeople.table.edit.buttons.remove.modal.confirm",n.componentInstance.brandColor="danger",n.componentInstance.confirmIcon="fas fa-trash";const i=n.componentInstance.response.pipe((0,Cn.Q)(n.closed)).subscribe(s=>{!0===s&&this.deleteGroup(t)});n.result.then().finally(()=>{n.close(),i&&!i.closed&&i.unsubscribe()})}static{this.\u0275fac=function(n){return new(n||a)(e.rXU(Z.GroupDataService),e.rXU(H.EPersonDataService),e.rXU(de.DSpaceObjectDataService),e.rXU(d.c$),e.rXU(z.I),e.rXU(m.ze),e.rXU(xn.v$),e.rXU(W.AuthorizationDataService),e.rXU(q.m),e.rXU(Q.B),e.rXU(U.f),e.rXU(f.Bq))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["ds-groups-registry"]],standalone:!0,features:[e.aNF],decls:38,vars:34,consts:[[1,"container"],[1,"groups-registry","row"],[1,"col-12"],[1,"d-flex","justify-content-between","border-bottom","mb-3"],["id","header",1,"pb-2"],[1,"me-auto","btn","btn-success",3,"routerLink"],[1,"fas","fa-plus"],[1,"d-none","d-sm-inline","ms-1"],["id","search",1,"border-bottom","pb-2"],[1,"d-flex","justify-content-between",3,"ngSubmit","formGroup"],[1,"flex-grow-1","me-3"],[1,"mb-3","input-group"],["type","text","name","query","id","query","formControlName","query",1,"form-control",3,"placeholder"],[1,"input-group-append"],["type","submit",1,"search-button","btn","btn-primary"],[1,"fas","fa-search"],[1,"btn","btn-secondary",3,"click"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage"],["role","alert",1,"alert","alert-info","w-100","mb-2"],[1,"table-responsive"],["id","groups",1,"table","table-striped","table-hover","table-bordered"],["scope","col"],[1,"btn-group","edit-field"],[1,"btn","btn-outline-primary","btn-sm","btn-edit",3,"routerLink","title"],["placement","left",1,"btn","btn-outline-primary","btn-sm","btn-edit",3,"dsBtnDisabled","ngbTooltip"],[1,"btn","btn-outline-danger","btn-sm","btn-delete",3,"title"],[1,"fas","fa-edit","fa-fw"],[1,"btn","btn-outline-danger","btn-sm","btn-delete",3,"click","title"],[1,"fas","fa-trash-alt","fa-fw"]],template:function(n,i){if(1&n&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1",4),e.EFF(5),e.nI1(6,"translate"),e.k0s(),e.j41(7,"div")(8,"button",5),e.nrm(9,"i",6),e.j41(10,"span",7),e.EFF(11),e.nI1(12,"translate"),e.k0s()()()(),e.j41(13,"h2",8),e.EFF(14),e.nI1(15,"translate"),e.k0s(),e.j41(16,"form",9),e.bIt("ngSubmit",function(){return i.search(i.searchForm.value)}),e.j41(17,"div",10)(18,"div",11),e.nrm(19,"input",12),e.nI1(20,"translate"),e.nI1(21,"translate"),e.j41(22,"span",13)(23,"button",14),e.nrm(24,"i",15),e.EFF(25),e.nI1(26,"translate"),e.k0s()()()(),e.j41(27,"div")(28,"button",16),e.bIt("click",function(){return i.clearFormAndResetResult()}),e.EFF(29),e.nI1(30,"translate"),e.k0s()()(),e.DNE(31,Rn,1,0,"ds-loading"),e.nI1(32,"async"),e.DNE(33,kn,25,23,"ds-pagination",17),e.nI1(34,"async"),e.nI1(35,"async"),e.DNE(36,Gn,3,3,"div",18),e.nI1(37,"async"),e.k0s()()()),2&n){let s,l;e.R7$(5),e.JRh(e.bMT(6,12,i.messagePrefix+"head")),e.R7$(3),e.Y8G("routerLink","create"),e.R7$(3),e.JRh(e.bMT(12,14,i.messagePrefix+"button.add")),e.R7$(3),e.JRh(e.bMT(15,16,i.messagePrefix+"search.head")),e.R7$(2),e.Y8G("formGroup",i.searchForm),e.R7$(3),e.Y8G("placeholder",e.bMT(20,18,i.messagePrefix+"search.placeholder")),e.BMQ("aria-label",e.bMT(21,20,i.messagePrefix+"search.placeholder")),e.R7$(6),e.SpI(" ",e.bMT(26,22,i.messagePrefix+"search.button")," "),e.R7$(4),e.SpI(" ",e.bMT(30,24,i.messagePrefix+"button.see-all")," "),e.R7$(2),e.vxM(e.bMT(32,26,i.loading$)?31:-1),e.R7$(2),e.vxM((null==(s=e.bMT(34,28,i.pageInfoState$))?null:s.totalElements)>0&&!0!==e.bMT(35,30,i.loading$)?33:-1),e.R7$(3),e.vxM(0===(null==(l=e.bMT(37,32,i.pageInfoState$))?null:l.totalElements)?36:-1)}},dependencies:[T.Jj,N.A,f.n8,f.md,O.e,m.X1,m.qT,m.me,m.BC,m.cb,m.j4,m.JD,R.Wk,ee.v,d.h,d.D9],encapsulation:2})}}return a})(),resolve:{breadcrumb:C.S},providers:w,data:{title:"admin.access-control.groups.title",breadcrumbKey:"admin.access-control.groups"},canActivate:[$.i]},{path:`${b.w4}/create`,component:fe,resolve:{breadcrumb:C.S},providers:w,data:{title:"admin.access-control.groups.title.addGroup",breadcrumbKey:"admin.access-control.groups.addGroup"},canActivate:[$.i]},{path:`${b.w4}/:groupId/edit`,component:fe,resolve:{breadcrumb:C.S},providers:w,data:{title:"admin.access-control.groups.title.singleGroup",breadcrumbKey:"admin.access-control.groups.singleGroup"},canActivate:[(a=bn,r)=>(0,hn.h)(()=>(0,E.of)([L._.CanManageGroup]),a,r)]},{path:"bulk-access",component:nt,resolve:{breadcrumb:C.S},data:{title:"admin.access-control.bulk-access.title",breadcrumbKey:"admin.access-control.bulk-access"},canActivate:[y.Y]}]},80495:(J,F,o)=>{o.d(F,{Q:()=>_});class _{constructor($,y){this.text=$,this.url=y}}},59072:(J,F,o)=>{o.d(F,{S:()=>Y});var _=o(54438),C=o(89777),$=o(54034),y=o(7673),b=o(80495);let P=(()=>{class g{getBreadcrumbs(N,G){return(0,y.of)([new b.Q(N+".breadcrumbs",G)])}static{this.\u0275fac=function(G){return new(G||g)}}static{this.\u0275prov=_.jDH({token:g,factory:g.\u0275fac,providedIn:"root"})}}return g})();const Y=(g,te,N=(0,_.WQX)(P))=>{const G=g.data.breadcrumbKey;if((0,C.Tn)(G))throw new Error('You provided an i18nBreadcrumbResolver for url "'+g.url+"\" but no breadcrumbKey in the route's data");return{provider:N,key:G,url:(0,$.F)(g)}}},10817:(J,F,o)=>{o.d(F,{j:()=>$});const C={RESOLVED:(0,o(6800).N)("dspace/resolver/RESOLVED")};class ${constructor(b,d){this.type=C.RESOLVED,this.payload={url:b,dso:d}}}},95038:(J,F,o)=>{o.d(F,{n:()=>$});var _=o(89777),C=o(54438);let $=(()=>{class y{transform(d){return(0,_.Tn)(d)}static{this.\u0275fac=function(P){return new(P||y)}}static{this.\u0275pipe=C.EJ8({name:"dsHasNoValue",type:y,pure:!0,standalone:!0})}}return y})()}}]);