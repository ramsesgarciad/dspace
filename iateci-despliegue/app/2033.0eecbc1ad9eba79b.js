"use strict";(self.webpackChunkdspace_angular=self.webpackChunkdspace_angular||[]).push([[2033],{16289:(C,S,a)=>{a.d(S,{F:()=>f});var r=a(59640),E=a(25558),c=a(96354),U=a(5964),O=a(23294),g=a(96697),d=a(89777),D=a(30269),l=a(3079),h=a(94289),s=a(96266),p=a(54438);function b(u){return(0,r.Mz)(function T(){return(0,r.Mz)(D.N,u=>u["cache/object-updates"])}(),n=>n[u])}let f=(()=>{class u{constructor(e,t){this.store=e,this.injector=t}initialize(e,t,i,o){this.store.dispatch(new h.g$(e,t,i,o))}saveFieldUpdate(e,t,i){this.store.dispatch(new h.XO(e,t,i))}getObjectEntry(e){return this.store.pipe((0,r.Lt)(b(e)))}getFieldState(e,t){return this.store.pipe((0,r.Lt)(function P(u,n){return(0,r.Mz)(b(u),e=>e.fieldStates[n])}(e,t)))}getFieldUpdates(e,t,i){return this.getObjectEntry(e).pipe((0,E.n)(_=>{const m={};return(0,d.a4)(_)&&Object.keys(i?_.fieldUpdates:_.fieldStates).forEach(v=>{m[v]=_.fieldUpdates[v]}),this.getFieldUpdatesExclusive(e,t).pipe((0,c.T)(v=>(Object.keys(v).forEach(M=>{m[M]=v[M]}),m)))}))}getFieldUpdatesExclusive(e,t){return this.getObjectEntry(e).pipe((0,d.Az)(),(0,c.T)(o=>{const _={};for(const m of t){let v=o.fieldUpdates[m.uuid];(0,d.Im)(v)&&(v={field:m,changeType:void 0}),_[m.uuid]=v}return _}))}isEditable(e,t){return this.getFieldState(e,t).pipe((0,U.p)(o=>(0,d.a4)(o)),(0,c.T)(o=>o.editable),(0,O.F)())}isValid(e,t){return this.getFieldState(e,t).pipe((0,U.p)(o=>(0,d.a4)(o)),(0,c.T)(o=>o.isValid),(0,O.F)())}isValidPage(e){return this.getObjectEntry(e).pipe((0,c.T)(i=>Object.values(i.fieldStates).findIndex(o=>!o.isValid)<0),(0,O.F)())}saveAddFieldUpdate(e,t){const i=this.getFieldUpdatesExclusive(e,[t]).pipe((0,U.p)(o=>o[t.uuid].changeType===l.B.ADD),(0,g.s)(1),(0,c.T)(()=>!0));return this.saveFieldUpdate(e,t,l.B.ADD),i}saveRemoveFieldUpdate(e,t){const i=this.getFieldUpdatesExclusive(e,[t]).pipe((0,U.p)(o=>o[t.uuid].changeType===l.B.REMOVE),(0,g.s)(1),(0,c.T)(()=>!0));return this.saveFieldUpdate(e,t,l.B.REMOVE),i}saveChangeFieldUpdate(e,t){this.saveFieldUpdate(e,t,l.B.UPDATE)}isSelectedVirtualMetadata(e,t,i){return this.store.pipe((0,r.Lt)(function j(u,n){return(0,r.Mz)(b(u),e=>e.virtualMetadataSources[n])}(e,t)),(0,c.T)(o=>o&&o[i]))}setSelectedVirtualMetadata(e,t,i,o){this.store.dispatch(new h.nY(e,t,i,o))}setEditableFieldUpdate(e,t,i){this.store.dispatch(new h.KD(e,t,i))}setValidFieldUpdate(e,t,i){this.store.dispatch(new h.wS(e,t,i))}discardFieldUpdates(e,t){this.store.dispatch(new h.Y8(e,t))}discardAllFieldUpdates(e,t){this.store.dispatch(new h.Y8(e,t,!0))}reinstateFieldUpdates(e){this.store.dispatch(new h.jX(e))}removeSingleFieldUpdate(e,t){this.store.dispatch(new h.mW(e,t))}getUpdatedFields(e,t){return this.getObjectEntry(e).pipe((0,c.T)(o=>{const _=[];return Object.keys(o.fieldStates).forEach(m=>{const v=o.fieldUpdates[m];if((0,d.Tn)(v)||v.changeType!==l.B.REMOVE){let M;M=(0,d.hj)(v)?v.field:t.find(I=>I.uuid===m),_.push(M)}}),_}))}hasUpdates(e){return this.getObjectEntry(e).pipe((0,c.T)(t=>(0,d.a4)(t)&&(0,d.hj)(t.fieldUpdates)))}isReinstatable(e){return this.hasUpdates(e+s.U)}getLastModified(e){return this.getObjectEntry(e).pipe((0,c.T)(t=>t.lastModified))}createPatch(e){return this.getObjectEntry(e).pipe((0,c.T)(t=>{let i=[];return(0,d.a4)(t.patchOperationService)&&(i=this.injector.get(t.patchOperationService).fieldUpdatesToPatchOperations(t.fieldUpdates)),i}))}static{this.\u0275fac=function(t){return new(t||u)(p.KVO(r.il),p.KVO(p.zZn))}}static{this.\u0275prov=p.jDH({token:u,factory:u.\u0275fac,providedIn:"root"})}}return u})()},1144:(C,S,a)=>{a.d(S,{X:()=>j});var r=a(89417),E=a(68018),c=a(96354),U=a(94925),O=a(60696),g=a(4093),d=a(44280),D=a(89777),l=a(74511),h=a(9847),s=a(54438),p=a(7901);function T(f,u){if(1&f&&(s.j41(0,"option",6),s.EFF(1),s.nI1(2,"translate"),s.k0s()),2&f){const n=u.$implicit;s.Y8G("value",n),s.R7$(),s.SpI(" ",s.bMT(2,2,"curation-task.task."+n+".label")," ")}}function b(f,u){1&f&&(s.j41(0,"div",3)(1,"label",8),s.EFF(2),s.nI1(3,"translate"),s.k0s(),s.nrm(4,"input",9),s.j41(5,"small",10),s.EFF(6),s.nI1(7,"translate"),s.k0s()()),2&f&&(s.R7$(2),s.JRh(s.bMT(3,2,"curation.form.handle.label")),s.R7$(4),s.JRh(s.bMT(7,4,"curation.form.handle.hint")))}let j=(()=>{class f{constructor(n,e,t,i,o,_,m){this.scriptDataService=n,this.configurationDataService=e,this.notificationsService=t,this.translateService=i,this.handleService=o,this.router=_,this.cdr=m,this.subs=[]}ngOnDestroy(){this.subs.forEach(n=>n.unsubscribe())}ngOnInit(){this.form=new r.J3({task:new r.hs(""),handle:new r.hs("")}),this.config=this.configurationDataService.findByPropertyName("plugin.named.org.dspace.curate.CurationTask"),this.subs.push(this.config.pipe((0,g.ak)()).subscribe(n=>{this.tasks=n.values.filter(e=>(0,D.hj)(e)&&e.includes("=")).map(e=>e.split("=")[1].trim()),this.form.get("task").patchValue(this.tasks[0]),this.cdr.detectChanges()}))}hasHandleValue(){return(0,D.a4)(this.dsoHandle)}submit(){const n=this.form.get("task").value;let e;e=this.hasHandleValue()?this.handleService.normalizeHandle(this.dsoHandle).pipe((0,c.T)(t=>((0,D.Im)(t)&&this.notificationsService.error(this.translateService.get("curation.form.submit.error.head"),this.translateService.get("curation.form.submit.error.invalid-handle")),t))):this.handleService.normalizeHandle(this.form.get("handle").value).pipe((0,c.T)(t=>(0,D.Im)(t)?"all":t)),this.subs.push(e.subscribe(t=>{(0,D.a4)(t)&&this.subs.push(this.scriptDataService.invoke("curate",[{name:"-t",value:n},{name:"-i",value:t}],[]).pipe((0,g.qD)()).subscribe(i=>{i.hasSucceeded?(this.notificationsService.success(this.translateService.get("curation.form.submit.success.head"),this.translateService.get("curation.form.submit.success.content")),this.router.navigateByUrl((0,d.yJ)(i.payload.processId))):this.notificationsService.error(this.translateService.get("curation.form.submit.error.head"),this.translateService.get("curation.form.submit.error.content"))}))}))}static{this.\u0275fac=function(e){return new(e||f)(s.rXU(O.ScriptDataService),s.rXU(U.ConfigurationDataService),s.rXU(h.I),s.rXU(E.c$),s.rXU(l.e),s.rXU(p.Ix),s.rXU(s.gRc))}}static{this.\u0275cmp=s.VBU({type:f,selectors:[["ds-curation-form"]],inputs:{dsoHandle:"dsoHandle"},standalone:!0,features:[s.aNF],decls:14,vars:8,consts:[[3,"ngSubmit","formGroup"],[1,"mb-3"],[1,"row","mb-2"],[1,"col-12","col-sm-6"],["for","task",1,"fw-bold","form-label"],["id","task","formControlName","task",1,"form-select"],[3,"value"],["type","submit",1,"btn","btn-default","btn-primary"],["for","handle",1,"fw-bold","form-label"],["id","handle","formControlName","handle",1,"form-control"],[1,"text-muted"]],template:function(e,t){1&e&&(s.j41(0,"form",0),s.bIt("ngSubmit",function(){return t.submit()}),s.j41(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),s.EFF(5),s.nI1(6,"translate"),s.k0s(),s.j41(7,"select",5),s.Z7z(8,T,3,4,"option",6,s.fX1),s.k0s()(),s.DNE(10,b,8,6,"div",3),s.k0s(),s.j41(11,"button",7),s.EFF(12),s.nI1(13,"translate"),s.k0s()()()),2&e&&(s.Y8G("formGroup",t.form),s.R7$(5),s.JRh(s.bMT(6,4,"curation.form.task-select.label")),s.R7$(3),s.Dyx(t.tasks),s.R7$(2),s.vxM(t.hasHandleValue()?-1:10),s.R7$(2),s.JRh(s.bMT(13,6,"curation.form.submit")))},dependencies:[r.YN,r.qT,r.xH,r.y7,r.me,r.wz,r.BC,r.cb,r.X1,r.j4,r.JD,E.h,E.D9],encapsulation:2})}}return f})()},95386:(C,S,a)=>{a.d(S,{A:()=>r});class r{}},26773:(C,S,a)=>{a.d(S,{h:()=>u});var r=a(54438),E=a(7673),c=a(99172),U=a(96697),O=a(43446),d=(a(70998),a(11873)),l=(a(6170),a(59640)),h=a(96354),s=a(89777),p=a(53844);const T=n=>n.objectSelection,b=n=>n.objectSelection;let P=(()=>{class n{constructor(t,i){this.store=t,this.appStore=i}getSelected(t,i){return this.store.select(function j(n,e){return function f(n,e){return(0,l.Mz)(T,t=>{if((0,s.a4)(t)&&(0,s.a4)(t[n]))return t[n][e]})}(n,e)}(t,i)).pipe((0,h.T)(o=>!!o&&o.checked))}getAllSelected(t){return this.appStore.select(b).pipe((0,h.T)(i=>(0,s.a4)(i[t])?Object.keys(i[t]).filter(o=>i[t][o].checked):[]))}initialSelect(t,i){this.store.dispatch(new p.u7(t,i))}initialDeselect(t,i){this.store.dispatch(new p.NE(t,i))}select(t,i){this.store.dispatch(new p.AS(t,i))}deselect(t,i){this.store.dispatch(new p.Vu(t,i))}switch(t,i){this.store.dispatch(new p.YE(t,i))}reset(t){this.store.dispatch(new p.bx(t,null))}static{this.\u0275fac=function(i){return new(i||n)(r.KVO(l.il),r.KVO(l.il))}}static{this.\u0275prov=r.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),u=(()=>{class n{constructor(t,i,o){this.objectSelectService=t,this.authorizationService=i,this.dsoNameService=o,this.cancel=new r.bkB,this.confirm=new r.bkB,this.dangerConfirm=!1}ngOnInit(){this.selectedIds$=this.objectSelectService.getAllSelected(this.key)}ngOnDestroy(){this.objectSelectService.reset(this.key)}switch(t){this.objectSelectService.switch(this.key,t)}getSelected(t){return this.objectSelectService.getSelected(this.key,t)}canSelect(t){return this.featureId?this.authorizationService.isAuthorized(this.featureId,t.self).pipe((0,c.Z)(!1)):(0,E.of)(!0)}confirmSelected(){this.selectedIds$.pipe((0,U.s)(1)).subscribe(t=>{this.confirm.emit(t),this.objectSelectService.reset(this.key)})}onCancel(){this.cancel.emit()}static{this.\u0275fac=function(i){return new(i||n)(r.rXU(P),r.rXU(d.AuthorizationDataService),r.rXU(O.f))}}static{this.\u0275cmp=r.VBU({type:n,selectors:[["ds-object-select-abstract"]],inputs:{key:"key",dsoRD$:"dsoRD$",paginationOptions:"paginationOptions",sortOptions:"sortOptions",confirmButton:"confirmButton",featureId:"featureId",cancelButton:"cancelButton",dangerConfirm:"dangerConfirm"},outputs:{cancel:"cancel",confirm:"confirm"},standalone:!0,features:[r.aNF],decls:0,vars:0,template:function(i,o){},encapsulation:2})}}return n})()},55929:(C,S,a)=>{a.d(S,{F:()=>g});var r=a(16289),E=a(9847),c=a(54438),U=a(68018),O=a(7901);let g=(()=>{class d{constructor(l,h,s,p){this.objectUpdatesService=l,this.notificationsService=h,this.translateService=s,this.router=p,this.notificationsPrefix="static-pages.form.notification"}ngOnInit(){this.url=this.router.url.split("?")[0],this.hasChanges$=this.hasChanges(),this.isReinstatable$=this.isReinstatable()}discard(){const l=this.notificationsService.info(this.getNotificationTitle("discarded"),this.getNotificationContent("discarded"),{timeOut:this.discardTimeOut});this.objectUpdatesService.discardFieldUpdates(this.url,l)}reinstate(){this.objectUpdatesService.reinstateFieldUpdates(this.url)}isReinstatable(){return this.objectUpdatesService.isReinstatable(this.url)}hasChanges(){return this.objectUpdatesService.hasUpdates(this.url)}getNotificationTitle(l){return this.translateService.instant(this.notificationsPrefix+l+".title")}getNotificationContent(l){return this.translateService.instant(this.notificationsPrefix+l+".content")}static{this.\u0275fac=function(h){return new(h||d)(c.rXU(r.F),c.rXU(E.I),c.rXU(U.c$),c.rXU(O.Ix))}}static{this.\u0275cmp=c.VBU({type:d,selectors:[["ds-abstract-trackable"]],standalone:!0,features:[c.aNF],decls:0,vars:0,template:function(h,s){},encapsulation:2})}}return d})()}}]);